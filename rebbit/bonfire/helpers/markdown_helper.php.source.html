<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /bonfire/helpers/markdown_helper.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Oct 23 19:15:14 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='bonfire/helpers';
filename='markdown_helper.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/bonfire/helpers/</a> -> <a href="markdown_helper.php.html">markdown_helper.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="markdown_helper.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="markdown_helper.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">#</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"># Markdown Extra  -  A text-to-HTML conversion tool for web writers</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">#</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"># PHP Markdown &amp; Extra</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"># Copyright (c) 2004-2009 Michel Fortin  </span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"># &lt;http://michelf.com/projects/php-markdown/&gt;</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">#</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"># Original Markdown</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"># Copyright (c) 2004-2006 John Gruber  </span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"># &lt;http://daringfireball.net/projects/markdown/&gt;</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">#</span>
<a name="l13"><span class="linenum">  13</span></a>  
<a name="l14"><span class="linenum">  14</span></a>  
<a name="l15"><span class="linenum">  15</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_VERSION')" href="../../_constants/MARKDOWN_VERSION.html" onMouseOver="constPopup(event,'MARKDOWN_VERSION')">MARKDOWN_VERSION</a>',  &quot;1.0.1n&quot; ); <span class="comment"># Sat 10 Oct 2009</span>
<a name="l16"><span class="linenum">  16</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWNEXTRA_VERSION')" href="../../_constants/MARKDOWNEXTRA_VERSION.html" onMouseOver="constPopup(event,'MARKDOWNEXTRA_VERSION')">MARKDOWNEXTRA_VERSION</a>',  &quot;1.2.4&quot; ); <span class="comment"># Sat 10 Oct 2009</span>
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment">#</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"># Global default settings:</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment">#</span>
<a name="l22"><span class="linenum">  22</span></a>  
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"># Change to &quot;&gt;&quot; for HTML output</span>
<a name="l24"><span class="linenum">  24</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_EMPTY_ELEMENT_SUFFIX')" href="../../_constants/MARKDOWN_EMPTY_ELEMENT_SUFFIX.html" onMouseOver="constPopup(event,'MARKDOWN_EMPTY_ELEMENT_SUFFIX')">MARKDOWN_EMPTY_ELEMENT_SUFFIX</a>',  &quot; /&gt;&quot;);
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"># Define the width of a tab for code blocks.</span>
<a name="l27"><span class="linenum">  27</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_TAB_WIDTH')" href="../../_constants/MARKDOWN_TAB_WIDTH.html" onMouseOver="constPopup(event,'MARKDOWN_TAB_WIDTH')">MARKDOWN_TAB_WIDTH</a>',     4 );
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"># Optional title attribute for footnote links and backlinks.</span>
<a name="l30"><span class="linenum">  30</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_FN_LINK_TITLE')" href="../../_constants/MARKDOWN_FN_LINK_TITLE.html" onMouseOver="constPopup(event,'MARKDOWN_FN_LINK_TITLE')">MARKDOWN_FN_LINK_TITLE</a>',         &quot;&quot; );
<a name="l31"><span class="linenum">  31</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_FN_BACKLINK_TITLE')" href="../../_constants/MARKDOWN_FN_BACKLINK_TITLE.html" onMouseOver="constPopup(event,'MARKDOWN_FN_BACKLINK_TITLE')">MARKDOWN_FN_BACKLINK_TITLE</a>',     &quot;&quot; );
<a name="l32"><span class="linenum">  32</span></a>  
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"># Optional class attribute for footnote links and backlinks.</span>
<a name="l34"><span class="linenum">  34</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_FN_LINK_CLASS')" href="../../_constants/MARKDOWN_FN_LINK_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_FN_LINK_CLASS')">MARKDOWN_FN_LINK_CLASS</a>',         &quot;&quot; );
<a name="l35"><span class="linenum">  35</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_FN_BACKLINK_CLASS')" href="../../_constants/MARKDOWN_FN_BACKLINK_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_FN_BACKLINK_CLASS')">MARKDOWN_FN_BACKLINK_CLASS</a>',     &quot;&quot; );
<a name="l36"><span class="linenum">  36</span></a>  
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">#</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"># WordPress settings:</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">#</span>
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"># Change to false to remove Markdown from posts and/or comments.</span>
<a name="l43"><span class="linenum">  43</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_WP_POSTS')" href="../../_constants/MARKDOWN_WP_POSTS.html" onMouseOver="constPopup(event,'MARKDOWN_WP_POSTS')">MARKDOWN_WP_POSTS</a>',      true );
<a name="l44"><span class="linenum">  44</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_WP_COMMENTS')" href="../../_constants/MARKDOWN_WP_COMMENTS.html" onMouseOver="constPopup(event,'MARKDOWN_WP_COMMENTS')">MARKDOWN_WP_COMMENTS</a>',   true );
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">### Standard Function Interface ###</span>
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  @<a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('MARKDOWN_PARSER_CLASS')" href="../../_constants/MARKDOWN_PARSER_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_PARSER_CLASS')">MARKDOWN_PARSER_CLASS</a>',  'MarkdownExtra_Parser' );
<a name="l51"><span class="linenum">  51</span></a>  
<a name="l52"><span class="linenum">  52</span></a>  function <a class="function" onClick="logFunction('Markdown')" href="../../_functions/markdown.html" onMouseOver="funcPopup(event,'markdown')">Markdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">#</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"># Initialize the parser and return the result of its transform method.</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">#</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">    # Setup static parser variable.</span>
<a name="l57"><span class="linenum">  57</span></a>      static <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>;
<a name="l58"><span class="linenum">  58</span></a>      if (!isset(<a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>)) {
<a name="l59"><span class="linenum">  59</span></a>          <a class="var it1074" onMouseOver="hilite(1074)" onMouseOut="lolite()" onClick="logVariable('parser_class')" href="../../_variables/parser_class.html">$parser_class</a> = <a class="constant" onClick="logConstant('MARKDOWN_PARSER_CLASS')" href="../../_constants/MARKDOWN_PARSER_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_PARSER_CLASS')">MARKDOWN_PARSER_CLASS</a>;
<a name="l60"><span class="linenum">  60</span></a>          <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a> = new <a class="var it1074" onMouseOver="hilite(1074)" onMouseOut="lolite()" onClick="logVariable('parser_class')" href="../../_variables/parser_class.html">$parser_class</a>;
<a name="l61"><span class="linenum">  61</span></a>      }
<a name="l62"><span class="linenum">  62</span></a>  
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">    # Transform text using parser.</span>
<a name="l64"><span class="linenum">  64</span></a>      return <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>-&gt;<a class="function" onClick="logFunction('transform')" href="../../_functions/transform.html" onMouseOver="funcPopup(event,'transform')">transform</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l65"><span class="linenum">  65</span></a>  }
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>  
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">### WordPress Plugin Interface ###</span>
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">/*</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">Plugin Name: Markdown Extra</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">Plugin URI: http://michelf.com/projects/php-markdown/</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">Description: &lt;a href=&quot;http://daringfireball.net/projects/markdown/syntax&quot;&gt;Markdown syntax&lt;/a&gt; allows you to write using an easy-to-read, easy-to-write plain text format. Based on the original Perl version by &lt;a href=&quot;http://daringfireball.net/&quot;&gt;John Gruber&lt;/a&gt;. &lt;a href=&quot;http://michelf.com/projects/php-markdown/&quot;&gt;More...&lt;/a&gt;</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">Version: 1.2.4</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">Author: Michel Fortin</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">Author URI: http://michelf.com/</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">*/</span>
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>  if (isset(<a class="var it1075" onMouseOver="hilite(1075)" onMouseOut="lolite()" onClick="logVariable('wp_version')" href="../../_variables/wp_version.html">$wp_version</a>)) {
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">    # More details about how it works here:</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">    # &lt;http://michelf.com/weblog/2005/wordpress-text-flow-vs-markdown/&gt;</span>
<a name="l82"><span class="linenum">  82</span></a>      
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">    # Post content and excerpts</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">    # - Remove WordPress paragraph generator.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">    # - Run Markdown on excerpt, then remove all tags.</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">    # - Add paragraph tag around the excerpt, but remove it for the excerpt rss.</span>
<a name="l87"><span class="linenum">  87</span></a>      if (<a class="constant" onClick="logConstant('MARKDOWN_WP_POSTS')" href="../../_constants/MARKDOWN_WP_POSTS.html" onMouseOver="constPopup(event,'MARKDOWN_WP_POSTS')">MARKDOWN_WP_POSTS</a>) {
<a name="l88"><span class="linenum">  88</span></a>          remove_filter('the_content',     'wpautop');
<a name="l89"><span class="linenum">  89</span></a>          remove_filter('the_content_rss', 'wpautop');
<a name="l90"><span class="linenum">  90</span></a>          remove_filter('the_excerpt',     'wpautop');
<a name="l91"><span class="linenum">  91</span></a>          add_filter('the_content',     'mdwp_MarkdownPost', 6);
<a name="l92"><span class="linenum">  92</span></a>          add_filter('the_content_rss', 'mdwp_MarkdownPost', 6);
<a name="l93"><span class="linenum">  93</span></a>          add_filter('get_the_excerpt', 'mdwp_MarkdownPost', 6);
<a name="l94"><span class="linenum">  94</span></a>          add_filter('get_the_excerpt', 'trim', 7);
<a name="l95"><span class="linenum">  95</span></a>          add_filter('the_excerpt',     'mdwp_add_p');
<a name="l96"><span class="linenum">  96</span></a>          add_filter('the_excerpt_rss', 'mdwp_strip_p');
<a name="l97"><span class="linenum">  97</span></a>          
<a name="l98"><span class="linenum">  98</span></a>          remove_filter('content_save_pre',  'balanceTags', 50);
<a name="l99"><span class="linenum">  99</span></a>          remove_filter('excerpt_save_pre',  'balanceTags', 50);
<a name="l100"><span class="linenum"> 100</span></a>          add_filter('the_content',        'balanceTags', 50);
<a name="l101"><span class="linenum"> 101</span></a>          add_filter('get_the_excerpt', 'balanceTags', 9);
<a name="l102"><span class="linenum"> 102</span></a>      }
<a name="l103"><span class="linenum"> 103</span></a>      
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">    # Add a footnote id prefix to posts when inside a loop.</span>
<a name="l105"><span class="linenum"> 105</span></a>  	function <a class="function" onClick="logFunction('mdwp_MarkdownPost')" href="../../_functions/mdwp_markdownpost.html" onMouseOver="funcPopup(event,'mdwp_markdownpost')">mdwp_MarkdownPost</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l106"><span class="linenum"> 106</span></a>          static <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>;
<a name="l107"><span class="linenum"> 107</span></a>          if (!<a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>) {
<a name="l108"><span class="linenum"> 108</span></a>              <a class="var it1074" onMouseOver="hilite(1074)" onMouseOut="lolite()" onClick="logVariable('parser_class')" href="../../_variables/parser_class.html">$parser_class</a> = <a class="constant" onClick="logConstant('MARKDOWN_PARSER_CLASS')" href="../../_constants/MARKDOWN_PARSER_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_PARSER_CLASS')">MARKDOWN_PARSER_CLASS</a>;
<a name="l109"><span class="linenum"> 109</span></a>              <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a> = new <a class="var it1074" onMouseOver="hilite(1074)" onMouseOut="lolite()" onClick="logVariable('parser_class')" href="../../_variables/parser_class.html">$parser_class</a>;
<a name="l110"><span class="linenum"> 110</span></a>          }
<a name="l111"><span class="linenum"> 111</span></a>          if (is_single() || is_page() || is_feed()) {
<a name="l112"><span class="linenum"> 112</span></a>              <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>-&gt;<a onClick="logVariable('fn_id_prefix')" class="var it2912" onMouseOver="hilite(2912)" onMouseOut="lolite()" href="../../_variables/fn_id_prefix.html">fn_id_prefix</a> = &quot;&quot;;
<a name="l113"><span class="linenum"> 113</span></a>          } else {
<a name="l114"><span class="linenum"> 114</span></a>              <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>-&gt;<a onClick="logVariable('fn_id_prefix')" class="var it2912" onMouseOver="hilite(2912)" onMouseOut="lolite()" href="../../_variables/fn_id_prefix.html">fn_id_prefix</a> = get_the_ID() . &quot;.&quot;;
<a name="l115"><span class="linenum"> 115</span></a>          }
<a name="l116"><span class="linenum"> 116</span></a>          return <a class="var it582" onMouseOver="hilite(582)" onMouseOut="lolite()" onClick="logVariable('parser')" href="../../_variables/parser.html">$parser</a>-&gt;<a class="function" onClick="logFunction('transform')" href="../../_functions/transform.html" onMouseOver="funcPopup(event,'transform')">transform</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l117"><span class="linenum"> 117</span></a>      }
<a name="l118"><span class="linenum"> 118</span></a>      
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">    # Comments</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">    # - Remove WordPress paragraph generator.</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">    # - Remove WordPress auto-link generator.</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">    # - Scramble important tags before passing them to the kses filter.</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">    # - Run Markdown on excerpt then remove paragraph tags.</span>
<a name="l124"><span class="linenum"> 124</span></a>      if (<a class="constant" onClick="logConstant('MARKDOWN_WP_COMMENTS')" href="../../_constants/MARKDOWN_WP_COMMENTS.html" onMouseOver="constPopup(event,'MARKDOWN_WP_COMMENTS')">MARKDOWN_WP_COMMENTS</a>) {
<a name="l125"><span class="linenum"> 125</span></a>          remove_filter('comment_text', 'wpautop', 30);
<a name="l126"><span class="linenum"> 126</span></a>          remove_filter('comment_text', 'make_clickable');
<a name="l127"><span class="linenum"> 127</span></a>          add_filter('pre_comment_content', 'Markdown', 6);
<a name="l128"><span class="linenum"> 128</span></a>          add_filter('pre_comment_content', 'mdwp_hide_tags', 8);
<a name="l129"><span class="linenum"> 129</span></a>          add_filter('pre_comment_content', 'mdwp_show_tags', 12);
<a name="l130"><span class="linenum"> 130</span></a>          add_filter('get_comment_text',    'Markdown', 6);
<a name="l131"><span class="linenum"> 131</span></a>          add_filter('get_comment_excerpt', 'Markdown', 6);
<a name="l132"><span class="linenum"> 132</span></a>          add_filter('get_comment_excerpt', 'mdwp_strip_p', 7);
<a name="l133"><span class="linenum"> 133</span></a>      
<a name="l134"><span class="linenum"> 134</span></a>          global <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('mdwp_hidden_tags')" href="../../_variables/mdwp_hidden_tags.html">$mdwp_hidden_tags</a>, <a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('mdwp_placeholders')" href="../../_variables/mdwp_placeholders.html">$mdwp_placeholders</a>;
<a name="l135"><span class="linenum"> 135</span></a>          <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('mdwp_hidden_tags')" href="../../_variables/mdwp_hidden_tags.html">$mdwp_hidden_tags</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ',
<a name="l136"><span class="linenum"> 136</span></a>              '&lt;p&gt; &lt;/p&gt; &lt;pre&gt; &lt;/pre&gt; &lt;ol&gt; &lt;/ol&gt; &lt;ul&gt; &lt;/ul&gt; &lt;li&gt; &lt;/li&gt;');
<a name="l137"><span class="linenum"> 137</span></a>          <a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('mdwp_placeholders')" href="../../_variables/mdwp_placeholders.html">$mdwp_placeholders</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(' ', <a class="phpfunction" onClick="logFunction('str_rot13')" href="../../_functions/str_rot13.html" onMouseOver="phpfuncPopup(event,'str_rot13')">str_rot13</a>(
<a name="l138"><span class="linenum"> 138</span></a>              'pEj07ZbbBZ U1kqgh4w4p pre2zmeN6K QTi31t9pre ol0MP1jzJR '.
<a name="l139"><span class="linenum"> 139</span></a>              'ML5IjmbRol ulANi1NsGY J7zRLJqPul liA8ctl16T K9nhooUHli'));
<a name="l140"><span class="linenum"> 140</span></a>      }
<a name="l141"><span class="linenum"> 141</span></a>      
<a name="l142"><span class="linenum"> 142</span></a>  	function <a class="function" onClick="logFunction('mdwp_add_p')" href="../../_functions/mdwp_add_p.html" onMouseOver="funcPopup(event,'mdwp_add_p')">mdwp_add_p</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l143"><span class="linenum"> 143</span></a>          if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^$|^&lt;(p|ul|ol|dl|pre|blockquote)&gt;}i', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>)) {
<a name="l144"><span class="linenum"> 144</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = '&lt;p&gt;'.<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>.'&lt;/p&gt;';
<a name="l145"><span class="linenum"> 145</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('{\n{2,}}', &quot;&lt;/p&gt;\n\n&lt;p&gt;&quot;, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l146"><span class="linenum"> 146</span></a>          }
<a name="l147"><span class="linenum"> 147</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l148"><span class="linenum"> 148</span></a>      }
<a name="l149"><span class="linenum"> 149</span></a>      
<a name="l150"><span class="linenum"> 150</span></a>  	function <a class="function" onClick="logFunction('mdwp_strip_p')" href="../../_functions/mdwp_strip_p.html" onMouseOver="funcPopup(event,'mdwp_strip_p')">mdwp_strip_p</a>(<a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>) { return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('{&lt;/?p&gt;}i', '', <a class="var it536" onMouseOver="hilite(536)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>); }
<a name="l151"><span class="linenum"> 151</span></a>  
<a name="l152"><span class="linenum"> 152</span></a>  	function <a class="function" onClick="logFunction('mdwp_hide_tags')" href="../../_functions/mdwp_hide_tags.html" onMouseOver="funcPopup(event,'mdwp_hide_tags')">mdwp_hide_tags</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l153"><span class="linenum"> 153</span></a>          global <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('mdwp_hidden_tags')" href="../../_variables/mdwp_hidden_tags.html">$mdwp_hidden_tags</a>, <a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('mdwp_placeholders')" href="../../_variables/mdwp_placeholders.html">$mdwp_placeholders</a>;
<a name="l154"><span class="linenum"> 154</span></a>          return <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('mdwp_hidden_tags')" href="../../_variables/mdwp_hidden_tags.html">$mdwp_hidden_tags</a>, <a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('mdwp_placeholders')" href="../../_variables/mdwp_placeholders.html">$mdwp_placeholders</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l155"><span class="linenum"> 155</span></a>      }
<a name="l156"><span class="linenum"> 156</span></a>  	function <a class="function" onClick="logFunction('mdwp_show_tags')" href="../../_functions/mdwp_show_tags.html" onMouseOver="funcPopup(event,'mdwp_show_tags')">mdwp_show_tags</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l157"><span class="linenum"> 157</span></a>          global <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('mdwp_hidden_tags')" href="../../_variables/mdwp_hidden_tags.html">$mdwp_hidden_tags</a>, <a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('mdwp_placeholders')" href="../../_variables/mdwp_placeholders.html">$mdwp_placeholders</a>;
<a name="l158"><span class="linenum"> 158</span></a>          return <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(<a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('mdwp_placeholders')" href="../../_variables/mdwp_placeholders.html">$mdwp_placeholders</a>, <a class="var it1077" onMouseOver="hilite(1077)" onMouseOut="lolite()" onClick="logVariable('mdwp_hidden_tags')" href="../../_variables/mdwp_hidden_tags.html">$mdwp_hidden_tags</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l159"><span class="linenum"> 159</span></a>      }
<a name="l160"><span class="linenum"> 160</span></a>  }
<a name="l161"><span class="linenum"> 161</span></a>  
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">### bBlog Plugin Info ###</span>
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>  function <a class="function" onClick="logFunction('identify_modifier_markdown')" href="../../_functions/identify_modifier_markdown.html" onMouseOver="funcPopup(event,'identify_modifier_markdown')">identify_modifier_markdown</a>() {
<a name="l166"><span class="linenum"> 166</span></a>      return array(
<a name="l167"><span class="linenum"> 167</span></a>          'name' =&gt; 'markdown',
<a name="l168"><span class="linenum"> 168</span></a>          'type' =&gt; 'modifier',
<a name="l169"><span class="linenum"> 169</span></a>          'nicename' =&gt; 'PHP Markdown Extra',
<a name="l170"><span class="linenum"> 170</span></a>          'description' =&gt; 'A text-to-HTML conversion tool for web writers',
<a name="l171"><span class="linenum"> 171</span></a>          'authors' =&gt; 'Michel Fortin and John Gruber',
<a name="l172"><span class="linenum"> 172</span></a>          'licence' =&gt; 'GPL',
<a name="l173"><span class="linenum"> 173</span></a>          'version' =&gt; <a class="constant" onClick="logConstant('MARKDOWNEXTRA_VERSION')" href="../../_constants/MARKDOWNEXTRA_VERSION.html" onMouseOver="constPopup(event,'MARKDOWNEXTRA_VERSION')">MARKDOWNEXTRA_VERSION</a>,
<a name="l174"><span class="linenum"> 174</span></a>          'help' =&gt; '&lt;a href=&quot;http://daringfireball.net/projects/markdown/syntax&quot;&gt;Markdown syntax&lt;/a&gt; allows you to write using an easy-to-read, easy-to-write plain text format. Based on the original Perl version by &lt;a href=&quot;http://daringfireball.net/&quot;&gt;John Gruber&lt;/a&gt;. &lt;a href=&quot;http://michelf.com/projects/php-markdown/&quot;&gt;More...&lt;/a&gt;',
<a name="l175"><span class="linenum"> 175</span></a>          );
<a name="l176"><span class="linenum"> 176</span></a>  }
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment">### Smarty Modifier Interface ###</span>
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>  function <a class="function" onClick="logFunction('smarty_modifier_markdown')" href="../../_functions/smarty_modifier_markdown.html" onMouseOver="funcPopup(event,'smarty_modifier_markdown')">smarty_modifier_markdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l182"><span class="linenum"> 182</span></a>      return <a class="function" onClick="logFunction('Markdown')" href="../../_functions/markdown.html" onMouseOver="funcPopup(event,'markdown')">Markdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l183"><span class="linenum"> 183</span></a>  }
<a name="l184"><span class="linenum"> 184</span></a>  
<a name="l185"><span class="linenum"> 185</span></a>  
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">### Textile Compatibility Mode ###</span>
<a name="l187"><span class="linenum"> 187</span></a>  
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment"># Rename this file to &quot;classTextile.php&quot; and it can replace Textile everywhere.</span>
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>  if (<a class="phpfunction" onClick="logFunction('strcasecmp')" href="../../_functions/strcasecmp.html" onMouseOver="phpfuncPopup(event,'strcasecmp')">strcasecmp</a>(<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(__FILE__, -16), &quot;classTextile.php&quot;) == 0) {
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">    # Try to include PHP SmartyPants. Should be in the same directory.</span>
<a name="l192"><span class="linenum"> 192</span></a>      @include_once 'smartypants.php';
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">    # Fake Textile class. It calls Markdown instead.</span>
<a name="l194"><span class="linenum"> 194</span></a>      <span class="keyword">class </span><a class="class" onClick="logClass('Textile')" href="../../_classes/textile.html" onMouseOver="classPopup(event,'textile')">Textile</a> {
<a name="l195"><span class="linenum"> 195</span></a>  		function <a class="function" onClick="logFunction('TextileThis')" href="../../_functions/textilethis.html" onMouseOver="funcPopup(event,'textilethis')">TextileThis</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1079" onMouseOver="hilite(1079)" onMouseOut="lolite()" onClick="logVariable('lite')" href="../../_variables/lite.html">$lite</a>='', <a class="var it1080" onMouseOver="hilite(1080)" onMouseOut="lolite()" onClick="logVariable('encode')" href="../../_variables/encode.html">$encode</a>='') {
<a name="l196"><span class="linenum"> 196</span></a>              if (<a class="var it1079" onMouseOver="hilite(1079)" onMouseOut="lolite()" onClick="logVariable('lite')" href="../../_variables/lite.html">$lite</a> == '' &amp;&amp; <a class="var it1080" onMouseOver="hilite(1080)" onMouseOut="lolite()" onClick="logVariable('encode')" href="../../_variables/encode.html">$encode</a> == '')    <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="function" onClick="logFunction('Markdown')" href="../../_functions/markdown.html" onMouseOver="funcPopup(event,'markdown')">Markdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l197"><span class="linenum"> 197</span></a>              if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('SmartyPants'))  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = SmartyPants(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l198"><span class="linenum"> 198</span></a>              return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l199"><span class="linenum"> 199</span></a>          }
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">        # Fake restricted version: restrictions are not supported for now.</span>
<a name="l201"><span class="linenum"> 201</span></a>  		function <a class="function" onClick="logFunction('TextileRestricted')" href="../../_functions/textilerestricted.html" onMouseOver="funcPopup(event,'textilerestricted')">TextileRestricted</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1079" onMouseOver="hilite(1079)" onMouseOut="lolite()" onClick="logVariable('lite')" href="../../_variables/lite.html">$lite</a>='', <a class="var it1081" onMouseOver="hilite(1081)" onMouseOut="lolite()" onClick="logVariable('noimage')" href="../../_variables/noimage.html">$noimage</a>='') {
<a name="l202"><span class="linenum"> 202</span></a>              return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('TextileThis')" href="../../_functions/textilethis.html" onMouseOver="funcPopup(event,'textilethis')">TextileThis</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1079" onMouseOver="hilite(1079)" onMouseOut="lolite()" onClick="logVariable('lite')" href="../../_variables/lite.html">$lite</a>);
<a name="l203"><span class="linenum"> 203</span></a>          }
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment">        # Workaround to ensure compatibility with TextPattern 4.0.3.</span>
<a name="l205"><span class="linenum"> 205</span></a>  		function <a class="function" onClick="logFunction('blockLite')" href="../../_functions/blocklite.html" onMouseOver="funcPopup(event,'blocklite')">blockLite</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) { return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>; }
<a name="l206"><span class="linenum"> 206</span></a>      }
<a name="l207"><span class="linenum"> 207</span></a>  }
<a name="l208"><span class="linenum"> 208</span></a>  
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>  
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">#</span>
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment"># Markdown Parser Class</span>
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">#</span>
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Markdown_Parser')" href="../../_classes/markdown_parser.html" onMouseOver="classPopup(event,'markdown_parser')">Markdown_Parser</a> {
<a name="l216"><span class="linenum"> 216</span></a>  
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">    # Regex to match balanced [brackets].</span>
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">    # Needed to insert a maximum bracked depth while converting to PHP.</span>
<a name="l219"><span class="linenum"> 219</span></a>      var <a class="var it1082" onMouseOver="hilite(1082)" onMouseOut="lolite()" onClick="logVariable('nested_brackets_depth')" href="../../_variables/nested_brackets_depth.html">$nested_brackets_depth</a> = 6;
<a name="l220"><span class="linenum"> 220</span></a>      var <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('nested_brackets_re')" href="../../_variables/nested_brackets_re.html">$nested_brackets_re</a>;
<a name="l221"><span class="linenum"> 221</span></a>      
<a name="l222"><span class="linenum"> 222</span></a>      var <a class="var it1084" onMouseOver="hilite(1084)" onMouseOut="lolite()" onClick="logVariable('nested_url_parenthesis_depth')" href="../../_variables/nested_url_parenthesis_depth.html">$nested_url_parenthesis_depth</a> = 4;
<a name="l223"><span class="linenum"> 223</span></a>      var <a class="var it1085" onMouseOver="hilite(1085)" onMouseOut="lolite()" onClick="logVariable('nested_url_parenthesis_re')" href="../../_variables/nested_url_parenthesis_re.html">$nested_url_parenthesis_re</a>;
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>  <span class="comment">    # Table of hash values for escaped characters:</span>
<a name="l226"><span class="linenum"> 226</span></a>      var <a class="var it1086" onMouseOver="hilite(1086)" onMouseOut="lolite()" onClick="logVariable('escape_chars')" href="../../_variables/escape_chars.html">$escape_chars</a> = '\`*_{}[]()&gt;#+-.!';
<a name="l227"><span class="linenum"> 227</span></a>      var <a class="var it1087" onMouseOver="hilite(1087)" onMouseOut="lolite()" onClick="logVariable('escape_chars_re')" href="../../_variables/escape_chars_re.html">$escape_chars_re</a>;
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>  <span class="comment">    # Change to &quot;&gt;&quot; for HTML output.</span>
<a name="l230"><span class="linenum"> 230</span></a>      var <a class="var it1088" onMouseOver="hilite(1088)" onMouseOut="lolite()" onClick="logVariable('empty_element_suffix')" href="../../_variables/empty_element_suffix.html">$empty_element_suffix</a> = <a class="constant" onClick="logConstant('MARKDOWN_EMPTY_ELEMENT_SUFFIX')" href="../../_constants/MARKDOWN_EMPTY_ELEMENT_SUFFIX.html" onMouseOver="constPopup(event,'MARKDOWN_EMPTY_ELEMENT_SUFFIX')">MARKDOWN_EMPTY_ELEMENT_SUFFIX</a>;
<a name="l231"><span class="linenum"> 231</span></a>      var <a class="var it1089" onMouseOver="hilite(1089)" onMouseOut="lolite()" onClick="logVariable('tab_width')" href="../../_variables/tab_width.html">$tab_width</a> = <a class="constant" onClick="logConstant('MARKDOWN_TAB_WIDTH')" href="../../_constants/MARKDOWN_TAB_WIDTH.html" onMouseOver="constPopup(event,'MARKDOWN_TAB_WIDTH')">MARKDOWN_TAB_WIDTH</a>;
<a name="l232"><span class="linenum"> 232</span></a>      
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment">    # Change to `true` to disallow markup or entities.</span>
<a name="l234"><span class="linenum"> 234</span></a>      var <a class="var it1090" onMouseOver="hilite(1090)" onMouseOut="lolite()" onClick="logVariable('no_markup')" href="../../_variables/no_markup.html">$no_markup</a> = false;
<a name="l235"><span class="linenum"> 235</span></a>      var <a class="var it1091" onMouseOver="hilite(1091)" onMouseOut="lolite()" onClick="logVariable('no_entities')" href="../../_variables/no_entities.html">$no_entities</a> = false;
<a name="l236"><span class="linenum"> 236</span></a>      
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">    # Predefined urls and titles for reference links and images.</span>
<a name="l238"><span class="linenum"> 238</span></a>      var <a class="var it1092" onMouseOver="hilite(1092)" onMouseOut="lolite()" onClick="logVariable('predef_urls')" href="../../_variables/predef_urls.html">$predef_urls</a> = array();
<a name="l239"><span class="linenum"> 239</span></a>      var <a class="var it1093" onMouseOver="hilite(1093)" onMouseOut="lolite()" onClick="logVariable('predef_titles')" href="../../_variables/predef_titles.html">$predef_titles</a> = array();
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>  	function <a class="function" onClick="logFunction('Markdown_Parser')" href="../../_functions/markdown_parser.html" onMouseOver="funcPopup(event,'markdown_parser')">Markdown_Parser</a>() {
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">    #</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">    # Constructor function. Initialize appropriate member variables.</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">    #</span>
<a name="l246"><span class="linenum"> 246</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_initDetab')" href="../../_functions/_initdetab.html" onMouseOver="funcPopup(event,'_initdetab')">_initDetab</a>();
<a name="l247"><span class="linenum"> 247</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepareItalicsAndBold')" href="../../_functions/prepareitalicsandbold.html" onMouseOver="funcPopup(event,'prepareitalicsandbold')">prepareItalicsAndBold</a>();
<a name="l248"><span class="linenum"> 248</span></a>      
<a name="l249"><span class="linenum"> 249</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_re.html">nested_brackets_re</a> = 
<a name="l250"><span class="linenum"> 250</span></a>              <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>('(?&gt;[^\[\]]+|\[', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_depth')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_depth.html">nested_brackets_depth</a>).
<a name="l251"><span class="linenum"> 251</span></a>              <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>('\])*', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_depth')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_depth.html">nested_brackets_depth</a>);
<a name="l252"><span class="linenum"> 252</span></a>      
<a name="l253"><span class="linenum"> 253</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_url_parenthesis_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_url_parenthesis_re.html">nested_url_parenthesis_re</a> = 
<a name="l254"><span class="linenum"> 254</span></a>              <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>('(?&gt;[^()\s]+|\(', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_url_parenthesis_depth')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_url_parenthesis_depth.html">nested_url_parenthesis_depth</a>).
<a name="l255"><span class="linenum"> 255</span></a>              <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>('(?&gt;\)))*', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_url_parenthesis_depth')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_url_parenthesis_depth.html">nested_url_parenthesis_depth</a>);
<a name="l256"><span class="linenum"> 256</span></a>          
<a name="l257"><span class="linenum"> 257</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('escape_chars_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/escape_chars_re.html">escape_chars_re</a> = '['.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('escape_chars')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/escape_chars.html">escape_chars</a>).']';
<a name="l258"><span class="linenum"> 258</span></a>          
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">        # Sort document, block, and span gamut in ascendent priority order.</span>
<a name="l260"><span class="linenum"> 260</span></a>          <a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('document_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/document_gamut.html">document_gamut</a>);
<a name="l261"><span class="linenum"> 261</span></a>          <a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('block_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/block_gamut.html">block_gamut</a>);
<a name="l262"><span class="linenum"> 262</span></a>          <a class="phpfunction" onClick="logFunction('asort')" href="../../_functions/asort.html" onMouseOver="phpfuncPopup(event,'asort')">asort</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('span_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/span_gamut.html">span_gamut</a>);
<a name="l263"><span class="linenum"> 263</span></a>      }
<a name="l264"><span class="linenum"> 264</span></a>  
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">    # Internal hashes used during transformation.</span>
<a name="l267"><span class="linenum"> 267</span></a>      var <a class="var it1097" onMouseOver="hilite(1097)" onMouseOut="lolite()" onClick="logVariable('urls')" href="../../_variables/urls.html">$urls</a> = array();
<a name="l268"><span class="linenum"> 268</span></a>      var <a class="var it1098" onMouseOver="hilite(1098)" onMouseOut="lolite()" onClick="logVariable('titles')" href="../../_variables/titles.html">$titles</a> = array();
<a name="l269"><span class="linenum"> 269</span></a>      var <a class="var it1099" onMouseOver="hilite(1099)" onMouseOut="lolite()" onClick="logVariable('html_hashes')" href="../../_variables/html_hashes.html">$html_hashes</a> = array();
<a name="l270"><span class="linenum"> 270</span></a>      
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">    # Status flag to avoid invalid nesting.</span>
<a name="l272"><span class="linenum"> 272</span></a>      var <a class="var it1100" onMouseOver="hilite(1100)" onMouseOut="lolite()" onClick="logVariable('in_anchor')" href="../../_variables/in_anchor.html">$in_anchor</a> = false;
<a name="l273"><span class="linenum"> 273</span></a>      
<a name="l274"><span class="linenum"> 274</span></a>      
<a name="l275"><span class="linenum"> 275</span></a>  	function <a class="function" onClick="logFunction('setup')" href="../../_functions/setup.html" onMouseOver="funcPopup(event,'setup')">setup</a>() {
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment">    #</span>
<a name="l277"><span class="linenum"> 277</span></a>  <span class="comment">    # Called before the transformation process starts to setup parser </span>
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment">    # states.</span>
<a name="l279"><span class="linenum"> 279</span></a>  <span class="comment">    #</span>
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment">        # Clear global hashes.</span>
<a name="l281"><span class="linenum"> 281</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('predef_urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/predef_urls.html">predef_urls</a>;
<a name="l282"><span class="linenum"> 282</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('predef_titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/predef_titles.html">predef_titles</a>;
<a name="l283"><span class="linenum"> 283</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('html_hashes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/html_hashes.html">html_hashes</a> = array();
<a name="l284"><span class="linenum"> 284</span></a>          
<a name="l285"><span class="linenum"> 285</span></a>          <a class="var it1100" onMouseOver="hilite(1100)" onMouseOut="lolite()" onClick="logVariable('in_anchor')" href="../../_variables/in_anchor.html">$in_anchor</a> = false;
<a name="l286"><span class="linenum"> 286</span></a>      }
<a name="l287"><span class="linenum"> 287</span></a>      
<a name="l288"><span class="linenum"> 288</span></a>  	function <a class="function" onClick="logFunction('teardown')" href="../../_functions/teardown.html" onMouseOver="funcPopup(event,'teardown')">teardown</a>() {
<a name="l289"><span class="linenum"> 289</span></a>  <span class="comment">    #</span>
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">    # Called after the transformation process to clear any variable </span>
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">    # which may be taking up memory unnecessarly.</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">    #</span>
<a name="l293"><span class="linenum"> 293</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a> = array();
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a> = array();
<a name="l295"><span class="linenum"> 295</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('html_hashes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/html_hashes.html">html_hashes</a> = array();
<a name="l296"><span class="linenum"> 296</span></a>      }
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  	function <a class="function" onClick="logFunction('transform')" href="../../_functions/transform.html" onMouseOver="funcPopup(event,'transform')">transform</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">    #</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">    # Main function. Performs some preprocessing on the input text</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">    # and pass it through the document gamut.</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">    #</span>
<a name="l304"><span class="linenum"> 304</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setup')" href="../../_functions/setup.html" onMouseOver="funcPopup(event,'setup')">setup</a>();
<a name="l305"><span class="linenum"> 305</span></a>      
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">        # Remove UTF-8 BOM and marker character in input, if present.</span>
<a name="l307"><span class="linenum"> 307</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('{^\xEF\xBB\xBF|\x1A}', '', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">        # Standardize line endings:</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">        #   DOS to Unix and Mac to Unix</span>
<a name="l311"><span class="linenum"> 311</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('{\r\n?}', &quot;\n&quot;, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">        # Make sure $text ends with a couple of newlines:</span>
<a name="l314"><span class="linenum"> 314</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;\n\n&quot;;
<a name="l315"><span class="linenum"> 315</span></a>  
<a name="l316"><span class="linenum"> 316</span></a>  <span class="comment">        # Convert all tabs to spaces.</span>
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detab')" href="../../_functions/detab.html" onMouseOver="funcPopup(event,'detab')">detab</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">        # Turn block-level HTML blocks into hash entries</span>
<a name="l320"><span class="linenum"> 320</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashHTMLBlocks')" href="../../_functions/hashhtmlblocks.html" onMouseOver="funcPopup(event,'hashhtmlblocks')">hashHTMLBlocks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l321"><span class="linenum"> 321</span></a>  
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">        # Strip any lines consisting only of spaces and tabs.</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">        # This makes subsequent regexen easier to write, because we can</span>
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment">        # match consecutive blank lines with /\n+/ instead of something</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">        # contorted like /[ ]*\n+/ .</span>
<a name="l326"><span class="linenum"> 326</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^[ ]+$/m', '', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment">        # Run document gamut methods.</span>
<a name="l329"><span class="linenum"> 329</span></a>          foreach (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('document_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/document_gamut.html">document_gamut</a> as <a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a> =&gt; <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('priority')" href="../../_variables/priority.html">$priority</a>) {
<a name="l330"><span class="linenum"> 330</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l331"><span class="linenum"> 331</span></a>          }
<a name="l332"><span class="linenum"> 332</span></a>          
<a name="l333"><span class="linenum"> 333</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('teardown')" href="../../_functions/teardown.html" onMouseOver="funcPopup(event,'teardown')">teardown</a>();
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> . &quot;\n&quot;;
<a name="l336"><span class="linenum"> 336</span></a>      }
<a name="l337"><span class="linenum"> 337</span></a>      
<a name="l338"><span class="linenum"> 338</span></a>      var <a class="var it1094" onMouseOver="hilite(1094)" onMouseOut="lolite()" onClick="logVariable('document_gamut')" href="../../_variables/document_gamut.html">$document_gamut</a> = array(
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">        # Strip link definitions, store in hashes.</span>
<a name="l340"><span class="linenum"> 340</span></a>          &quot;stripLinkDefinitions&quot; =&gt; 20,
<a name="l341"><span class="linenum"> 341</span></a>          
<a name="l342"><span class="linenum"> 342</span></a>          &quot;runBasicBlockGamut&quot;   =&gt; 30,
<a name="l343"><span class="linenum"> 343</span></a>          );
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>  
<a name="l346"><span class="linenum"> 346</span></a>  	function <a class="function" onClick="logFunction('stripLinkDefinitions')" href="../../_functions/striplinkdefinitions.html" onMouseOver="funcPopup(event,'striplinkdefinitions')">stripLinkDefinitions</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">    #</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment">    # Strips link definitions from text, stores the URLs and titles in</span>
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">    # hash references.</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">    #</span>
<a name="l351"><span class="linenum"> 351</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l352"><span class="linenum"> 352</span></a>  
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">        # Link defs are in the form: ^[id]: url &quot;optional title&quot;</span>
<a name="l354"><span class="linenum"> 354</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l355"><span class="linenum"> 355</span></a>                              ^[ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}\[(.+)\][ ]?:    # id = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l356"><span class="linenum"> 356</span></a>                                [ ]*
<a name="l357"><span class="linenum"> 357</span></a>                                \n?                # maybe *one* newline
<a name="l358"><span class="linenum"> 358</span></a>                                [ ]*
<a name="l359"><span class="linenum"> 359</span></a>                              (?:
<a name="l360"><span class="linenum"> 360</span></a>                                &lt;(.+?)&gt;            # url = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l361"><span class="linenum"> 361</span></a>                              |
<a name="l362"><span class="linenum"> 362</span></a>                                (\S+?)            # url = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l363"><span class="linenum"> 363</span></a>                              )
<a name="l364"><span class="linenum"> 364</span></a>                                [ ]*
<a name="l365"><span class="linenum"> 365</span></a>                                \n?                # maybe one newline
<a name="l366"><span class="linenum"> 366</span></a>                                [ ]*
<a name="l367"><span class="linenum"> 367</span></a>                              (?:
<a name="l368"><span class="linenum"> 368</span></a>                                  (?&lt;=\s)            # lookbehind for whitespace
<a name="l369"><span class="linenum"> 369</span></a>                                  [&quot;(]
<a name="l370"><span class="linenum"> 370</span></a>                                  (.*?)            # title = <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>
<a name="l371"><span class="linenum"> 371</span></a>                                  [&quot;)]
<a name="l372"><span class="linenum"> 372</span></a>                                  [ ]*
<a name="l373"><span class="linenum"> 373</span></a>                              )?    # title is optional
<a name="l374"><span class="linenum"> 374</span></a>                              (?:\n+|\Z)
<a name="l375"><span class="linenum"> 375</span></a>              }xm',
<a name="l376"><span class="linenum"> 376</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_stripLinkDefinitions_callback'),
<a name="l377"><span class="linenum"> 377</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l378"><span class="linenum"> 378</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l379"><span class="linenum"> 379</span></a>      }
<a name="l380"><span class="linenum"> 380</span></a>  	function <a class="function" onClick="logFunction('_stripLinkDefinitions_callback')" href="../../_functions/_striplinkdefinitions_callback.html" onMouseOver="funcPopup(event,'_striplinkdefinitions_callback')">_stripLinkDefinitions_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l381"><span class="linenum"> 381</span></a>          <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]);
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] == '' ? <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] : <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l383"><span class="linenum"> 383</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>] = <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>;
<a name="l384"><span class="linenum"> 384</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>] =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[4];
<a name="l385"><span class="linenum"> 385</span></a>          return ''; <span class="comment"># String that will replace the block</span>
<a name="l386"><span class="linenum"> 386</span></a>      }
<a name="l387"><span class="linenum"> 387</span></a>  
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>  	function <a class="function" onClick="logFunction('hashHTMLBlocks')" href="../../_functions/hashhtmlblocks.html" onMouseOver="funcPopup(event,'hashhtmlblocks')">hashHTMLBlocks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l390"><span class="linenum"> 390</span></a>          if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('no_markup')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/no_markup.html">no_markup</a>)  return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l391"><span class="linenum"> 391</span></a>  
<a name="l392"><span class="linenum"> 392</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">        # Hashify HTML blocks:</span>
<a name="l395"><span class="linenum"> 395</span></a>  <span class="comment">        # We only want to do this for block-level HTML tags, such as headers,</span>
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">        # lists, and tables. That's because we still want to wrap &lt;p&gt;s around</span>
<a name="l397"><span class="linenum"> 397</span></a>  <span class="comment">        # &quot;paragraphs&quot; that are wrapped in non-block-level tags, such as anchors,</span>
<a name="l398"><span class="linenum"> 398</span></a>  <span class="comment">        # phrase emphasis, and spans. The list of tags we're looking for is</span>
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">        # hard-coded:</span>
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">        #</span>
<a name="l401"><span class="linenum"> 401</span></a>  <span class="comment">        # *  List &quot;a&quot; is made of tags which can be both inline or block-level.</span>
<a name="l402"><span class="linenum"> 402</span></a>  <span class="comment">        #    These will be treated block-level when the start tag is alone on </span>
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">        #    its line, otherwise they're not matched here and will be taken as </span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">        #    inline later.</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">        # *  List &quot;b&quot; is made of tags which are always block-level;</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment">        #</span>
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it1105" onMouseOver="hilite(1105)" onMouseOut="lolite()" onClick="logVariable('block_tags_a_re')" href="../../_variables/block_tags_a_re.html">$block_tags_a_re</a> = 'ins|del';
<a name="l408"><span class="linenum"> 408</span></a>          <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('block_tags_b_re')" href="../../_variables/block_tags_b_re.html">$block_tags_b_re</a> = 'p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|address|'.
<a name="l409"><span class="linenum"> 409</span></a>                             'script|noscript|form|fieldset|iframe|math';
<a name="l410"><span class="linenum"> 410</span></a>  
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment">        # Regular expression for the content of a block tag.</span>
<a name="l412"><span class="linenum"> 412</span></a>          <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('nested_tags_level')" href="../../_variables/nested_tags_level.html">$nested_tags_level</a> = 4;
<a name="l413"><span class="linenum"> 413</span></a>          <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> = '
<a name="l414"><span class="linenum"> 414</span></a>              (?&gt;                # optional tag attributes
<a name="l415"><span class="linenum"> 415</span></a>                \s            # starts with whitespace
<a name="l416"><span class="linenum"> 416</span></a>                (?&gt;
<a name="l417"><span class="linenum"> 417</span></a>                  [^&gt;&quot;/]+        # text outside quotes
<a name="l418"><span class="linenum"> 418</span></a>                |
<a name="l419"><span class="linenum"> 419</span></a>                  /+(?!&gt;)        # slash not followed by &quot;&gt;&quot;
<a name="l420"><span class="linenum"> 420</span></a>                |
<a name="l421"><span class="linenum"> 421</span></a>                  &quot;[^&quot;]*&quot;        # text inside double quotes (tolerate &quot;&gt;&quot;)
<a name="l422"><span class="linenum"> 422</span></a>                |
<a name="l423"><span class="linenum"> 423</span></a>                  \'[^\']*\'    # text inside single quotes (tolerate &quot;&gt;&quot;)
<a name="l424"><span class="linenum"> 424</span></a>                )*
<a name="l425"><span class="linenum"> 425</span></a>              )?    
<a name="l426"><span class="linenum"> 426</span></a>              ';
<a name="l427"><span class="linenum"> 427</span></a>          <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a> =
<a name="l428"><span class="linenum"> 428</span></a>              <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>('
<a name="l429"><span class="linenum"> 429</span></a>                  (?&gt;
<a name="l430"><span class="linenum"> 430</span></a>                    [^&lt;]+            # content without tag
<a name="l431"><span class="linenum"> 431</span></a>                  |
<a name="l432"><span class="linenum"> 432</span></a>                    &lt;\2            # nested opening tag
<a name="l433"><span class="linenum"> 433</span></a>                      '.<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>.'    # attributes
<a name="l434"><span class="linenum"> 434</span></a>                      (?&gt;
<a name="l435"><span class="linenum"> 435</span></a>                        /&gt;
<a name="l436"><span class="linenum"> 436</span></a>                      |
<a name="l437"><span class="linenum"> 437</span></a>                        &gt;', <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('nested_tags_level')" href="../../_variables/nested_tags_level.html">$nested_tags_level</a>).    # end of opening tag
<a name="l438"><span class="linenum"> 438</span></a>                        '.*?'.                    # last level nested tag content
<a name="l439"><span class="linenum"> 439</span></a>              <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>('
<a name="l440"><span class="linenum"> 440</span></a>                        &lt;/\2\s*&gt;    # closing nested tag
<a name="l441"><span class="linenum"> 441</span></a>                      )
<a name="l442"><span class="linenum"> 442</span></a>                    |                
<a name="l443"><span class="linenum"> 443</span></a>                      &lt;(?!/\2\s*&gt;    # other tags with a different name
<a name="l444"><span class="linenum"> 444</span></a>                    )
<a name="l445"><span class="linenum"> 445</span></a>                  )*',
<a name="l446"><span class="linenum"> 446</span></a>                  <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('nested_tags_level')" href="../../_variables/nested_tags_level.html">$nested_tags_level</a>);
<a name="l447"><span class="linenum"> 447</span></a>          <a class="var it1108" onMouseOver="hilite(1108)" onMouseOut="lolite()" onClick="logVariable('content2')" href="../../_variables/content2.html">$content2</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('\2', '\3', <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>);
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment">        # First, look for nested blocks, e.g.:</span>
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment">        #     &lt;div&gt;</span>
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">        #         &lt;div&gt;</span>
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">        #         tags for inner block must be indented.</span>
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment">        #         &lt;/div&gt;</span>
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment">        #     &lt;/div&gt;</span>
<a name="l455"><span class="linenum"> 455</span></a>  <span class="comment">        #</span>
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment">        # The outermost tags must start at the left margin for this to match, and</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">        # the inner nested divs must be indented.</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment">        # We need to do this before the next, more liberal match, because the next</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment">        # match will start at the first `&lt;div&gt;` and stop at the first `&lt;/div&gt;`.</span>
<a name="l460"><span class="linenum"> 460</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{(?&gt;
<a name="l461"><span class="linenum"> 461</span></a>              (?&gt;
<a name="l462"><span class="linenum"> 462</span></a>                  (?&lt;=\n\n)        # Starting after a blank line
<a name="l463"><span class="linenum"> 463</span></a>                  |                # or
<a name="l464"><span class="linenum"> 464</span></a>                  \A\n?            # the beginning of the doc
<a name="l465"><span class="linenum"> 465</span></a>              )
<a name="l466"><span class="linenum"> 466</span></a>              (                        # save in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l467"><span class="linenum"> 467</span></a>  
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment">              # Match from `\n&lt;tag&gt;` to `&lt;/tag&gt;\n`, handling nested tags </span>
<a name="l469"><span class="linenum"> 469</span></a>  <span class="comment">              # in between.</span>
<a name="l470"><span class="linenum"> 470</span></a>                      
<a name="l471"><span class="linenum"> 471</span></a>                          [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l472"><span class="linenum"> 472</span></a>                          &lt;('.<a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('block_tags_b_re')" href="../../_variables/block_tags_b_re.html">$block_tags_b_re</a>.')# start tag = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l473"><span class="linenum"> 473</span></a>                          '.<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>.'&gt;            # attributes followed by &gt; and \n
<a name="l474"><span class="linenum"> 474</span></a>                          '.<a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>.'        # content, support nesting
<a name="l475"><span class="linenum"> 475</span></a>                          &lt;/\2&gt;                # the matching end tag
<a name="l476"><span class="linenum"> 476</span></a>                          [ ]*                # trailing spaces/tabs
<a name="l477"><span class="linenum"> 477</span></a>                          (?=\n+|\Z)    # followed by a newline or end of document
<a name="l478"><span class="linenum"> 478</span></a>  
<a name="l479"><span class="linenum"> 479</span></a>              | # Special version for tags of group a.
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>                          [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l482"><span class="linenum"> 482</span></a>                          &lt;('.<a class="var it1105" onMouseOver="hilite(1105)" onMouseOut="lolite()" onClick="logVariable('block_tags_a_re')" href="../../_variables/block_tags_a_re.html">$block_tags_a_re</a>.')# start tag = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l483"><span class="linenum"> 483</span></a>                          '.<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>.'&gt;[ ]*\n    # attributes followed by &gt;
<a name="l484"><span class="linenum"> 484</span></a>                          '.<a class="var it1108" onMouseOver="hilite(1108)" onMouseOut="lolite()" onClick="logVariable('content2')" href="../../_variables/content2.html">$content2</a>.'        # content, support nesting
<a name="l485"><span class="linenum"> 485</span></a>                          &lt;/\3&gt;                # the matching end tag
<a name="l486"><span class="linenum"> 486</span></a>                          [ ]*                # trailing spaces/tabs
<a name="l487"><span class="linenum"> 487</span></a>                          (?=\n+|\Z)    # followed by a newline or end of document
<a name="l488"><span class="linenum"> 488</span></a>                      
<a name="l489"><span class="linenum"> 489</span></a>              | # Special case just for &lt;hr /&gt;. It was easier to make a special 
<a name="l490"><span class="linenum"> 490</span></a>  <span class="comment">              # case than to make the other regex more complicated.</span>
<a name="l491"><span class="linenum"> 491</span></a>              
<a name="l492"><span class="linenum"> 492</span></a>                          [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l493"><span class="linenum"> 493</span></a>                          &lt;(hr)                # start tag = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l494"><span class="linenum"> 494</span></a>                          '.<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>.'            # attributes
<a name="l495"><span class="linenum"> 495</span></a>                          /?&gt;                    # the matching end tag
<a name="l496"><span class="linenum"> 496</span></a>                          [ ]*
<a name="l497"><span class="linenum"> 497</span></a>                          (?=\n{2,}|\Z)        # followed by a blank line or end of document
<a name="l498"><span class="linenum"> 498</span></a>              
<a name="l499"><span class="linenum"> 499</span></a>              | # Special case for standalone HTML comments:
<a name="l500"><span class="linenum"> 500</span></a>              
<a name="l501"><span class="linenum"> 501</span></a>                      [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l502"><span class="linenum"> 502</span></a>                      (?s:
<a name="l503"><span class="linenum"> 503</span></a>                          &lt;!-- .*? --&gt;
<a name="l504"><span class="linenum"> 504</span></a>                      )
<a name="l505"><span class="linenum"> 505</span></a>                      [ ]*
<a name="l506"><span class="linenum"> 506</span></a>                      (?=\n{2,}|\Z)        # followed by a blank line or end of document
<a name="l507"><span class="linenum"> 507</span></a>              
<a name="l508"><span class="linenum"> 508</span></a>              | # PHP and ASP-style processor instructions (&lt;? and &lt;%)
<a name="l509"><span class="linenum"> 509</span></a>              
<a name="l510"><span class="linenum"> 510</span></a>                      [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l511"><span class="linenum"> 511</span></a>                      (?s:
<a name="l512"><span class="linenum"> 512</span></a>                          &lt;([?%])            # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l513"><span class="linenum"> 513</span></a>                          .*?
<a name="l514"><span class="linenum"> 514</span></a>                          \2&gt;
<a name="l515"><span class="linenum"> 515</span></a>                      )
<a name="l516"><span class="linenum"> 516</span></a>                      [ ]*
<a name="l517"><span class="linenum"> 517</span></a>                      (?=\n{2,}|\Z)        # followed by a blank line or end of document
<a name="l518"><span class="linenum"> 518</span></a>                      
<a name="l519"><span class="linenum"> 519</span></a>              )
<a name="l520"><span class="linenum"> 520</span></a>              )}Sxmi',
<a name="l521"><span class="linenum"> 521</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_hashHTMLBlocks_callback'),
<a name="l522"><span class="linenum"> 522</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l523"><span class="linenum"> 523</span></a>  
<a name="l524"><span class="linenum"> 524</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l525"><span class="linenum"> 525</span></a>      }
<a name="l526"><span class="linenum"> 526</span></a>  	function <a class="function" onClick="logFunction('_hashHTMLBlocks_callback')" href="../../_functions/_hashhtmlblocks_callback.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_callback')">_hashHTMLBlocks_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l527"><span class="linenum"> 527</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l528"><span class="linenum"> 528</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>  = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l529"><span class="linenum"> 529</span></a>          return &quot;\n\n<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>\n\n&quot;;
<a name="l530"><span class="linenum"> 530</span></a>      }
<a name="l531"><span class="linenum"> 531</span></a>      
<a name="l532"><span class="linenum"> 532</span></a>      
<a name="l533"><span class="linenum"> 533</span></a>  	function <a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1109" onMouseOver="hilite(1109)" onMouseOut="lolite()" onClick="logVariable('boundary')" href="../../_variables/boundary.html">$boundary</a> = 'X') {
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment">    #</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment">    # Called whenever a tag must be hashed when a function insert an atomic </span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment">    # element in the text stream. Passing $text to through this function gives</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">    # a unique text-token which will be reverted back when calling unhash.</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">    #</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment">    # The $boundary argument specify what character should be used to surround</span>
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment">    # the token. By convension, &quot;B&quot; is used for block elements that needs not</span>
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment">    # to be wrapped into paragraph tags at the end, &quot;:&quot; is used for elements</span>
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment">    # that are word separators and &quot;X&quot; is used in the general case.</span>
<a name="l543"><span class="linenum"> 543</span></a>  <span class="comment">    #</span>
<a name="l544"><span class="linenum"> 544</span></a>  <span class="comment">        # Swap back any tag hash found in $text so we do not have to `unhash`</span>
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">        # multiple times at the end.</span>
<a name="l546"><span class="linenum"> 546</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('unhash')" href="../../_functions/unhash.html" onMouseOver="funcPopup(event,'unhash')">unhash</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l547"><span class="linenum"> 547</span></a>          
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment">        # Then hash the block.</span>
<a name="l549"><span class="linenum"> 549</span></a>          static <a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0;
<a name="l550"><span class="linenum"> 550</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = &quot;<a class="var it1109" onMouseOver="hilite(1109)" onMouseOut="lolite()" onClick="logVariable('boundary')" href="../../_variables/boundary.html">$boundary</a>\x1A&quot; . ++<a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> . <a class="var it1109" onMouseOver="hilite(1109)" onMouseOut="lolite()" onClick="logVariable('boundary')" href="../../_variables/boundary.html">$boundary</a>;
<a name="l551"><span class="linenum"> 551</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('html_hashes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/html_hashes.html">html_hashes</a>[<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l552"><span class="linenum"> 552</span></a>          return <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>; <span class="comment"># String that will replace the tag.</span>
<a name="l553"><span class="linenum"> 553</span></a>      }
<a name="l554"><span class="linenum"> 554</span></a>  
<a name="l555"><span class="linenum"> 555</span></a>  
<a name="l556"><span class="linenum"> 556</span></a>  	function <a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment">    #</span>
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment">    # Shortcut function for hashPart with block-level boundaries.</span>
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">    #</span>
<a name="l560"><span class="linenum"> 560</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, 'B');
<a name="l561"><span class="linenum"> 561</span></a>      }
<a name="l562"><span class="linenum"> 562</span></a>  
<a name="l563"><span class="linenum"> 563</span></a>  
<a name="l564"><span class="linenum"> 564</span></a>      var <a class="var it1095" onMouseOver="hilite(1095)" onMouseOut="lolite()" onClick="logVariable('block_gamut')" href="../../_variables/block_gamut.html">$block_gamut</a> = array(
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment">    #</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">    # These are all the transformations that form block-level</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment">    # tags like paragraphs, headers, and list items.</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">    #</span>
<a name="l569"><span class="linenum"> 569</span></a>          &quot;doHeaders&quot;         =&gt; 10,
<a name="l570"><span class="linenum"> 570</span></a>          &quot;doHorizontalRules&quot; =&gt; 20,
<a name="l571"><span class="linenum"> 571</span></a>          
<a name="l572"><span class="linenum"> 572</span></a>          &quot;doLists&quot;           =&gt; 40,
<a name="l573"><span class="linenum"> 573</span></a>          &quot;doCodeBlocks&quot;      =&gt; 50,
<a name="l574"><span class="linenum"> 574</span></a>          &quot;doBlockQuotes&quot;     =&gt; 60,
<a name="l575"><span class="linenum"> 575</span></a>          );
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>  	function <a class="function" onClick="logFunction('runBlockGamut')" href="../../_functions/runblockgamut.html" onMouseOver="funcPopup(event,'runblockgamut')">runBlockGamut</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l578"><span class="linenum"> 578</span></a>  <span class="comment">    #</span>
<a name="l579"><span class="linenum"> 579</span></a>  <span class="comment">    # Run block gamut tranformations.</span>
<a name="l580"><span class="linenum"> 580</span></a>  <span class="comment">    #</span>
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">        # We need to escape raw HTML in Markdown source before doing anything </span>
<a name="l582"><span class="linenum"> 582</span></a>  <span class="comment">        # else. This need to be done for each block, and not only at the </span>
<a name="l583"><span class="linenum"> 583</span></a>  <span class="comment">        # begining in the Markdown function since hashed blocks can be part of</span>
<a name="l584"><span class="linenum"> 584</span></a>  <span class="comment">        # list items and could have been indented. Indented blocks would have </span>
<a name="l585"><span class="linenum"> 585</span></a>  <span class="comment">        # been seen as a code block in a previous pass of hashHTMLBlocks.</span>
<a name="l586"><span class="linenum"> 586</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashHTMLBlocks')" href="../../_functions/hashhtmlblocks.html" onMouseOver="funcPopup(event,'hashhtmlblocks')">hashHTMLBlocks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l587"><span class="linenum"> 587</span></a>          
<a name="l588"><span class="linenum"> 588</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runBasicBlockGamut')" href="../../_functions/runbasicblockgamut.html" onMouseOver="funcPopup(event,'runbasicblockgamut')">runBasicBlockGamut</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l589"><span class="linenum"> 589</span></a>      }
<a name="l590"><span class="linenum"> 590</span></a>      
<a name="l591"><span class="linenum"> 591</span></a>  	function <a class="function" onClick="logFunction('runBasicBlockGamut')" href="../../_functions/runbasicblockgamut.html" onMouseOver="funcPopup(event,'runbasicblockgamut')">runBasicBlockGamut</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">    #</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">    # Run block gamut tranformations, without hashing HTML blocks. This is </span>
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">    # useful when HTML blocks are known to be already hashed, like in the first</span>
<a name="l595"><span class="linenum"> 595</span></a>  <span class="comment">    # whole-document pass.</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">    #</span>
<a name="l597"><span class="linenum"> 597</span></a>          foreach (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('block_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/block_gamut.html">block_gamut</a> as <a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a> =&gt; <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('priority')" href="../../_variables/priority.html">$priority</a>) {
<a name="l598"><span class="linenum"> 598</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l599"><span class="linenum"> 599</span></a>          }
<a name="l600"><span class="linenum"> 600</span></a>          
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">        # Finally form paragraph and restore hashed blocks.</span>
<a name="l602"><span class="linenum"> 602</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('formParagraphs')" href="../../_functions/formparagraphs.html" onMouseOver="funcPopup(event,'formparagraphs')">formParagraphs</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l603"><span class="linenum"> 603</span></a>  
<a name="l604"><span class="linenum"> 604</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l605"><span class="linenum"> 605</span></a>      }
<a name="l606"><span class="linenum"> 606</span></a>      
<a name="l607"><span class="linenum"> 607</span></a>      
<a name="l608"><span class="linenum"> 608</span></a>  	function <a class="function" onClick="logFunction('doHorizontalRules')" href="../../_functions/dohorizontalrules.html" onMouseOver="funcPopup(event,'dohorizontalrules')">doHorizontalRules</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l609"><span class="linenum"> 609</span></a>  <span class="comment">        # Do Horizontal Rules:</span>
<a name="l610"><span class="linenum"> 610</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(
<a name="l611"><span class="linenum"> 611</span></a>              '{
<a name="l612"><span class="linenum"> 612</span></a>                  ^[ ]{0,3}    <span class="comment"># Leading space</span>
<a name="l613"><span class="linenum"> 613</span></a>                  ([-*_])        # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>: First marker
<a name="l614"><span class="linenum"> 614</span></a>                  (?&gt;            # Repeated marker group
<a name="l615"><span class="linenum"> 615</span></a>                      [ ]{0,2}    <span class="comment"># Zero, one, or two spaces.</span>
<a name="l616"><span class="linenum"> 616</span></a>                      \1            # Marker character
<a name="l617"><span class="linenum"> 617</span></a>                  ){2,}        <span class="comment"># Group repeated at least twice</span>
<a name="l618"><span class="linenum"> 618</span></a>                  [ ]*        # Tailing spaces
<a name="l619"><span class="linenum"> 619</span></a>                  $            # End of line.
<a name="l620"><span class="linenum"> 620</span></a>              }mx',
<a name="l621"><span class="linenum"> 621</span></a>              &quot;\n&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(&quot;&lt;hr<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('empty_element_suffix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/empty_element_suffix.html">empty_element_suffix</a>&quot;).&quot;\n&quot;, 
<a name="l622"><span class="linenum"> 622</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l623"><span class="linenum"> 623</span></a>      }
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>  
<a name="l626"><span class="linenum"> 626</span></a>      var <a class="var it1096" onMouseOver="hilite(1096)" onMouseOut="lolite()" onClick="logVariable('span_gamut')" href="../../_variables/span_gamut.html">$span_gamut</a> = array(
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">    #</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">    # These are all the transformations that occur *within* block-level</span>
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">    # tags like paragraphs, headers, and list items.</span>
<a name="l630"><span class="linenum"> 630</span></a>  <span class="comment">    #</span>
<a name="l631"><span class="linenum"> 631</span></a>  <span class="comment">        # Process character escapes, code spans, and inline HTML</span>
<a name="l632"><span class="linenum"> 632</span></a>  <span class="comment">        # in one shot.</span>
<a name="l633"><span class="linenum"> 633</span></a>          &quot;parseSpan&quot;           =&gt; -30,
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>  <span class="comment">        # Process anchor and image tags. Images must come first,</span>
<a name="l636"><span class="linenum"> 636</span></a>  <span class="comment">        # because ![foo][f] looks like an anchor.</span>
<a name="l637"><span class="linenum"> 637</span></a>          &quot;doImages&quot;            =&gt;  10,
<a name="l638"><span class="linenum"> 638</span></a>          &quot;doAnchors&quot;           =&gt;  20,
<a name="l639"><span class="linenum"> 639</span></a>          
<a name="l640"><span class="linenum"> 640</span></a>  <span class="comment">        # Make links out of things like `&lt;http://example.com/&gt;`</span>
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">        # Must come after doAnchors, because you can use &lt; and &gt;</span>
<a name="l642"><span class="linenum"> 642</span></a>  <span class="comment">        # delimiters in inline links like [this](&lt;url&gt;).</span>
<a name="l643"><span class="linenum"> 643</span></a>          &quot;doAutoLinks&quot;         =&gt;  30,
<a name="l644"><span class="linenum"> 644</span></a>          &quot;encodeAmpsAndAngles&quot; =&gt;  40,
<a name="l645"><span class="linenum"> 645</span></a>  
<a name="l646"><span class="linenum"> 646</span></a>          &quot;doItalicsAndBold&quot;    =&gt;  50,
<a name="l647"><span class="linenum"> 647</span></a>          &quot;doHardBreaks&quot;        =&gt;  60,
<a name="l648"><span class="linenum"> 648</span></a>          );
<a name="l649"><span class="linenum"> 649</span></a>  
<a name="l650"><span class="linenum"> 650</span></a>  	function <a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment">    #</span>
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment">    # Run span gamut tranformations.</span>
<a name="l653"><span class="linenum"> 653</span></a>  <span class="comment">    #</span>
<a name="l654"><span class="linenum"> 654</span></a>          foreach (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('span_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/span_gamut.html">span_gamut</a> as <a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a> =&gt; <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('priority')" href="../../_variables/priority.html">$priority</a>) {
<a name="l655"><span class="linenum"> 655</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it154" onMouseOver="hilite(154)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../_variables/method.html">$method</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l656"><span class="linenum"> 656</span></a>          }
<a name="l657"><span class="linenum"> 657</span></a>  
<a name="l658"><span class="linenum"> 658</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l659"><span class="linenum"> 659</span></a>      }
<a name="l660"><span class="linenum"> 660</span></a>      
<a name="l661"><span class="linenum"> 661</span></a>      
<a name="l662"><span class="linenum"> 662</span></a>  	function <a class="function" onClick="logFunction('doHardBreaks')" href="../../_functions/dohardbreaks.html" onMouseOver="funcPopup(event,'dohardbreaks')">doHardBreaks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l663"><span class="linenum"> 663</span></a>  <span class="comment">        # Do hard breaks:</span>
<a name="l664"><span class="linenum"> 664</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('/ {2,}\n/', 
<a name="l665"><span class="linenum"> 665</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doHardBreaks_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l666"><span class="linenum"> 666</span></a>      }
<a name="l667"><span class="linenum"> 667</span></a>  	function <a class="function" onClick="logFunction('_doHardBreaks_callback')" href="../../_functions/_dohardbreaks_callback.html" onMouseOver="funcPopup(event,'_dohardbreaks_callback')">_doHardBreaks_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l668"><span class="linenum"> 668</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(&quot;&lt;br<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('empty_element_suffix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/empty_element_suffix.html">empty_element_suffix</a>\n&quot;);
<a name="l669"><span class="linenum"> 669</span></a>      }
<a name="l670"><span class="linenum"> 670</span></a>  
<a name="l671"><span class="linenum"> 671</span></a>  
<a name="l672"><span class="linenum"> 672</span></a>  	function <a class="function" onClick="logFunction('doAnchors')" href="../../_functions/doanchors.html" onMouseOver="funcPopup(event,'doanchors')">doAnchors</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">    #</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">    # Turn Markdown link shortcuts into XHTML &lt;a&gt; tags.</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">    #</span>
<a name="l676"><span class="linenum"> 676</span></a>          if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('in_anchor')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/in_anchor.html">in_anchor</a>) return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l677"><span class="linenum"> 677</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('in_anchor')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/in_anchor.html">in_anchor</a> = true;
<a name="l678"><span class="linenum"> 678</span></a>          
<a name="l679"><span class="linenum"> 679</span></a>  <span class="comment">        #</span>
<a name="l680"><span class="linenum"> 680</span></a>  <span class="comment">        # First, handle reference-style links: [link text] [id]</span>
<a name="l681"><span class="linenum"> 681</span></a>  <span class="comment">        #</span>
<a name="l682"><span class="linenum"> 682</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l683"><span class="linenum"> 683</span></a>              (                    # wrap whole match in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l684"><span class="linenum"> 684</span></a>                \[
<a name="l685"><span class="linenum"> 685</span></a>                  ('.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_re.html">nested_brackets_re</a>.')    # link text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l686"><span class="linenum"> 686</span></a>                \]
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>                [ ]?                # one optional space
<a name="l689"><span class="linenum"> 689</span></a>                (?:\n[ ]*)?        # one optional newline followed by spaces
<a name="l690"><span class="linenum"> 690</span></a>  
<a name="l691"><span class="linenum"> 691</span></a>                \[
<a name="l692"><span class="linenum"> 692</span></a>                  (.*?)        # id = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l693"><span class="linenum"> 693</span></a>                \]
<a name="l694"><span class="linenum"> 694</span></a>              )
<a name="l695"><span class="linenum"> 695</span></a>              }xs',
<a name="l696"><span class="linenum"> 696</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doAnchors_reference_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l697"><span class="linenum"> 697</span></a>  
<a name="l698"><span class="linenum"> 698</span></a>  <span class="comment">        #</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment">        # Next, inline-style links: [link text](url &quot;optional title&quot;)</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment">        #</span>
<a name="l701"><span class="linenum"> 701</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l702"><span class="linenum"> 702</span></a>              (                # wrap whole match in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l703"><span class="linenum"> 703</span></a>                \[
<a name="l704"><span class="linenum"> 704</span></a>                  ('.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_re.html">nested_brackets_re</a>.')    # link text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l705"><span class="linenum"> 705</span></a>                \]
<a name="l706"><span class="linenum"> 706</span></a>                \(            # literal paren
<a name="l707"><span class="linenum"> 707</span></a>                  [ \n]*
<a name="l708"><span class="linenum"> 708</span></a>                  (?:
<a name="l709"><span class="linenum"> 709</span></a>                      &lt;(.+?)&gt;    # href = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l710"><span class="linenum"> 710</span></a>                  |
<a name="l711"><span class="linenum"> 711</span></a>                      ('.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_url_parenthesis_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_url_parenthesis_re.html">nested_url_parenthesis_re</a>.')    # href = <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>
<a name="l712"><span class="linenum"> 712</span></a>                  )
<a name="l713"><span class="linenum"> 713</span></a>                  [ \n]*
<a name="l714"><span class="linenum"> 714</span></a>                  (            # <a class="var it1110" onMouseOver="hilite(1110)" onMouseOut="lolite()" onClick="logVariable('5')" href="../../_variables/5.html">$5</a>
<a name="l715"><span class="linenum"> 715</span></a>                    ([\'&quot;])    # quote char = <a class="var it1111" onMouseOver="hilite(1111)" onMouseOut="lolite()" onClick="logVariable('6')" href="../../_variables/6.html">$6</a>
<a name="l716"><span class="linenum"> 716</span></a>                    (.*?)        # Title = <a class="var it1112" onMouseOver="hilite(1112)" onMouseOut="lolite()" onClick="logVariable('7')" href="../../_variables/7.html">$7</a>
<a name="l717"><span class="linenum"> 717</span></a>                    \6        # matching quote
<a name="l718"><span class="linenum"> 718</span></a>                    [ \n]*    # ignore any spaces/tabs between closing quote and )
<a name="l719"><span class="linenum"> 719</span></a>                  )?            # title is optional
<a name="l720"><span class="linenum"> 720</span></a>                \)
<a name="l721"><span class="linenum"> 721</span></a>              )
<a name="l722"><span class="linenum"> 722</span></a>              }xs',
<a name="l723"><span class="linenum"> 723</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doAnchors_inline_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l724"><span class="linenum"> 724</span></a>  
<a name="l725"><span class="linenum"> 725</span></a>  <span class="comment">        #</span>
<a name="l726"><span class="linenum"> 726</span></a>  <span class="comment">        # Last, handle reference-style shortcuts: [link text]</span>
<a name="l727"><span class="linenum"> 727</span></a>  <span class="comment">        # These must come last in case you've also got [link text][1]</span>
<a name="l728"><span class="linenum"> 728</span></a>  <span class="comment">        # or [link text](/foo)</span>
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment">        #</span>
<a name="l730"><span class="linenum"> 730</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l731"><span class="linenum"> 731</span></a>              (                    # wrap whole match in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l732"><span class="linenum"> 732</span></a>                \[
<a name="l733"><span class="linenum"> 733</span></a>                  ([^\[\]]+)        # link text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>; can\'t contain [ or ]
<a name="l734"><span class="linenum"> 734</span></a>                \]
<a name="l735"><span class="linenum"> 735</span></a>              )
<a name="l736"><span class="linenum"> 736</span></a>              }xs',
<a name="l737"><span class="linenum"> 737</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doAnchors_reference_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l738"><span class="linenum"> 738</span></a>  
<a name="l739"><span class="linenum"> 739</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('in_anchor')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/in_anchor.html">in_anchor</a> = false;
<a name="l740"><span class="linenum"> 740</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l741"><span class="linenum"> 741</span></a>      }
<a name="l742"><span class="linenum"> 742</span></a>  	function <a class="function" onClick="logFunction('_doAnchors_reference_callback')" href="../../_functions/_doanchors_reference_callback.html" onMouseOver="funcPopup(event,'_doanchors_reference_callback')">_doAnchors_reference_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l743"><span class="linenum"> 743</span></a>          <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('whole_match')" href="../../_variables/whole_match.html">$whole_match</a> =  <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l744"><span class="linenum"> 744</span></a>          <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>   =  <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l745"><span class="linenum"> 745</span></a>          <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>     =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l746"><span class="linenum"> 746</span></a>  
<a name="l747"><span class="linenum"> 747</span></a>          if (<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> == &quot;&quot;) {
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment">            # for shortcut links like [this][] or [this].</span>
<a name="l749"><span class="linenum"> 749</span></a>              <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> = <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>;
<a name="l750"><span class="linenum"> 750</span></a>          }
<a name="l751"><span class="linenum"> 751</span></a>          
<a name="l752"><span class="linenum"> 752</span></a>  <span class="comment">        # lower-case and turn embedded newlines into spaces</span>
<a name="l753"><span class="linenum"> 753</span></a>          <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>);
<a name="l754"><span class="linenum"> 754</span></a>          <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('{[ ]?\n}', ' ', <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>);
<a name="l755"><span class="linenum"> 755</span></a>  
<a name="l756"><span class="linenum"> 756</span></a>          if (isset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>])) {
<a name="l757"><span class="linenum"> 757</span></a>              <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>];
<a name="l758"><span class="linenum"> 758</span></a>              <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l759"><span class="linenum"> 759</span></a>              
<a name="l760"><span class="linenum"> 760</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = &quot;&lt;a href=\&quot;<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>\&quot;&quot;;
<a name="l761"><span class="linenum"> 761</span></a>              if ( isset( <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>] ) ) {
<a name="l762"><span class="linenum"> 762</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>];
<a name="l763"><span class="linenum"> 763</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>);
<a name="l764"><span class="linenum"> 764</span></a>                  <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .=  &quot; title=\&quot;<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>\&quot;&quot;;
<a name="l765"><span class="linenum"> 765</span></a>              }
<a name="l766"><span class="linenum"> 766</span></a>          
<a name="l767"><span class="linenum"> 767</span></a>              <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>);
<a name="l768"><span class="linenum"> 768</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .= &quot;&gt;<a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>&lt;/a&gt;&quot;;
<a name="l769"><span class="linenum"> 769</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>);
<a name="l770"><span class="linenum"> 770</span></a>          }
<a name="l771"><span class="linenum"> 771</span></a>          else {
<a name="l772"><span class="linenum"> 772</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('whole_match')" href="../../_variables/whole_match.html">$whole_match</a>;
<a name="l773"><span class="linenum"> 773</span></a>          }
<a name="l774"><span class="linenum"> 774</span></a>          return <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l775"><span class="linenum"> 775</span></a>      }
<a name="l776"><span class="linenum"> 776</span></a>  	function <a class="function" onClick="logFunction('_doAnchors_inline_callback')" href="../../_functions/_doanchors_inline_callback.html" onMouseOver="funcPopup(event,'_doanchors_inline_callback')">_doAnchors_inline_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l777"><span class="linenum"> 777</span></a>          <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('whole_match')" href="../../_variables/whole_match.html">$whole_match</a>    =  <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l778"><span class="linenum"> 778</span></a>          <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>        =  <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2]);
<a name="l779"><span class="linenum"> 779</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>            =  <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] == '' ? <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[4] : <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l780"><span class="linenum"> 780</span></a>          <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>            =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[7];
<a name="l781"><span class="linenum"> 781</span></a>  
<a name="l782"><span class="linenum"> 782</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l783"><span class="linenum"> 783</span></a>  
<a name="l784"><span class="linenum"> 784</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = &quot;&lt;a href=\&quot;<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>\&quot;&quot;;
<a name="l785"><span class="linenum"> 785</span></a>          if (isset(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>)) {
<a name="l786"><span class="linenum"> 786</span></a>              <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>);
<a name="l787"><span class="linenum"> 787</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .=  &quot; title=\&quot;<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>\&quot;&quot;;
<a name="l788"><span class="linenum"> 788</span></a>          }
<a name="l789"><span class="linenum"> 789</span></a>          
<a name="l790"><span class="linenum"> 790</span></a>          <a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>);
<a name="l791"><span class="linenum"> 791</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .= &quot;&gt;<a class="var it1114" onMouseOver="hilite(1114)" onMouseOut="lolite()" onClick="logVariable('link_text')" href="../../_variables/link_text.html">$link_text</a>&lt;/a&gt;&quot;;
<a name="l792"><span class="linenum"> 792</span></a>  
<a name="l793"><span class="linenum"> 793</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>);
<a name="l794"><span class="linenum"> 794</span></a>      }
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>  
<a name="l797"><span class="linenum"> 797</span></a>  	function <a class="function" onClick="logFunction('doImages')" href="../../_functions/doimages.html" onMouseOver="funcPopup(event,'doimages')">doImages</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment">    #</span>
<a name="l799"><span class="linenum"> 799</span></a>  <span class="comment">    # Turn Markdown image shortcuts into &lt;img&gt; tags.</span>
<a name="l800"><span class="linenum"> 800</span></a>  <span class="comment">    #</span>
<a name="l801"><span class="linenum"> 801</span></a>  <span class="comment">        #</span>
<a name="l802"><span class="linenum"> 802</span></a>  <span class="comment">        # First, handle reference-style labeled images: ![alt text][id]</span>
<a name="l803"><span class="linenum"> 803</span></a>  <span class="comment">        #</span>
<a name="l804"><span class="linenum"> 804</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l805"><span class="linenum"> 805</span></a>              (                # wrap whole match in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l806"><span class="linenum"> 806</span></a>                !\[
<a name="l807"><span class="linenum"> 807</span></a>                  ('.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_re.html">nested_brackets_re</a>.')        # alt text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l808"><span class="linenum"> 808</span></a>                \]
<a name="l809"><span class="linenum"> 809</span></a>  
<a name="l810"><span class="linenum"> 810</span></a>                [ ]?                # one optional space
<a name="l811"><span class="linenum"> 811</span></a>                (?:\n[ ]*)?        # one optional newline followed by spaces
<a name="l812"><span class="linenum"> 812</span></a>  
<a name="l813"><span class="linenum"> 813</span></a>                \[
<a name="l814"><span class="linenum"> 814</span></a>                  (.*?)        # id = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l815"><span class="linenum"> 815</span></a>                \]
<a name="l816"><span class="linenum"> 816</span></a>  
<a name="l817"><span class="linenum"> 817</span></a>              )
<a name="l818"><span class="linenum"> 818</span></a>              }xs', 
<a name="l819"><span class="linenum"> 819</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doImages_reference_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>  <span class="comment">        #</span>
<a name="l822"><span class="linenum"> 822</span></a>  <span class="comment">        # Next, handle inline images:  ![alt text](url &quot;optional title&quot;)</span>
<a name="l823"><span class="linenum"> 823</span></a>  <span class="comment">        # Don't forget: encode * and _</span>
<a name="l824"><span class="linenum"> 824</span></a>  <span class="comment">        #</span>
<a name="l825"><span class="linenum"> 825</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l826"><span class="linenum"> 826</span></a>              (                # wrap whole match in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l827"><span class="linenum"> 827</span></a>                !\[
<a name="l828"><span class="linenum"> 828</span></a>                  ('.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_brackets_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_brackets_re.html">nested_brackets_re</a>.')        # alt text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l829"><span class="linenum"> 829</span></a>                \]
<a name="l830"><span class="linenum"> 830</span></a>                \s?            # One optional whitespace character
<a name="l831"><span class="linenum"> 831</span></a>                \(            # literal paren
<a name="l832"><span class="linenum"> 832</span></a>                  [ \n]*
<a name="l833"><span class="linenum"> 833</span></a>                  (?:
<a name="l834"><span class="linenum"> 834</span></a>                      &lt;(\S*)&gt;    # src url = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l835"><span class="linenum"> 835</span></a>                  |
<a name="l836"><span class="linenum"> 836</span></a>                      ('.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nested_url_parenthesis_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/nested_url_parenthesis_re.html">nested_url_parenthesis_re</a>.')    # src url = <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>
<a name="l837"><span class="linenum"> 837</span></a>                  )
<a name="l838"><span class="linenum"> 838</span></a>                  [ \n]*
<a name="l839"><span class="linenum"> 839</span></a>                  (            # <a class="var it1110" onMouseOver="hilite(1110)" onMouseOut="lolite()" onClick="logVariable('5')" href="../../_variables/5.html">$5</a>
<a name="l840"><span class="linenum"> 840</span></a>                    ([\'&quot;])    # quote char = <a class="var it1111" onMouseOver="hilite(1111)" onMouseOut="lolite()" onClick="logVariable('6')" href="../../_variables/6.html">$6</a>
<a name="l841"><span class="linenum"> 841</span></a>                    (.*?)        # title = <a class="var it1112" onMouseOver="hilite(1112)" onMouseOut="lolite()" onClick="logVariable('7')" href="../../_variables/7.html">$7</a>
<a name="l842"><span class="linenum"> 842</span></a>                    \6        # matching quote
<a name="l843"><span class="linenum"> 843</span></a>                    [ \n]*
<a name="l844"><span class="linenum"> 844</span></a>                  )?            # title is optional
<a name="l845"><span class="linenum"> 845</span></a>                \)
<a name="l846"><span class="linenum"> 846</span></a>              )
<a name="l847"><span class="linenum"> 847</span></a>              }xs',
<a name="l848"><span class="linenum"> 848</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doImages_inline_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l849"><span class="linenum"> 849</span></a>  
<a name="l850"><span class="linenum"> 850</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l851"><span class="linenum"> 851</span></a>      }
<a name="l852"><span class="linenum"> 852</span></a>  	function <a class="function" onClick="logFunction('_doImages_reference_callback')" href="../../_functions/_doimages_reference_callback.html" onMouseOver="funcPopup(event,'_doimages_reference_callback')">_doImages_reference_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l853"><span class="linenum"> 853</span></a>          <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('whole_match')" href="../../_variables/whole_match.html">$whole_match</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l854"><span class="linenum"> 854</span></a>          <a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l855"><span class="linenum"> 855</span></a>          <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>     = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3]);
<a name="l856"><span class="linenum"> 856</span></a>  
<a name="l857"><span class="linenum"> 857</span></a>          if (<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> == &quot;&quot;) {
<a name="l858"><span class="linenum"> 858</span></a>              <a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>); <span class="comment"># for shortcut links like ![this][].</span>
<a name="l859"><span class="linenum"> 859</span></a>          }
<a name="l860"><span class="linenum"> 860</span></a>  
<a name="l861"><span class="linenum"> 861</span></a>          <a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>);
<a name="l862"><span class="linenum"> 862</span></a>          if (isset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>])) {
<a name="l863"><span class="linenum"> 863</span></a>              <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('urls')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/urls.html">urls</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>]);
<a name="l864"><span class="linenum"> 864</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = &quot;&lt;img src=\&quot;<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>\&quot; alt=\&quot;<a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>\&quot;&quot;;
<a name="l865"><span class="linenum"> 865</span></a>              if (isset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>])) {
<a name="l866"><span class="linenum"> 866</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('titles')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/titles.html">titles</a>[<a class="var it1104" onMouseOver="hilite(1104)" onMouseOut="lolite()" onClick="logVariable('link_id')" href="../../_variables/link_id.html">$link_id</a>];
<a name="l867"><span class="linenum"> 867</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>);
<a name="l868"><span class="linenum"> 868</span></a>                  <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .=  &quot; title=\&quot;<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>\&quot;&quot;;
<a name="l869"><span class="linenum"> 869</span></a>              }
<a name="l870"><span class="linenum"> 870</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('empty_element_suffix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/empty_element_suffix.html">empty_element_suffix</a>;
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>);
<a name="l872"><span class="linenum"> 872</span></a>          }
<a name="l873"><span class="linenum"> 873</span></a>          else {
<a name="l874"><span class="linenum"> 874</span></a>  <span class="comment">            # If there's no such link ID, leave intact:</span>
<a name="l875"><span class="linenum"> 875</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('whole_match')" href="../../_variables/whole_match.html">$whole_match</a>;
<a name="l876"><span class="linenum"> 876</span></a>          }
<a name="l877"><span class="linenum"> 877</span></a>  
<a name="l878"><span class="linenum"> 878</span></a>          return <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l879"><span class="linenum"> 879</span></a>      }
<a name="l880"><span class="linenum"> 880</span></a>  	function <a class="function" onClick="logFunction('_doImages_inline_callback')" href="../../_functions/_doimages_inline_callback.html" onMouseOver="funcPopup(event,'_doimages_inline_callback')">_doImages_inline_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l881"><span class="linenum"> 881</span></a>          <a class="var it1113" onMouseOver="hilite(1113)" onMouseOut="lolite()" onClick="logVariable('whole_match')" href="../../_variables/whole_match.html">$whole_match</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l882"><span class="linenum"> 882</span></a>          <a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>        = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l883"><span class="linenum"> 883</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>            = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] == '' ? <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[4] : <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l884"><span class="linenum"> 884</span></a>          <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>            =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[7];
<a name="l885"><span class="linenum"> 885</span></a>  
<a name="l886"><span class="linenum"> 886</span></a>          <a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>);
<a name="l887"><span class="linenum"> 887</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>);
<a name="l888"><span class="linenum"> 888</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = &quot;&lt;img src=\&quot;<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>\&quot; alt=\&quot;<a class="var it1115" onMouseOver="hilite(1115)" onMouseOut="lolite()" onClick="logVariable('alt_text')" href="../../_variables/alt_text.html">$alt_text</a>\&quot;&quot;;
<a name="l889"><span class="linenum"> 889</span></a>          if (isset(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>)) {
<a name="l890"><span class="linenum"> 890</span></a>              <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>);
<a name="l891"><span class="linenum"> 891</span></a>              <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .=  &quot; title=\&quot;<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>\&quot;&quot;; <span class="comment"># $title already quoted</span>
<a name="l892"><span class="linenum"> 892</span></a>          }
<a name="l893"><span class="linenum"> 893</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('empty_element_suffix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/empty_element_suffix.html">empty_element_suffix</a>;
<a name="l894"><span class="linenum"> 894</span></a>  
<a name="l895"><span class="linenum"> 895</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>);
<a name="l896"><span class="linenum"> 896</span></a>      }
<a name="l897"><span class="linenum"> 897</span></a>  
<a name="l898"><span class="linenum"> 898</span></a>  
<a name="l899"><span class="linenum"> 899</span></a>  	function <a class="function" onClick="logFunction('doHeaders')" href="../../_functions/doheaders.html" onMouseOver="funcPopup(event,'doheaders')">doHeaders</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l900"><span class="linenum"> 900</span></a>  <span class="comment">        # Setext-style headers:</span>
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">        #      Header 1</span>
<a name="l902"><span class="linenum"> 902</span></a>  <span class="comment">        #      ========</span>
<a name="l903"><span class="linenum"> 903</span></a>  <span class="comment">        #  </span>
<a name="l904"><span class="linenum"> 904</span></a>  <span class="comment">        #      Header 2</span>
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">        #      --------</span>
<a name="l906"><span class="linenum"> 906</span></a>  <span class="comment">        #</span>
<a name="l907"><span class="linenum"> 907</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{ ^(.+?)[ ]*\n(=+|-+)[ ]*\n+ }mx',
<a name="l908"><span class="linenum"> 908</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doHeaders_callback_setext'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l909"><span class="linenum"> 909</span></a>  
<a name="l910"><span class="linenum"> 910</span></a>  <span class="comment">        # atx-style headers:</span>
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">        #    # Header 1</span>
<a name="l912"><span class="linenum"> 912</span></a>  <span class="comment">        #    ## Header 2</span>
<a name="l913"><span class="linenum"> 913</span></a>  <span class="comment">        #    ## Header 2 with closing hashes ##</span>
<a name="l914"><span class="linenum"> 914</span></a>  <span class="comment">        #    ...</span>
<a name="l915"><span class="linenum"> 915</span></a>  <span class="comment">        #    ###### Header 6</span>
<a name="l916"><span class="linenum"> 916</span></a>  <span class="comment">        #</span>
<a name="l917"><span class="linenum"> 917</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l918"><span class="linenum"> 918</span></a>                  ^(\#{1,6})    # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a> = string of #\'s
<a name="l919"><span class="linenum"> 919</span></a>                  [ ]*
<a name="l920"><span class="linenum"> 920</span></a>                  (.+?)        # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a> = Header text
<a name="l921"><span class="linenum"> 921</span></a>                  [ ]*
<a name="l922"><span class="linenum"> 922</span></a>                  \#*            # optional closing #\'s (not counted)
<a name="l923"><span class="linenum"> 923</span></a>                  \n+
<a name="l924"><span class="linenum"> 924</span></a>              }xm',
<a name="l925"><span class="linenum"> 925</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doHeaders_callback_atx'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l926"><span class="linenum"> 926</span></a>  
<a name="l927"><span class="linenum"> 927</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l928"><span class="linenum"> 928</span></a>      }
<a name="l929"><span class="linenum"> 929</span></a>  	function <a class="function" onClick="logFunction('_doHeaders_callback_setext')" href="../../_functions/_doheaders_callback_setext.html" onMouseOver="funcPopup(event,'_doheaders_callback_setext')">_doHeaders_callback_setext</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l930"><span class="linenum"> 930</span></a>  <span class="comment">        # Terrible hack to check we haven't found an empty list item.</span>
<a name="l931"><span class="linenum"> 931</span></a>          if (<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] == '-' &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^-(?: |$)}', <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]))
<a name="l932"><span class="linenum"> 932</span></a>              return <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l933"><span class="linenum"> 933</span></a>          
<a name="l934"><span class="linenum"> 934</span></a>          <a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2]{0} == '=' ? 1 : 2;
<a name="l935"><span class="linenum"> 935</span></a>          <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a> = &quot;&lt;h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>&gt;&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]).&quot;&lt;/h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>&gt;&quot;;
<a name="l936"><span class="linenum"> 936</span></a>          return &quot;\n&quot; . <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>) . &quot;\n\n&quot;;
<a name="l937"><span class="linenum"> 937</span></a>      }
<a name="l938"><span class="linenum"> 938</span></a>  	function <a class="function" onClick="logFunction('_doHeaders_callback_atx')" href="../../_functions/_doheaders_callback_atx.html" onMouseOver="funcPopup(event,'_doheaders_callback_atx')">_doHeaders_callback_atx</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l939"><span class="linenum"> 939</span></a>          <a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> = strlen(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]);
<a name="l940"><span class="linenum"> 940</span></a>          <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a> = &quot;&lt;h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>&gt;&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2]).&quot;&lt;/h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>&gt;&quot;;
<a name="l941"><span class="linenum"> 941</span></a>          return &quot;\n&quot; . <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>) . &quot;\n\n&quot;;
<a name="l942"><span class="linenum"> 942</span></a>      }
<a name="l943"><span class="linenum"> 943</span></a>  
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>  	function <a class="function" onClick="logFunction('doLists')" href="../../_functions/dolists.html" onMouseOver="funcPopup(event,'dolists')">doLists</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l946"><span class="linenum"> 946</span></a>  <span class="comment">    #</span>
<a name="l947"><span class="linenum"> 947</span></a>  <span class="comment">    # Form HTML ordered (numbered) and unordered (bulleted) lists.</span>
<a name="l948"><span class="linenum"> 948</span></a>  <span class="comment">    #</span>
<a name="l949"><span class="linenum"> 949</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l950"><span class="linenum"> 950</span></a>  
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">        # Re-usable patterns to match list item bullets and number markers:</span>
<a name="l952"><span class="linenum"> 952</span></a>          <a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a>  = '[*+-]';
<a name="l953"><span class="linenum"> 953</span></a>          <a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a>  = '\d+[.]';
<a name="l954"><span class="linenum"> 954</span></a>          <a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a> = &quot;(?:<a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a>|<a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a>)&quot;;
<a name="l955"><span class="linenum"> 955</span></a>  
<a name="l956"><span class="linenum"> 956</span></a>          <a class="var it1121" onMouseOver="hilite(1121)" onMouseOut="lolite()" onClick="logVariable('markers_relist')" href="../../_variables/markers_relist.html">$markers_relist</a> = array(
<a name="l957"><span class="linenum"> 957</span></a>              <a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a> =&gt; <a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a>,
<a name="l958"><span class="linenum"> 958</span></a>              <a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a> =&gt; <a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a>,
<a name="l959"><span class="linenum"> 959</span></a>              );
<a name="l960"><span class="linenum"> 960</span></a>  
<a name="l961"><span class="linenum"> 961</span></a>          foreach (<a class="var it1121" onMouseOver="hilite(1121)" onMouseOut="lolite()" onClick="logVariable('markers_relist')" href="../../_variables/markers_relist.html">$markers_relist</a> as <a class="var it1122" onMouseOver="hilite(1122)" onMouseOut="lolite()" onClick="logVariable('marker_re')" href="../../_variables/marker_re.html">$marker_re</a> =&gt; <a class="var it1123" onMouseOver="hilite(1123)" onMouseOut="lolite()" onClick="logVariable('other_marker_re')" href="../../_variables/other_marker_re.html">$other_marker_re</a>) {
<a name="l962"><span class="linenum"> 962</span></a>  <span class="comment">            # Re-usable pattern to match any entirel ul or ol list:</span>
<a name="l963"><span class="linenum"> 963</span></a>              <a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('whole_list_re')" href="../../_variables/whole_list_re.html">$whole_list_re</a> = '
<a name="l964"><span class="linenum"> 964</span></a>                  (                                # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a> = whole list
<a name="l965"><span class="linenum"> 965</span></a>                    (                                # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l966"><span class="linenum"> 966</span></a>                      ([ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'})    # <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a> = number of spaces
<a name="l967"><span class="linenum"> 967</span></a>                      ('.<a class="var it1122" onMouseOver="hilite(1122)" onMouseOut="lolite()" onClick="logVariable('marker_re')" href="../../_variables/marker_re.html">$marker_re</a>.')            # <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a> = first list item marker
<a name="l968"><span class="linenum"> 968</span></a>                      [ ]+
<a name="l969"><span class="linenum"> 969</span></a>                    )
<a name="l970"><span class="linenum"> 970</span></a>                    (?s:.+?)
<a name="l971"><span class="linenum"> 971</span></a>                    (                                # <a class="var it1110" onMouseOver="hilite(1110)" onMouseOut="lolite()" onClick="logVariable('5')" href="../../_variables/5.html">$5</a>
<a name="l972"><span class="linenum"> 972</span></a>                        \z
<a name="l973"><span class="linenum"> 973</span></a>                      |
<a name="l974"><span class="linenum"> 974</span></a>                        \n{2,}
<a name="l975"><span class="linenum"> 975</span></a>                        (?=\S)
<a name="l976"><span class="linenum"> 976</span></a>                        (?!                        # Negative lookahead for another list item marker
<a name="l977"><span class="linenum"> 977</span></a>                          [ ]*
<a name="l978"><span class="linenum"> 978</span></a>                          '.<a class="var it1122" onMouseOver="hilite(1122)" onMouseOut="lolite()" onClick="logVariable('marker_re')" href="../../_variables/marker_re.html">$marker_re</a>.'[ ]+
<a name="l979"><span class="linenum"> 979</span></a>                        )
<a name="l980"><span class="linenum"> 980</span></a>                      |
<a name="l981"><span class="linenum"> 981</span></a>                        (?=                        # Lookahead for another kind of list
<a name="l982"><span class="linenum"> 982</span></a>                          \n
<a name="l983"><span class="linenum"> 983</span></a>                          \3                        # Must have the same indentation
<a name="l984"><span class="linenum"> 984</span></a>                          '.<a class="var it1123" onMouseOver="hilite(1123)" onMouseOut="lolite()" onClick="logVariable('other_marker_re')" href="../../_variables/other_marker_re.html">$other_marker_re</a>.'[ ]+
<a name="l985"><span class="linenum"> 985</span></a>                        )
<a name="l986"><span class="linenum"> 986</span></a>                    )
<a name="l987"><span class="linenum"> 987</span></a>                  )
<a name="l988"><span class="linenum"> 988</span></a>              '; <span class="comment">// mx</span>
<a name="l989"><span class="linenum"> 989</span></a>              
<a name="l990"><span class="linenum"> 990</span></a>  <span class="comment">            # We use a different prefix before nested lists than top-level lists.</span>
<a name="l991"><span class="linenum"> 991</span></a>  <span class="comment">            # See extended comment in _ProcessListItems().</span>
<a name="l992"><span class="linenum"> 992</span></a>          
<a name="l993"><span class="linenum"> 993</span></a>              if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('list_level')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/list_level.html">list_level</a>) {
<a name="l994"><span class="linenum"> 994</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l995"><span class="linenum"> 995</span></a>                          ^
<a name="l996"><span class="linenum"> 996</span></a>                          '.<a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('whole_list_re')" href="../../_variables/whole_list_re.html">$whole_list_re</a>.'
<a name="l997"><span class="linenum"> 997</span></a>                      }mx',
<a name="l998"><span class="linenum"> 998</span></a>                      array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doLists_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l999"><span class="linenum"> 999</span></a>              }
<a name="l1000"><span class="linenum">1000</span></a>              else {
<a name="l1001"><span class="linenum">1001</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l1002"><span class="linenum">1002</span></a>                          (?:(?&lt;=\n)\n|\A\n?) # Must eat the newline
<a name="l1003"><span class="linenum">1003</span></a>                          '.<a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('whole_list_re')" href="../../_variables/whole_list_re.html">$whole_list_re</a>.'
<a name="l1004"><span class="linenum">1004</span></a>                      }mx',
<a name="l1005"><span class="linenum">1005</span></a>                      array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doLists_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1006"><span class="linenum">1006</span></a>              }
<a name="l1007"><span class="linenum">1007</span></a>          }
<a name="l1008"><span class="linenum">1008</span></a>  
<a name="l1009"><span class="linenum">1009</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1010"><span class="linenum">1010</span></a>      }
<a name="l1011"><span class="linenum">1011</span></a>  	function <a class="function" onClick="logFunction('_doLists_callback')" href="../../_functions/_dolists_callback.html" onMouseOver="funcPopup(event,'_dolists_callback')">_doLists_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1012"><span class="linenum">1012</span></a>  <span class="comment">        # Re-usable patterns to match list item bullets and number markers:</span>
<a name="l1013"><span class="linenum">1013</span></a>          <a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a>  = '[*+-]';
<a name="l1014"><span class="linenum">1014</span></a>          <a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a>  = '\d+[.]';
<a name="l1015"><span class="linenum">1015</span></a>          <a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a> = &quot;(?:<a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a>|<a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a>)&quot;;
<a name="l1016"><span class="linenum">1016</span></a>          
<a name="l1017"><span class="linenum">1017</span></a>          <a class="var it327" onMouseOver="hilite(327)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1018"><span class="linenum">1018</span></a>          <a class="var it1126" onMouseOver="hilite(1126)" onMouseOut="lolite()" onClick="logVariable('list_type')" href="../../_variables/list_type.html">$list_type</a> = <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(&quot;/<a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a>/&quot;, <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[4]) ? &quot;ul&quot; : &quot;ol&quot;;
<a name="l1019"><span class="linenum">1019</span></a>          
<a name="l1020"><span class="linenum">1020</span></a>          <a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a> = ( <a class="var it1126" onMouseOver="hilite(1126)" onMouseOut="lolite()" onClick="logVariable('list_type')" href="../../_variables/list_type.html">$list_type</a> == &quot;ul&quot; ? <a class="var it1118" onMouseOver="hilite(1118)" onMouseOut="lolite()" onClick="logVariable('marker_ul_re')" href="../../_variables/marker_ul_re.html">$marker_ul_re</a> : <a class="var it1119" onMouseOver="hilite(1119)" onMouseOut="lolite()" onClick="logVariable('marker_ol_re')" href="../../_variables/marker_ol_re.html">$marker_ol_re</a> );
<a name="l1021"><span class="linenum">1021</span></a>          
<a name="l1022"><span class="linenum">1022</span></a>          <a class="var it327" onMouseOver="hilite(327)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a> .= &quot;\n&quot;;
<a name="l1023"><span class="linenum">1023</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('processListItems')" href="../../_functions/processlistitems.html" onMouseOver="funcPopup(event,'processlistitems')">processListItems</a>(<a class="var it327" onMouseOver="hilite(327)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a>, <a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a>);
<a name="l1024"><span class="linenum">1024</span></a>          
<a name="l1025"><span class="linenum">1025</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(&quot;&lt;<a class="var it1126" onMouseOver="hilite(1126)" onMouseOut="lolite()" onClick="logVariable('list_type')" href="../../_variables/list_type.html">$list_type</a>&gt;\n&quot; . <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> . &quot;&lt;/<a class="var it1126" onMouseOver="hilite(1126)" onMouseOut="lolite()" onClick="logVariable('list_type')" href="../../_variables/list_type.html">$list_type</a>&gt;&quot;);
<a name="l1026"><span class="linenum">1026</span></a>          return &quot;\n&quot;. <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> .&quot;\n\n&quot;;
<a name="l1027"><span class="linenum">1027</span></a>      }
<a name="l1028"><span class="linenum">1028</span></a>  
<a name="l1029"><span class="linenum">1029</span></a>      var <a class="var it1125" onMouseOver="hilite(1125)" onMouseOut="lolite()" onClick="logVariable('list_level')" href="../../_variables/list_level.html">$list_level</a> = 0;
<a name="l1030"><span class="linenum">1030</span></a>  
<a name="l1031"><span class="linenum">1031</span></a>  	function <a class="function" onClick="logFunction('processListItems')" href="../../_functions/processlistitems.html" onMouseOver="funcPopup(event,'processlistitems')">processListItems</a>(<a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>, <a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a>) {
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">    #</span>
<a name="l1033"><span class="linenum">1033</span></a>  <span class="comment">    #    Process the contents of a single ordered or unordered list, splitting it</span>
<a name="l1034"><span class="linenum">1034</span></a>  <span class="comment">    #    into individual list items.</span>
<a name="l1035"><span class="linenum">1035</span></a>  <span class="comment">    #</span>
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">        # The $this-&gt;list_level global keeps track of when we're inside a list.</span>
<a name="l1037"><span class="linenum">1037</span></a>  <span class="comment">        # Each time we enter a list, we increment it; when we leave a list,</span>
<a name="l1038"><span class="linenum">1038</span></a>  <span class="comment">        # we decrement. If it's zero, we're not in a list anymore.</span>
<a name="l1039"><span class="linenum">1039</span></a>  <span class="comment">        #</span>
<a name="l1040"><span class="linenum">1040</span></a>  <span class="comment">        # We do this because when we're not inside a list, we want to treat</span>
<a name="l1041"><span class="linenum">1041</span></a>  <span class="comment">        # something like this:</span>
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">        #</span>
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">        #        I recommend upgrading to version</span>
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">        #        8. Oops, now this line is treated</span>
<a name="l1045"><span class="linenum">1045</span></a>  <span class="comment">        #        as a sub-list.</span>
<a name="l1046"><span class="linenum">1046</span></a>  <span class="comment">        #</span>
<a name="l1047"><span class="linenum">1047</span></a>  <span class="comment">        # As a single paragraph, despite the fact that the second line starts</span>
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment">        # with a digit-period-space sequence.</span>
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment">        #</span>
<a name="l1050"><span class="linenum">1050</span></a>  <span class="comment">        # Whereas when we're inside a list (or sub-list), that line will be</span>
<a name="l1051"><span class="linenum">1051</span></a>  <span class="comment">        # treated as the start of a sub-list. What a kludge, huh? This is</span>
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment">        # an aspect of Markdown's syntax that's hard to parse perfectly</span>
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment">        # without resorting to mind-reading. Perhaps the solution is to</span>
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment">        # change the syntax rules such that sub-lists must start with a</span>
<a name="l1055"><span class="linenum">1055</span></a>  <span class="comment">        # starting cardinal number; e.g. &quot;1.&quot; or &quot;a.&quot;.</span>
<a name="l1056"><span class="linenum">1056</span></a>          
<a name="l1057"><span class="linenum">1057</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('list_level')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/list_level.html">list_level</a>++;
<a name="l1058"><span class="linenum">1058</span></a>  
<a name="l1059"><span class="linenum">1059</span></a>  <span class="comment">        # trim trailing blank lines:</span>
<a name="l1060"><span class="linenum">1060</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(&quot;/\n{2,}\\z/&quot;, &quot;\n&quot;, <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>);
<a name="l1061"><span class="linenum">1061</span></a>  
<a name="l1062"><span class="linenum">1062</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l1063"><span class="linenum">1063</span></a>              (\n)?                            # leading line = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l1064"><span class="linenum">1064</span></a>              (^[ ]*)                            # leading whitespace = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l1065"><span class="linenum">1065</span></a>              ('.<a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a>.'                # list marker and space = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l1066"><span class="linenum">1066</span></a>                  (?:[ ]+|(?=\n))    # space only required if item is not empty
<a name="l1067"><span class="linenum">1067</span></a>              )
<a name="l1068"><span class="linenum">1068</span></a>              ((?s:.*?))                        # list item text   = <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>
<a name="l1069"><span class="linenum">1069</span></a>              (?:(\n+(?=\n))|\n)                # tailing blank line = <a class="var it1110" onMouseOver="hilite(1110)" onMouseOut="lolite()" onClick="logVariable('5')" href="../../_variables/5.html">$5</a>
<a name="l1070"><span class="linenum">1070</span></a>              (?= \n* (\z | \2 ('.<a class="var it1120" onMouseOver="hilite(1120)" onMouseOut="lolite()" onClick="logVariable('marker_any_re')" href="../../_variables/marker_any_re.html">$marker_any_re</a>.') (?:[ ]+|(?=\n))))
<a name="l1071"><span class="linenum">1071</span></a>              }xm',
<a name="l1072"><span class="linenum">1072</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_processListItems_callback'), <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>);
<a name="l1073"><span class="linenum">1073</span></a>  
<a name="l1074"><span class="linenum">1074</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('list_level')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/list_level.html">list_level</a>--;
<a name="l1075"><span class="linenum">1075</span></a>          return <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>;
<a name="l1076"><span class="linenum">1076</span></a>      }
<a name="l1077"><span class="linenum">1077</span></a>  	function <a class="function" onClick="logFunction('_processListItems_callback')" href="../../_functions/_processlistitems_callback.html" onMouseOver="funcPopup(event,'_processlistitems_callback')">_processListItems_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1078"><span class="linenum">1078</span></a>          <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[4];
<a name="l1079"><span class="linenum">1079</span></a>          <a class="var it1128" onMouseOver="hilite(1128)" onMouseOut="lolite()" onClick="logVariable('leading_line')" href="../../_variables/leading_line.html">$leading_line</a> =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1080"><span class="linenum">1080</span></a>          <a class="var it1129" onMouseOver="hilite(1129)" onMouseOut="lolite()" onClick="logVariable('leading_space')" href="../../_variables/leading_space.html">$leading_space</a> =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l1081"><span class="linenum">1081</span></a>          <a class="var it1130" onMouseOver="hilite(1130)" onMouseOut="lolite()" onClick="logVariable('marker_space')" href="../../_variables/marker_space.html">$marker_space</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l1082"><span class="linenum">1082</span></a>          <a class="var it1131" onMouseOver="hilite(1131)" onMouseOut="lolite()" onClick="logVariable('tailing_blank_line')" href="../../_variables/tailing_blank_line.html">$tailing_blank_line</a> =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[5];
<a name="l1083"><span class="linenum">1083</span></a>  
<a name="l1084"><span class="linenum">1084</span></a>          if (<a class="var it1128" onMouseOver="hilite(1128)" onMouseOut="lolite()" onClick="logVariable('leading_line')" href="../../_variables/leading_line.html">$leading_line</a> || <a class="var it1131" onMouseOver="hilite(1131)" onMouseOut="lolite()" onClick="logVariable('tailing_blank_line')" href="../../_variables/tailing_blank_line.html">$tailing_blank_line</a> || 
<a name="l1085"><span class="linenum">1085</span></a>              <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/\n{2,}/', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>))
<a name="l1086"><span class="linenum">1086</span></a>          {
<a name="l1087"><span class="linenum">1087</span></a>  <span class="comment">            # Replace marker with the appropriate whitespace indentation</span>
<a name="l1088"><span class="linenum">1088</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> = <a class="var it1129" onMouseOver="hilite(1129)" onMouseOut="lolite()" onClick="logVariable('leading_space')" href="../../_variables/leading_space.html">$leading_space</a> . <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>(' ', strlen(<a class="var it1130" onMouseOver="hilite(1130)" onMouseOut="lolite()" onClick="logVariable('marker_space')" href="../../_variables/marker_space.html">$marker_space</a>)) . <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>;
<a name="l1089"><span class="linenum">1089</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runBlockGamut')" href="../../_functions/runblockgamut.html" onMouseOver="funcPopup(event,'runblockgamut')">runBlockGamut</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>).&quot;\n&quot;);
<a name="l1090"><span class="linenum">1090</span></a>          }
<a name="l1091"><span class="linenum">1091</span></a>          else {
<a name="l1092"><span class="linenum">1092</span></a>  <span class="comment">            # Recursion for sub-lists:</span>
<a name="l1093"><span class="linenum">1093</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('doLists')" href="../../_functions/dolists.html" onMouseOver="funcPopup(event,'dolists')">doLists</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>));
<a name="l1094"><span class="linenum">1094</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\n+$/', '', <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>);
<a name="l1095"><span class="linenum">1095</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a>);
<a name="l1096"><span class="linenum">1096</span></a>          }
<a name="l1097"><span class="linenum">1097</span></a>  
<a name="l1098"><span class="linenum">1098</span></a>          return &quot;&lt;li&gt;&quot; . <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../_variables/item.html">$item</a> . &quot;&lt;/li&gt;\n&quot;;
<a name="l1099"><span class="linenum">1099</span></a>      }
<a name="l1100"><span class="linenum">1100</span></a>  
<a name="l1101"><span class="linenum">1101</span></a>  
<a name="l1102"><span class="linenum">1102</span></a>  	function <a class="function" onClick="logFunction('doCodeBlocks')" href="../../_functions/docodeblocks.html" onMouseOver="funcPopup(event,'docodeblocks')">doCodeBlocks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1103"><span class="linenum">1103</span></a>  <span class="comment">    #</span>
<a name="l1104"><span class="linenum">1104</span></a>  <span class="comment">    #    Process Markdown `&lt;pre&gt;&lt;code&gt;` blocks.</span>
<a name="l1105"><span class="linenum">1105</span></a>  <span class="comment">    #</span>
<a name="l1106"><span class="linenum">1106</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l1107"><span class="linenum">1107</span></a>                  (?:\n\n|\A\n?)
<a name="l1108"><span class="linenum">1108</span></a>                  (                # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a> = the code block -- one or more lines, starting with a space/tab
<a name="l1109"><span class="linenum">1109</span></a>                    (?&gt;
<a name="l1110"><span class="linenum">1110</span></a>                      [ ]{'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a>.'}  <span class="comment"># Lines must start with a tab or a tab-width of spaces</span>
<a name="l1111"><span class="linenum">1111</span></a>                      .*\n+
<a name="l1112"><span class="linenum">1112</span></a>                    )+
<a name="l1113"><span class="linenum">1113</span></a>                  )
<a name="l1114"><span class="linenum">1114</span></a>                  ((?=^[ ]{0,'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a>.'}\S)|\Z)    # Lookahead for non-space at line-start, or end of doc
<a name="l1115"><span class="linenum">1115</span></a>              }xm',
<a name="l1116"><span class="linenum">1116</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doCodeBlocks_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1117"><span class="linenum">1117</span></a>  
<a name="l1118"><span class="linenum">1118</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1119"><span class="linenum">1119</span></a>      }
<a name="l1120"><span class="linenum">1120</span></a>  	function <a class="function" onClick="logFunction('_doCodeBlocks_callback')" href="../../_functions/_docodeblocks_callback.html" onMouseOver="funcPopup(event,'_docodeblocks_callback')">_doCodeBlocks_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1121"><span class="linenum">1121</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1122"><span class="linenum">1122</span></a>  
<a name="l1123"><span class="linenum">1123</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>);
<a name="l1124"><span class="linenum">1124</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>, ENT_NOQUOTES);
<a name="l1125"><span class="linenum">1125</span></a>  
<a name="l1126"><span class="linenum">1126</span></a>  <span class="comment">        # trim leading newlines and trailing newlines</span>
<a name="l1127"><span class="linenum">1127</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\A\n+|\n+\z/', '', <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>);
<a name="l1128"><span class="linenum">1128</span></a>  
<a name="l1129"><span class="linenum">1129</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = &quot;&lt;pre&gt;&lt;code&gt;<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>\n&lt;/code&gt;&lt;/pre&gt;&quot;;
<a name="l1130"><span class="linenum">1130</span></a>          return &quot;\n\n&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>).&quot;\n\n&quot;;
<a name="l1131"><span class="linenum">1131</span></a>      }
<a name="l1132"><span class="linenum">1132</span></a>  
<a name="l1133"><span class="linenum">1133</span></a>  
<a name="l1134"><span class="linenum">1134</span></a>  	function <a class="function" onClick="logFunction('makeCodeSpan')" href="../../_functions/makecodespan.html" onMouseOver="funcPopup(event,'makecodespan')">makeCodeSpan</a>(<a class="var it680" onMouseOver="hilite(680)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a>) {
<a name="l1135"><span class="linenum">1135</span></a>  <span class="comment">    #</span>
<a name="l1136"><span class="linenum">1136</span></a>  <span class="comment">    # Create a code span markup for $code. Called from handleSpanToken.</span>
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment">    #</span>
<a name="l1138"><span class="linenum">1138</span></a>          <a class="var it680" onMouseOver="hilite(680)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it680" onMouseOver="hilite(680)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a>), ENT_NOQUOTES);
<a name="l1139"><span class="linenum">1139</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(&quot;&lt;code&gt;<a class="var it680" onMouseOver="hilite(680)" onMouseOut="lolite()" onClick="logVariable('code')" href="../../_variables/code.html">$code</a>&lt;/code&gt;&quot;);
<a name="l1140"><span class="linenum">1140</span></a>      }
<a name="l1141"><span class="linenum">1141</span></a>  
<a name="l1142"><span class="linenum">1142</span></a>  
<a name="l1143"><span class="linenum">1143</span></a>      var <a class="var it1133" onMouseOver="hilite(1133)" onMouseOut="lolite()" onClick="logVariable('em_relist')" href="../../_variables/em_relist.html">$em_relist</a> = array(
<a name="l1144"><span class="linenum">1144</span></a>          ''  =&gt; '(?:(?&lt;!\*)\*(?!\*)|(?&lt;!_)_(?!_))(?=\S|$)(?![.,:;]\s)',
<a name="l1145"><span class="linenum">1145</span></a>          '*' =&gt; '(?&lt;=\S|^)(?&lt;!\*)\*(?!\*)',
<a name="l1146"><span class="linenum">1146</span></a>          '_' =&gt; '(?&lt;=\S|^)(?&lt;!_)_(?!_)',
<a name="l1147"><span class="linenum">1147</span></a>          );
<a name="l1148"><span class="linenum">1148</span></a>      var <a class="var it1134" onMouseOver="hilite(1134)" onMouseOut="lolite()" onClick="logVariable('strong_relist')" href="../../_variables/strong_relist.html">$strong_relist</a> = array(
<a name="l1149"><span class="linenum">1149</span></a>          ''   =&gt; '(?:(?&lt;!\*)\*\*(?!\*)|(?&lt;!_)__(?!_))(?=\S|$)(?![.,:;]\s)',
<a name="l1150"><span class="linenum">1150</span></a>          '**' =&gt; '(?&lt;=\S|^)(?&lt;!\*)\*\*(?!\*)',
<a name="l1151"><span class="linenum">1151</span></a>          '__' =&gt; '(?&lt;=\S|^)(?&lt;!_)__(?!_)',
<a name="l1152"><span class="linenum">1152</span></a>          );
<a name="l1153"><span class="linenum">1153</span></a>      var <a class="var it1135" onMouseOver="hilite(1135)" onMouseOut="lolite()" onClick="logVariable('em_strong_relist')" href="../../_variables/em_strong_relist.html">$em_strong_relist</a> = array(
<a name="l1154"><span class="linenum">1154</span></a>          ''    =&gt; '(?:(?&lt;!\*)\*\*\*(?!\*)|(?&lt;!_)___(?!_))(?=\S|$)(?![.,:;]\s)',
<a name="l1155"><span class="linenum">1155</span></a>          '***' =&gt; '(?&lt;=\S|^)(?&lt;!\*)\*\*\*(?!\*)',
<a name="l1156"><span class="linenum">1156</span></a>          '___' =&gt; '(?&lt;=\S|^)(?&lt;!_)___(?!_)',
<a name="l1157"><span class="linenum">1157</span></a>          );
<a name="l1158"><span class="linenum">1158</span></a>      var <a class="var it1136" onMouseOver="hilite(1136)" onMouseOut="lolite()" onClick="logVariable('em_strong_prepared_relist')" href="../../_variables/em_strong_prepared_relist.html">$em_strong_prepared_relist</a>;
<a name="l1159"><span class="linenum">1159</span></a>      
<a name="l1160"><span class="linenum">1160</span></a>  	function <a class="function" onClick="logFunction('prepareItalicsAndBold')" href="../../_functions/prepareitalicsandbold.html" onMouseOver="funcPopup(event,'prepareitalicsandbold')">prepareItalicsAndBold</a>() {
<a name="l1161"><span class="linenum">1161</span></a>  <span class="comment">    #</span>
<a name="l1162"><span class="linenum">1162</span></a>  <span class="comment">    # Prepare regular expressions for searching emphasis tokens in any</span>
<a name="l1163"><span class="linenum">1163</span></a>  <span class="comment">    # context.</span>
<a name="l1164"><span class="linenum">1164</span></a>  <span class="comment">    #</span>
<a name="l1165"><span class="linenum">1165</span></a>          foreach (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('em_relist')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/em_relist.html">em_relist</a> as <a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a> =&gt; <a class="var it1137" onMouseOver="hilite(1137)" onMouseOut="lolite()" onClick="logVariable('em_re')" href="../../_variables/em_re.html">$em_re</a>) {
<a name="l1166"><span class="linenum">1166</span></a>              foreach (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('strong_relist')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/strong_relist.html">strong_relist</a> as <a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a> =&gt; <a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('strong_re')" href="../../_variables/strong_re.html">$strong_re</a>) {
<a name="l1167"><span class="linenum">1167</span></a>  <span class="comment">                # Construct list of allowed token expressions.</span>
<a name="l1168"><span class="linenum">1168</span></a>                  <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('token_relist')" href="../../_variables/token_relist.html">$token_relist</a> = array();
<a name="l1169"><span class="linenum">1169</span></a>                  if (isset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('em_strong_relist')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/em_strong_relist.html">em_strong_relist</a>[&quot;<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a><a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a>&quot;])) {
<a name="l1170"><span class="linenum">1170</span></a>                      <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('token_relist')" href="../../_variables/token_relist.html">$token_relist</a>[] = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('em_strong_relist')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/em_strong_relist.html">em_strong_relist</a>[&quot;<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a><a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a>&quot;];
<a name="l1171"><span class="linenum">1171</span></a>                  }
<a name="l1172"><span class="linenum">1172</span></a>                  <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('token_relist')" href="../../_variables/token_relist.html">$token_relist</a>[] = <a class="var it1137" onMouseOver="hilite(1137)" onMouseOut="lolite()" onClick="logVariable('em_re')" href="../../_variables/em_re.html">$em_re</a>;
<a name="l1173"><span class="linenum">1173</span></a>                  <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('token_relist')" href="../../_variables/token_relist.html">$token_relist</a>[] = <a class="var it1139" onMouseOver="hilite(1139)" onMouseOut="lolite()" onClick="logVariable('strong_re')" href="../../_variables/strong_re.html">$strong_re</a>;
<a name="l1174"><span class="linenum">1174</span></a>                  
<a name="l1175"><span class="linenum">1175</span></a>  <span class="comment">                # Construct master expression from list.</span>
<a name="l1176"><span class="linenum">1176</span></a>                  <a class="var it1141" onMouseOver="hilite(1141)" onMouseOut="lolite()" onClick="logVariable('token_re')" href="../../_variables/token_re.html">$token_re</a> = '{('. <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('|', <a class="var it1140" onMouseOver="hilite(1140)" onMouseOut="lolite()" onClick="logVariable('token_relist')" href="../../_variables/token_relist.html">$token_relist</a>) .')}';
<a name="l1177"><span class="linenum">1177</span></a>                  <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('em_strong_prepared_relist')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/em_strong_prepared_relist.html">em_strong_prepared_relist</a>[&quot;<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a><a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a>&quot;] = <a class="var it1141" onMouseOver="hilite(1141)" onMouseOut="lolite()" onClick="logVariable('token_re')" href="../../_variables/token_re.html">$token_re</a>;
<a name="l1178"><span class="linenum">1178</span></a>              }
<a name="l1179"><span class="linenum">1179</span></a>          }
<a name="l1180"><span class="linenum">1180</span></a>      }
<a name="l1181"><span class="linenum">1181</span></a>      
<a name="l1182"><span class="linenum">1182</span></a>  	function <a class="function" onClick="logFunction('doItalicsAndBold')" href="../../_functions/doitalicsandbold.html" onMouseOver="funcPopup(event,'doitalicsandbold')">doItalicsAndBold</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1183"><span class="linenum">1183</span></a>          <a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a> = array('');
<a name="l1184"><span class="linenum">1184</span></a>          <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a> = array('');
<a name="l1185"><span class="linenum">1185</span></a>          <a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a> = '';
<a name="l1186"><span class="linenum">1186</span></a>          <a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a> = '';
<a name="l1187"><span class="linenum">1187</span></a>          <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('tree_char_em')" href="../../_variables/tree_char_em.html">$tree_char_em</a> = false;
<a name="l1188"><span class="linenum">1188</span></a>          
<a name="l1189"><span class="linenum">1189</span></a>          while (1) {
<a name="l1190"><span class="linenum">1190</span></a>  <span class="comment">            #</span>
<a name="l1191"><span class="linenum">1191</span></a>  <span class="comment">            # Get prepared regular expression for seraching emphasis tokens</span>
<a name="l1192"><span class="linenum">1192</span></a>  <span class="comment">            # in current context.</span>
<a name="l1193"><span class="linenum">1193</span></a>  <span class="comment">            #</span>
<a name="l1194"><span class="linenum">1194</span></a>              <a class="var it1141" onMouseOver="hilite(1141)" onMouseOut="lolite()" onClick="logVariable('token_re')" href="../../_variables/token_re.html">$token_re</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('em_strong_prepared_relist')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/em_strong_prepared_relist.html">em_strong_prepared_relist</a>[&quot;<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a><a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a>&quot;];
<a name="l1195"><span class="linenum">1195</span></a>              
<a name="l1196"><span class="linenum">1196</span></a>  <span class="comment">            #</span>
<a name="l1197"><span class="linenum">1197</span></a>  <span class="comment">            # Each loop iteration search for the next emphasis token. </span>
<a name="l1198"><span class="linenum">1198</span></a>  <span class="comment">            # Each token is then passed to handleSpanToken.</span>
<a name="l1199"><span class="linenum">1199</span></a>  <span class="comment">            #</span>
<a name="l1200"><span class="linenum">1200</span></a>              <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>(<a class="var it1141" onMouseOver="hilite(1141)" onMouseOut="lolite()" onClick="logVariable('token_re')" href="../../_variables/token_re.html">$token_re</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, 2, PREG_SPLIT_DELIM_CAPTURE);
<a name="l1201"><span class="linenum">1201</span></a>              <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0];
<a name="l1202"><span class="linenum">1202</span></a>              <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a> =&amp; <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[1];
<a name="l1203"><span class="linenum">1203</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> =&amp; <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[2];
<a name="l1204"><span class="linenum">1204</span></a>              
<a name="l1205"><span class="linenum">1205</span></a>              if (empty(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>)) {
<a name="l1206"><span class="linenum">1206</span></a>  <span class="comment">                # Reached end of text span: empty stack without emitting.</span>
<a name="l1207"><span class="linenum">1207</span></a>  <span class="comment">                # any more emphasis.</span>
<a name="l1208"><span class="linenum">1208</span></a>                  while (<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>[0]) {
<a name="l1209"><span class="linenum">1209</span></a>                      <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[1] .= <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>);
<a name="l1210"><span class="linenum">1210</span></a>                      <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>);
<a name="l1211"><span class="linenum">1211</span></a>                  }
<a name="l1212"><span class="linenum">1212</span></a>                  break;
<a name="l1213"><span class="linenum">1213</span></a>              }
<a name="l1214"><span class="linenum">1214</span></a>              
<a name="l1215"><span class="linenum">1215</span></a>              <a class="var it1146" onMouseOver="hilite(1146)" onMouseOut="lolite()" onClick="logVariable('token_len')" href="../../_variables/token_len.html">$token_len</a> = strlen(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>);
<a name="l1216"><span class="linenum">1216</span></a>              if (<a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('tree_char_em')" href="../../_variables/tree_char_em.html">$tree_char_em</a>) {
<a name="l1217"><span class="linenum">1217</span></a>  <span class="comment">                # Reached closing marker while inside a three-char emphasis.</span>
<a name="l1218"><span class="linenum">1218</span></a>                  if (<a class="var it1146" onMouseOver="hilite(1146)" onMouseOut="lolite()" onClick="logVariable('token_len')" href="../../_variables/token_len.html">$token_len</a> == 3) {
<a name="l1219"><span class="linenum">1219</span></a>  <span class="comment">                    # Three-char closing marker, close em and strong.</span>
<a name="l1220"><span class="linenum">1220</span></a>                      <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>);
<a name="l1221"><span class="linenum">1221</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>);
<a name="l1222"><span class="linenum">1222</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1223"><span class="linenum">1223</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = &quot;&lt;strong&gt;&lt;em&gt;<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>&lt;/em&gt;&lt;/strong&gt;&quot;;
<a name="l1224"><span class="linenum">1224</span></a>                      <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1225"><span class="linenum">1225</span></a>                      <a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a> = '';
<a name="l1226"><span class="linenum">1226</span></a>                      <a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a> = '';
<a name="l1227"><span class="linenum">1227</span></a>                  } else {
<a name="l1228"><span class="linenum">1228</span></a>  <span class="comment">                    # Other closing marker: close one em or strong and</span>
<a name="l1229"><span class="linenum">1229</span></a>  <span class="comment">                    # change current token state to match the other</span>
<a name="l1230"><span class="linenum">1230</span></a>                      <a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>[0] = <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>{0}, 3-<a class="var it1146" onMouseOver="hilite(1146)" onMouseOut="lolite()" onClick="logVariable('token_len')" href="../../_variables/token_len.html">$token_len</a>);
<a name="l1231"><span class="linenum">1231</span></a>                      <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> = <a class="var it1146" onMouseOver="hilite(1146)" onMouseOut="lolite()" onClick="logVariable('token_len')" href="../../_variables/token_len.html">$token_len</a> == 2 ? &quot;strong&quot; : &quot;em&quot;;
<a name="l1232"><span class="linenum">1232</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0];
<a name="l1233"><span class="linenum">1233</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1234"><span class="linenum">1234</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = &quot;&lt;<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>&gt;<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>&lt;/<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>&gt;&quot;;
<a name="l1235"><span class="linenum">1235</span></a>                      <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1236"><span class="linenum">1236</span></a>                      $<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> = ''; <span class="comment"># $$tag stands for $em or $strong</span>
<a name="l1237"><span class="linenum">1237</span></a>                  }
<a name="l1238"><span class="linenum">1238</span></a>                  <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('tree_char_em')" href="../../_variables/tree_char_em.html">$tree_char_em</a> = false;
<a name="l1239"><span class="linenum">1239</span></a>              } else if (<a class="var it1146" onMouseOver="hilite(1146)" onMouseOut="lolite()" onClick="logVariable('token_len')" href="../../_variables/token_len.html">$token_len</a> == 3) {
<a name="l1240"><span class="linenum">1240</span></a>                  if (<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a>) {
<a name="l1241"><span class="linenum">1241</span></a>  <span class="comment">                    # Reached closing marker for both em and strong.</span>
<a name="l1242"><span class="linenum">1242</span></a>  <span class="comment">                    # Closing strong marker:</span>
<a name="l1243"><span class="linenum">1243</span></a>                      for (<a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> = 0; <a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a> &lt; 2; ++<a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../_variables/i.html">$i</a>) {
<a name="l1244"><span class="linenum">1244</span></a>                          <a class="var it1148" onMouseOver="hilite(1148)" onMouseOut="lolite()" onClick="logVariable('shifted_token')" href="../../_variables/shifted_token.html">$shifted_token</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>);
<a name="l1245"><span class="linenum">1245</span></a>                          <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> = strlen(<a class="var it1148" onMouseOver="hilite(1148)" onMouseOut="lolite()" onClick="logVariable('shifted_token')" href="../../_variables/shifted_token.html">$shifted_token</a>) == 2 ? &quot;strong&quot; : &quot;em&quot;;
<a name="l1246"><span class="linenum">1246</span></a>                          <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>);
<a name="l1247"><span class="linenum">1247</span></a>                          <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1248"><span class="linenum">1248</span></a>                          <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = &quot;&lt;<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>&gt;<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>&lt;/<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>&gt;&quot;;
<a name="l1249"><span class="linenum">1249</span></a>                          <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1250"><span class="linenum">1250</span></a>                          $<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> = ''; <span class="comment"># $$tag stands for $em or $strong</span>
<a name="l1251"><span class="linenum">1251</span></a>                      }
<a name="l1252"><span class="linenum">1252</span></a>                  } else {
<a name="l1253"><span class="linenum">1253</span></a>  <span class="comment">                    # Reached opening three-char emphasis marker. Push on token </span>
<a name="l1254"><span class="linenum">1254</span></a>  <span class="comment">                    # stack; will be handled by the special condition above.</span>
<a name="l1255"><span class="linenum">1255</span></a>                      <a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a> = <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>{0};
<a name="l1256"><span class="linenum">1256</span></a>                      <a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a> = &quot;<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a><a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a>&quot;;
<a name="l1257"><span class="linenum">1257</span></a>                      <a class="phpfunction" onClick="logFunction('array_unshift')" href="../../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>, <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>);
<a name="l1258"><span class="linenum">1258</span></a>                      <a class="phpfunction" onClick="logFunction('array_unshift')" href="../../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>, '');
<a name="l1259"><span class="linenum">1259</span></a>                      <a class="var it1144" onMouseOver="hilite(1144)" onMouseOut="lolite()" onClick="logVariable('tree_char_em')" href="../../_variables/tree_char_em.html">$tree_char_em</a> = true;
<a name="l1260"><span class="linenum">1260</span></a>                  }
<a name="l1261"><span class="linenum">1261</span></a>              } else if (<a class="var it1146" onMouseOver="hilite(1146)" onMouseOut="lolite()" onClick="logVariable('token_len')" href="../../_variables/token_len.html">$token_len</a> == 2) {
<a name="l1262"><span class="linenum">1262</span></a>                  if (<a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a>) {
<a name="l1263"><span class="linenum">1263</span></a>  <span class="comment">                    # Unwind any dangling emphasis marker:</span>
<a name="l1264"><span class="linenum">1264</span></a>                      if (strlen(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>[0]) == 1) {
<a name="l1265"><span class="linenum">1265</span></a>                          <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[1] .= <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>);
<a name="l1266"><span class="linenum">1266</span></a>                          <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>);
<a name="l1267"><span class="linenum">1267</span></a>                      }
<a name="l1268"><span class="linenum">1268</span></a>  <span class="comment">                    # Closing strong marker:</span>
<a name="l1269"><span class="linenum">1269</span></a>                      <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>);
<a name="l1270"><span class="linenum">1270</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>);
<a name="l1271"><span class="linenum">1271</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1272"><span class="linenum">1272</span></a>                      <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = &quot;&lt;strong&gt;<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>&lt;/strong&gt;&quot;;
<a name="l1273"><span class="linenum">1273</span></a>                      <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1274"><span class="linenum">1274</span></a>                      <a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a> = '';
<a name="l1275"><span class="linenum">1275</span></a>                  } else {
<a name="l1276"><span class="linenum">1276</span></a>                      <a class="phpfunction" onClick="logFunction('array_unshift')" href="../../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>, <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>);
<a name="l1277"><span class="linenum">1277</span></a>                      <a class="phpfunction" onClick="logFunction('array_unshift')" href="../../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>, '');
<a name="l1278"><span class="linenum">1278</span></a>                      <a class="var it1138" onMouseOver="hilite(1138)" onMouseOut="lolite()" onClick="logVariable('strong')" href="../../_variables/strong.html">$strong</a> = <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>;
<a name="l1279"><span class="linenum">1279</span></a>                  }
<a name="l1280"><span class="linenum">1280</span></a>              } else {
<a name="l1281"><span class="linenum">1281</span></a>  <span class="comment">                # Here $token_len == 1</span>
<a name="l1282"><span class="linenum">1282</span></a>                  if (<a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a>) {
<a name="l1283"><span class="linenum">1283</span></a>                      if (strlen(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>[0]) == 1) {
<a name="l1284"><span class="linenum">1284</span></a>  <span class="comment">                        # Closing emphasis marker:</span>
<a name="l1285"><span class="linenum">1285</span></a>                          <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>);
<a name="l1286"><span class="linenum">1286</span></a>                          <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>);
<a name="l1287"><span class="linenum">1287</span></a>                          <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1288"><span class="linenum">1288</span></a>                          <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = &quot;&lt;em&gt;<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>&lt;/em&gt;&quot;;
<a name="l1289"><span class="linenum">1289</span></a>                          <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>);
<a name="l1290"><span class="linenum">1290</span></a>                          <a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a> = '';
<a name="l1291"><span class="linenum">1291</span></a>                      } else {
<a name="l1292"><span class="linenum">1292</span></a>                          <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0] .= <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>;
<a name="l1293"><span class="linenum">1293</span></a>                      }
<a name="l1294"><span class="linenum">1294</span></a>                  } else {
<a name="l1295"><span class="linenum">1295</span></a>                      <a class="phpfunction" onClick="logFunction('array_unshift')" href="../../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it1142" onMouseOver="hilite(1142)" onMouseOut="lolite()" onClick="logVariable('token_stack')" href="../../_variables/token_stack.html">$token_stack</a>, <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>);
<a name="l1296"><span class="linenum">1296</span></a>                      <a class="phpfunction" onClick="logFunction('array_unshift')" href="../../_functions/array_unshift.html" onMouseOver="phpfuncPopup(event,'array_unshift')">array_unshift</a>(<a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>, '');
<a name="l1297"><span class="linenum">1297</span></a>                      <a class="var it405" onMouseOver="hilite(405)" onMouseOut="lolite()" onClick="logVariable('em')" href="../../_variables/em.html">$em</a> = <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>;
<a name="l1298"><span class="linenum">1298</span></a>                  }
<a name="l1299"><span class="linenum">1299</span></a>              }
<a name="l1300"><span class="linenum">1300</span></a>          }
<a name="l1301"><span class="linenum">1301</span></a>          return <a class="var it1143" onMouseOver="hilite(1143)" onMouseOut="lolite()" onClick="logVariable('text_stack')" href="../../_variables/text_stack.html">$text_stack</a>[0];
<a name="l1302"><span class="linenum">1302</span></a>      }
<a name="l1303"><span class="linenum">1303</span></a>  
<a name="l1304"><span class="linenum">1304</span></a>  
<a name="l1305"><span class="linenum">1305</span></a>  	function <a class="function" onClick="logFunction('doBlockQuotes')" href="../../_functions/doblockquotes.html" onMouseOver="funcPopup(event,'doblockquotes')">doBlockQuotes</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1306"><span class="linenum">1306</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('/
<a name="l1307"><span class="linenum">1307</span></a>                (                                # Wrap whole match in <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l1308"><span class="linenum">1308</span></a>                  (?&gt;
<a name="l1309"><span class="linenum">1309</span></a>                    ^[ ]*&gt;[ ]?            # &quot;&gt;&quot; at the start of a line
<a name="l1310"><span class="linenum">1310</span></a>                      .+\n                    # rest of the first line
<a name="l1311"><span class="linenum">1311</span></a>                    (.+\n)*                    # subsequent consecutive lines
<a name="l1312"><span class="linenum">1312</span></a>                    \n*                        # blanks
<a name="l1313"><span class="linenum">1313</span></a>                  )+
<a name="l1314"><span class="linenum">1314</span></a>                )
<a name="l1315"><span class="linenum">1315</span></a>              /xm',
<a name="l1316"><span class="linenum">1316</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doBlockQuotes_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1317"><span class="linenum">1317</span></a>  
<a name="l1318"><span class="linenum">1318</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1319"><span class="linenum">1319</span></a>      }
<a name="l1320"><span class="linenum">1320</span></a>  	function <a class="function" onClick="logFunction('_doBlockQuotes_callback')" href="../../_functions/_doblockquotes_callback.html" onMouseOver="funcPopup(event,'_doblockquotes_callback')">_doBlockQuotes_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1321"><span class="linenum">1321</span></a>          <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment">        # trim one level of quoting - trim whitespace-only lines</span>
<a name="l1323"><span class="linenum">1323</span></a>          <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^[ ]*&gt;[ ]?|^[ ]+$/m', '', <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a>);
<a name="l1324"><span class="linenum">1324</span></a>          <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runBlockGamut')" href="../../_functions/runblockgamut.html" onMouseOver="funcPopup(event,'runblockgamut')">runBlockGamut</a>(<a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a>);        <span class="comment"># recurse</span>
<a name="l1325"><span class="linenum">1325</span></a>  
<a name="l1326"><span class="linenum">1326</span></a>          <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^/m', &quot;  &quot;, <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a>);
<a name="l1327"><span class="linenum">1327</span></a>  <span class="comment">        # These leading spaces cause problem with &lt;pre&gt; content, </span>
<a name="l1328"><span class="linenum">1328</span></a>  <span class="comment">        # so we need to fix that:</span>
<a name="l1329"><span class="linenum">1329</span></a>          <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{(\s*&lt;pre&gt;.+?&lt;/pre&gt;)}sx', 
<a name="l1330"><span class="linenum">1330</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doBlockQuotes_callback2'), <a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a>);
<a name="l1331"><span class="linenum">1331</span></a>  
<a name="l1332"><span class="linenum">1332</span></a>          return &quot;\n&quot;. <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(&quot;&lt;blockquote&gt;\n<a class="var it1149" onMouseOver="hilite(1149)" onMouseOut="lolite()" onClick="logVariable('bq')" href="../../_variables/bq.html">$bq</a>\n&lt;/blockquote&gt;&quot;).&quot;\n\n&quot;;
<a name="l1333"><span class="linenum">1333</span></a>      }
<a name="l1334"><span class="linenum">1334</span></a>  	function <a class="function" onClick="logFunction('_doBlockQuotes_callback2')" href="../../_functions/_doblockquotes_callback2.html" onMouseOver="funcPopup(event,'_doblockquotes_callback2')">_doBlockQuotes_callback2</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1335"><span class="linenum">1335</span></a>          <a class="var it1150" onMouseOver="hilite(1150)" onMouseOut="lolite()" onClick="logVariable('pre')" href="../../_variables/pre.html">$pre</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1336"><span class="linenum">1336</span></a>          <a class="var it1150" onMouseOver="hilite(1150)" onMouseOut="lolite()" onClick="logVariable('pre')" href="../../_variables/pre.html">$pre</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^  /m', '', <a class="var it1150" onMouseOver="hilite(1150)" onMouseOut="lolite()" onClick="logVariable('pre')" href="../../_variables/pre.html">$pre</a>);
<a name="l1337"><span class="linenum">1337</span></a>          return <a class="var it1150" onMouseOver="hilite(1150)" onMouseOut="lolite()" onClick="logVariable('pre')" href="../../_variables/pre.html">$pre</a>;
<a name="l1338"><span class="linenum">1338</span></a>      }
<a name="l1339"><span class="linenum">1339</span></a>  
<a name="l1340"><span class="linenum">1340</span></a>  
<a name="l1341"><span class="linenum">1341</span></a>  	function <a class="function" onClick="logFunction('formParagraphs')" href="../../_functions/formparagraphs.html" onMouseOver="funcPopup(event,'formparagraphs')">formParagraphs</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1342"><span class="linenum">1342</span></a>  <span class="comment">    #</span>
<a name="l1343"><span class="linenum">1343</span></a>  <span class="comment">    #    Params:</span>
<a name="l1344"><span class="linenum">1344</span></a>  <span class="comment">    #        $text - string to process with html &lt;p&gt; tags</span>
<a name="l1345"><span class="linenum">1345</span></a>  <span class="comment">    #</span>
<a name="l1346"><span class="linenum">1346</span></a>  <span class="comment">        # Strip leading and trailing lines:</span>
<a name="l1347"><span class="linenum">1347</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\A\n+|\n+\z/', '', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1348"><span class="linenum">1348</span></a>  
<a name="l1349"><span class="linenum">1349</span></a>          <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/\n{2,}/', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, -1, PREG_SPLIT_NO_EMPTY);
<a name="l1350"><span class="linenum">1350</span></a>  
<a name="l1351"><span class="linenum">1351</span></a>  <span class="comment">        #</span>
<a name="l1352"><span class="linenum">1352</span></a>  <span class="comment">        # Wrap &lt;p&gt; tags and unhashify HTML blocks</span>
<a name="l1353"><span class="linenum">1353</span></a>  <span class="comment">        #</span>
<a name="l1354"><span class="linenum">1354</span></a>          foreach (<a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a> as <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l1355"><span class="linenum">1355</span></a>              if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^B\x1A[0-9]+B$/', <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>)) {
<a name="l1356"><span class="linenum">1356</span></a>  <span class="comment">                # Is a paragraph.</span>
<a name="l1357"><span class="linenum">1357</span></a>                  <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1358"><span class="linenum">1358</span></a>                  <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^([ ]*)/', &quot;&lt;p&gt;&quot;, <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1359"><span class="linenum">1359</span></a>                  <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> .= &quot;&lt;/p&gt;&quot;;
<a name="l1360"><span class="linenum">1360</span></a>                  <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a>[<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('unhash')" href="../../_functions/unhash.html" onMouseOver="funcPopup(event,'unhash')">unhash</a>(<a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1361"><span class="linenum">1361</span></a>              }
<a name="l1362"><span class="linenum">1362</span></a>              else {
<a name="l1363"><span class="linenum">1363</span></a>  <span class="comment">                # Is a block.</span>
<a name="l1364"><span class="linenum">1364</span></a>  <span class="comment">                # Modify elements of @grafs in-place...</span>
<a name="l1365"><span class="linenum">1365</span></a>                  <a class="var it1152" onMouseOver="hilite(1152)" onMouseOut="lolite()" onClick="logVariable('graf')" href="../../_variables/graf.html">$graf</a> = <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1366"><span class="linenum">1366</span></a>                  <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('html_hashes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/html_hashes.html">html_hashes</a>[<a class="var it1152" onMouseOver="hilite(1152)" onMouseOut="lolite()" onClick="logVariable('graf')" href="../../_variables/graf.html">$graf</a>];
<a name="l1367"><span class="linenum">1367</span></a>                  <a class="var it1152" onMouseOver="hilite(1152)" onMouseOut="lolite()" onClick="logVariable('graf')" href="../../_variables/graf.html">$graf</a> = <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>;
<a name="l1368"><span class="linenum">1368</span></a>  <span class="comment">//                if (preg_match('{</span>
<a name="l1369"><span class="linenum">1369</span></a>  <span class="comment">//                    \A</span>
<a name="l1370"><span class="linenum">1370</span></a>  <span class="comment">//                    (                            # $1 = &lt;div&gt; tag</span>
<a name="l1371"><span class="linenum">1371</span></a>  <span class="comment">//                      &lt;div  \s+</span>
<a name="l1372"><span class="linenum">1372</span></a>  <span class="comment">//                      [^&gt;]*</span>
<a name="l1373"><span class="linenum">1373</span></a>  <span class="comment">//                      \b</span>
<a name="l1374"><span class="linenum">1374</span></a>  <span class="comment">//                      markdown\s*=\s*  ([\'&quot;])    #    $2 = attr quote char</span>
<a name="l1375"><span class="linenum">1375</span></a>  <span class="comment">//                      1</span>
<a name="l1376"><span class="linenum">1376</span></a>  <span class="comment">//                      \2</span>
<a name="l1377"><span class="linenum">1377</span></a>  <span class="comment">//                      [^&gt;]*</span>
<a name="l1378"><span class="linenum">1378</span></a>  <span class="comment">//                      &gt;</span>
<a name="l1379"><span class="linenum">1379</span></a>  <span class="comment">//                    )</span>
<a name="l1380"><span class="linenum">1380</span></a>  <span class="comment">//                    (                            # $3 = contents</span>
<a name="l1381"><span class="linenum">1381</span></a>  <span class="comment">//                    .*</span>
<a name="l1382"><span class="linenum">1382</span></a>  <span class="comment">//                    )</span>
<a name="l1383"><span class="linenum">1383</span></a>  <span class="comment">//                    (&lt;/div&gt;)                    # $4 = closing tag</span>
<a name="l1384"><span class="linenum">1384</span></a>  <span class="comment">//                    \z</span>
<a name="l1385"><span class="linenum">1385</span></a>  <span class="comment">//                    }xs', $block, $matches))</span>
<a name="l1386"><span class="linenum">1386</span></a>  <span class="comment">//                {</span>
<a name="l1387"><span class="linenum">1387</span></a>  <span class="comment">//                    list(, $div_open, , $div_content, $div_close) = $matches;</span>
<a name="l1388"><span class="linenum">1388</span></a>  <span class="comment">//</span>
<a name="l1389"><span class="linenum">1389</span></a>  <span class="comment">//                    # We can't call Markdown(), because that resets the hash;</span>
<a name="l1390"><span class="linenum">1390</span></a>  <span class="comment">//                    # that initialization code should be pulled into its own sub, though.</span>
<a name="l1391"><span class="linenum">1391</span></a>  <span class="comment">//                    $div_content = $this-&gt;hashHTMLBlocks($div_content);</span>
<a name="l1392"><span class="linenum">1392</span></a>  <span class="comment">//                    </span>
<a name="l1393"><span class="linenum">1393</span></a>  <span class="comment">//                    # Run document gamut methods on the content.</span>
<a name="l1394"><span class="linenum">1394</span></a>  <span class="comment">//                    foreach ($this-&gt;document_gamut as $method =&gt; $priority) {</span>
<a name="l1395"><span class="linenum">1395</span></a>  <span class="comment">//                        $div_content = $this-&gt;$method($div_content);</span>
<a name="l1396"><span class="linenum">1396</span></a>  <span class="comment">//                    }</span>
<a name="l1397"><span class="linenum">1397</span></a>  <span class="comment">//</span>
<a name="l1398"><span class="linenum">1398</span></a>  <span class="comment">//                    $div_open = preg_replace(</span>
<a name="l1399"><span class="linenum">1399</span></a>  <span class="comment">//                        '{\smarkdown\s*=\s*([\'&quot;]).+?\1}', '', $div_open);</span>
<a name="l1400"><span class="linenum">1400</span></a>  <span class="comment">//</span>
<a name="l1401"><span class="linenum">1401</span></a>  <span class="comment">//                    $graf = $div_open . &quot;\n&quot; . $div_content . &quot;\n&quot; . $div_close;</span>
<a name="l1402"><span class="linenum">1402</span></a>  <span class="comment">//                }</span>
<a name="l1403"><span class="linenum">1403</span></a>                  <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a>[<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it1152" onMouseOver="hilite(1152)" onMouseOut="lolite()" onClick="logVariable('graf')" href="../../_variables/graf.html">$graf</a>;
<a name="l1404"><span class="linenum">1404</span></a>              }
<a name="l1405"><span class="linenum">1405</span></a>          }
<a name="l1406"><span class="linenum">1406</span></a>  
<a name="l1407"><span class="linenum">1407</span></a>          return <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n\n&quot;, <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a>);
<a name="l1408"><span class="linenum">1408</span></a>      }
<a name="l1409"><span class="linenum">1409</span></a>  
<a name="l1410"><span class="linenum">1410</span></a>  
<a name="l1411"><span class="linenum">1411</span></a>  	function <a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1412"><span class="linenum">1412</span></a>  <span class="comment">    #</span>
<a name="l1413"><span class="linenum">1413</span></a>  <span class="comment">    # Encode text for a double-quoted HTML attribute. This function</span>
<a name="l1414"><span class="linenum">1414</span></a>  <span class="comment">    # is *not* suitable for attributes enclosed in single quotes.</span>
<a name="l1415"><span class="linenum">1415</span></a>  <span class="comment">    #</span>
<a name="l1416"><span class="linenum">1416</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAmpsAndAngles')" href="../../_functions/encodeampsandangles.html" onMouseOver="funcPopup(event,'encodeampsandangles')">encodeAmpsAndAngles</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1417"><span class="linenum">1417</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('&quot;', '&amp;quot;', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1418"><span class="linenum">1418</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1419"><span class="linenum">1419</span></a>      }
<a name="l1420"><span class="linenum">1420</span></a>      
<a name="l1421"><span class="linenum">1421</span></a>      
<a name="l1422"><span class="linenum">1422</span></a>  	function <a class="function" onClick="logFunction('encodeAmpsAndAngles')" href="../../_functions/encodeampsandangles.html" onMouseOver="funcPopup(event,'encodeampsandangles')">encodeAmpsAndAngles</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1423"><span class="linenum">1423</span></a>  <span class="comment">    #</span>
<a name="l1424"><span class="linenum">1424</span></a>  <span class="comment">    # Smart processing for ampersands and angle brackets that need to </span>
<a name="l1425"><span class="linenum">1425</span></a>  <span class="comment">    # be encoded. Valid character entities are left alone unless the</span>
<a name="l1426"><span class="linenum">1426</span></a>  <span class="comment">    # no-entities mode is set.</span>
<a name="l1427"><span class="linenum">1427</span></a>  <span class="comment">    #</span>
<a name="l1428"><span class="linenum">1428</span></a>          if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('no_entities')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/no_entities.html">no_entities</a>) {
<a name="l1429"><span class="linenum">1429</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('&amp;', '&amp;amp;', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1430"><span class="linenum">1430</span></a>          } else {
<a name="l1431"><span class="linenum">1431</span></a>  <span class="comment">            # Ampersand-encoding based entirely on Nat Irons's Amputator</span>
<a name="l1432"><span class="linenum">1432</span></a>  <span class="comment">            # MT plugin: &lt;http://bumppo.net/projects/amputator/&gt;</span>
<a name="l1433"><span class="linenum">1433</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/&amp;(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/', 
<a name="l1434"><span class="linenum">1434</span></a>                                  '&amp;amp;', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);;
<a name="l1435"><span class="linenum">1435</span></a>          }
<a name="l1436"><span class="linenum">1436</span></a>  <span class="comment">        # Encode remaining &lt;'s</span>
<a name="l1437"><span class="linenum">1437</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('&lt;', '&amp;lt;', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1438"><span class="linenum">1438</span></a>  
<a name="l1439"><span class="linenum">1439</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1440"><span class="linenum">1440</span></a>      }
<a name="l1441"><span class="linenum">1441</span></a>  
<a name="l1442"><span class="linenum">1442</span></a>  
<a name="l1443"><span class="linenum">1443</span></a>  	function <a class="function" onClick="logFunction('doAutoLinks')" href="../../_functions/doautolinks.html" onMouseOver="funcPopup(event,'doautolinks')">doAutoLinks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1444"><span class="linenum">1444</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{&lt;((https?|ftp|dict):[^\'&quot;&gt;\s]+)&gt;}i', 
<a name="l1445"><span class="linenum">1445</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doAutoLinks_url_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1446"><span class="linenum">1446</span></a>  
<a name="l1447"><span class="linenum">1447</span></a>  <span class="comment">        # Email addresses: &lt;address@domain.foo&gt;</span>
<a name="l1448"><span class="linenum">1448</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l1449"><span class="linenum">1449</span></a>              &lt;
<a name="l1450"><span class="linenum">1450</span></a>              (?:mailto:)?
<a name="l1451"><span class="linenum">1451</span></a>              (
<a name="l1452"><span class="linenum">1452</span></a>                  (?:
<a name="l1453"><span class="linenum">1453</span></a>                      [-!#$%&amp;\'*+/=?^_`.{|}~\w\x80-\xFF]+
<a name="l1454"><span class="linenum">1454</span></a>                  |
<a name="l1455"><span class="linenum">1455</span></a>                      &quot;.*?&quot;
<a name="l1456"><span class="linenum">1456</span></a>                  )
<a name="l1457"><span class="linenum">1457</span></a>                  \@
<a name="l1458"><span class="linenum">1458</span></a>                  (?:
<a name="l1459"><span class="linenum">1459</span></a>                      [-a-z0-9\x80-\xFF]+(\.[-a-z0-9\x80-\xFF]+)*\.[a-z]+
<a name="l1460"><span class="linenum">1460</span></a>                  |
<a name="l1461"><span class="linenum">1461</span></a>                      \[[\d.a-fA-F:]+\]    # IPv4 &amp; IPv6
<a name="l1462"><span class="linenum">1462</span></a>                  )
<a name="l1463"><span class="linenum">1463</span></a>              )
<a name="l1464"><span class="linenum">1464</span></a>              &gt;
<a name="l1465"><span class="linenum">1465</span></a>              }xi',
<a name="l1466"><span class="linenum">1466</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doAutoLinks_email_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1467"><span class="linenum">1467</span></a>  
<a name="l1468"><span class="linenum">1468</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1469"><span class="linenum">1469</span></a>      }
<a name="l1470"><span class="linenum">1470</span></a>  	function <a class="function" onClick="logFunction('_doAutoLinks_url_callback')" href="../../_functions/_doautolinks_url_callback.html" onMouseOver="funcPopup(event,'_doautolinks_url_callback')">_doAutoLinks_url_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1471"><span class="linenum">1471</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]);
<a name="l1472"><span class="linenum">1472</span></a>          <a class="var it1153" onMouseOver="hilite(1153)" onMouseOut="lolite()" onClick="logVariable('link')" href="../../_variables/link.html">$link</a> = &quot;&lt;a href=\&quot;<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>\&quot;&gt;<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>&lt;/a&gt;&quot;;
<a name="l1473"><span class="linenum">1473</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1153" onMouseOver="hilite(1153)" onMouseOut="lolite()" onClick="logVariable('link')" href="../../_variables/link.html">$link</a>);
<a name="l1474"><span class="linenum">1474</span></a>      }
<a name="l1475"><span class="linenum">1475</span></a>  	function <a class="function" onClick="logFunction('_doAutoLinks_email_callback')" href="../../_functions/_doautolinks_email_callback.html" onMouseOver="funcPopup(event,'_doautolinks_email_callback')">_doAutoLinks_email_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1476"><span class="linenum">1476</span></a>          <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('address')" href="../../_variables/address.html">$address</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l1477"><span class="linenum">1477</span></a>          <a class="var it1153" onMouseOver="hilite(1153)" onMouseOut="lolite()" onClick="logVariable('link')" href="../../_variables/link.html">$link</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeEmailAddress')" href="../../_functions/encodeemailaddress.html" onMouseOver="funcPopup(event,'encodeemailaddress')">encodeEmailAddress</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('address')" href="../../_variables/address.html">$address</a>);
<a name="l1478"><span class="linenum">1478</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1153" onMouseOver="hilite(1153)" onMouseOut="lolite()" onClick="logVariable('link')" href="../../_variables/link.html">$link</a>);
<a name="l1479"><span class="linenum">1479</span></a>      }
<a name="l1480"><span class="linenum">1480</span></a>  
<a name="l1481"><span class="linenum">1481</span></a>  
<a name="l1482"><span class="linenum">1482</span></a>  	function <a class="function" onClick="logFunction('encodeEmailAddress')" href="../../_functions/encodeemailaddress.html" onMouseOver="funcPopup(event,'encodeemailaddress')">encodeEmailAddress</a>(<a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>) {
<a name="l1483"><span class="linenum">1483</span></a>  <span class="comment">    #</span>
<a name="l1484"><span class="linenum">1484</span></a>  <span class="comment">    #    Input: an email address, e.g. &quot;foo@example.com&quot;</span>
<a name="l1485"><span class="linenum">1485</span></a>  <span class="comment">    #</span>
<a name="l1486"><span class="linenum">1486</span></a>  <span class="comment">    #    Output: the email address as a mailto link, with each character</span>
<a name="l1487"><span class="linenum">1487</span></a>  <span class="comment">    #        of the address encoded as either a decimal or hex entity, in</span>
<a name="l1488"><span class="linenum">1488</span></a>  <span class="comment">    #        the hopes of foiling most address harvesting spam bots. E.g.:</span>
<a name="l1489"><span class="linenum">1489</span></a>  <span class="comment">    #</span>
<a name="l1490"><span class="linenum">1490</span></a>  <span class="comment">    #      &lt;p&gt;&lt;a href=&quot;&amp;#109;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#58;&amp;#x66;o&amp;#111;</span>
<a name="l1491"><span class="linenum">1491</span></a>  <span class="comment">    #        &amp;#x40;&amp;#101;&amp;#x78;&amp;#97;&amp;#x6d;&amp;#112;&amp;#x6c;&amp;#101;&amp;#46;&amp;#x63;&amp;#111;</span>
<a name="l1492"><span class="linenum">1492</span></a>  <span class="comment">    #        &amp;#x6d;&quot;&gt;&amp;#x66;o&amp;#111;&amp;#x40;&amp;#101;&amp;#x78;&amp;#97;&amp;#x6d;&amp;#112;&amp;#x6c;</span>
<a name="l1493"><span class="linenum">1493</span></a>  <span class="comment">    #        &amp;#101;&amp;#46;&amp;#x63;&amp;#111;&amp;#x6d;&lt;/a&gt;&lt;/p&gt;</span>
<a name="l1494"><span class="linenum">1494</span></a>  <span class="comment">    #</span>
<a name="l1495"><span class="linenum">1495</span></a>  <span class="comment">    #    Based by a filter by Matthew Wickline, posted to BBEdit-Talk.</span>
<a name="l1496"><span class="linenum">1496</span></a>  <span class="comment">    #   With some optimizations by Milian Wolff.</span>
<a name="l1497"><span class="linenum">1497</span></a>  <span class="comment">    #</span>
<a name="l1498"><span class="linenum">1498</span></a>          <a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a> = &quot;mailto:&quot; . <a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>;
<a name="l1499"><span class="linenum">1499</span></a>          <a class="var it1155" onMouseOver="hilite(1155)" onMouseOut="lolite()" onClick="logVariable('chars')" href="../../_variables/chars.html">$chars</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/(?&lt;!^)(?!$)/', <a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>);
<a name="l1500"><span class="linenum">1500</span></a>          <a class="var it1156" onMouseOver="hilite(1156)" onMouseOut="lolite()" onClick="logVariable('seed')" href="../../_variables/seed.html">$seed</a> = (int)<a class="phpfunction" onClick="logFunction('abs')" href="../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(crc32(<a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>) / strlen(<a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>)); <span class="comment"># Deterministic seed.</span>
<a name="l1501"><span class="linenum">1501</span></a>          
<a name="l1502"><span class="linenum">1502</span></a>          foreach (<a class="var it1155" onMouseOver="hilite(1155)" onMouseOut="lolite()" onClick="logVariable('chars')" href="../../_variables/chars.html">$chars</a> as <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a>) {
<a name="l1503"><span class="linenum">1503</span></a>              <a class="var it1157" onMouseOver="hilite(1157)" onMouseOut="lolite()" onClick="logVariable('ord')" href="../../_variables/ord.html">$ord</a> = <a class="phpfunction" onClick="logFunction('ord')" href="../../_functions/ord.html" onMouseOver="phpfuncPopup(event,'ord')">ord</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a>);
<a name="l1504"><span class="linenum">1504</span></a>  <span class="comment">            # Ignore non-ascii chars.</span>
<a name="l1505"><span class="linenum">1505</span></a>              if (<a class="var it1157" onMouseOver="hilite(1157)" onMouseOut="lolite()" onClick="logVariable('ord')" href="../../_variables/ord.html">$ord</a> &lt; 128) {
<a name="l1506"><span class="linenum">1506</span></a>                  <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = (<a class="var it1156" onMouseOver="hilite(1156)" onMouseOut="lolite()" onClick="logVariable('seed')" href="../../_variables/seed.html">$seed</a> * (1 + <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>)) % 100; <span class="comment"># Pseudo-random function.</span>
<a name="l1507"><span class="linenum">1507</span></a>  <span class="comment">                # roughly 10% raw, 45% hex, 45% dec</span>
<a name="l1508"><span class="linenum">1508</span></a>  <span class="comment">                # '@' *must* be encoded. I insist.</span>
<a name="l1509"><span class="linenum">1509</span></a>                  if (<a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> &gt; 90 &amp;&amp; <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> != '@') <span class="comment">/* do nothing */</span>;
<a name="l1510"><span class="linenum">1510</span></a>                  else if (<a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> &lt; 45) <a class="var it1155" onMouseOver="hilite(1155)" onMouseOut="lolite()" onClick="logVariable('chars')" href="../../_variables/chars.html">$chars</a>[<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = '&amp;#x'.<a class="phpfunction" onClick="logFunction('dechex')" href="../../_functions/dechex.html" onMouseOver="phpfuncPopup(event,'dechex')">dechex</a>(<a class="var it1157" onMouseOver="hilite(1157)" onMouseOut="lolite()" onClick="logVariable('ord')" href="../../_variables/ord.html">$ord</a>).';';
<a name="l1511"><span class="linenum">1511</span></a>                  else              <a class="var it1155" onMouseOver="hilite(1155)" onMouseOut="lolite()" onClick="logVariable('chars')" href="../../_variables/chars.html">$chars</a>[<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = '&amp;#'.<a class="var it1157" onMouseOver="hilite(1157)" onMouseOut="lolite()" onClick="logVariable('ord')" href="../../_variables/ord.html">$ord</a>.';';
<a name="l1512"><span class="linenum">1512</span></a>              }
<a name="l1513"><span class="linenum">1513</span></a>          }
<a name="l1514"><span class="linenum">1514</span></a>          
<a name="l1515"><span class="linenum">1515</span></a>          <a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('', <a class="var it1155" onMouseOver="hilite(1155)" onMouseOut="lolite()" onClick="logVariable('chars')" href="../../_variables/chars.html">$chars</a>);
<a name="l1516"><span class="linenum">1516</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('', <a class="phpfunction" onClick="logFunction('array_slice')" href="../../_functions/array_slice.html" onMouseOver="phpfuncPopup(event,'array_slice')">array_slice</a>(<a class="var it1155" onMouseOver="hilite(1155)" onMouseOut="lolite()" onClick="logVariable('chars')" href="../../_variables/chars.html">$chars</a>, 7)); <span class="comment"># text without `mailto:`</span>
<a name="l1517"><span class="linenum">1517</span></a>          <a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a> = &quot;&lt;a href=\&quot;<a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>\&quot;&gt;<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>&lt;/a&gt;&quot;;
<a name="l1518"><span class="linenum">1518</span></a>  
<a name="l1519"><span class="linenum">1519</span></a>          return <a class="var it1154" onMouseOver="hilite(1154)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>;
<a name="l1520"><span class="linenum">1520</span></a>      }
<a name="l1521"><span class="linenum">1521</span></a>  
<a name="l1522"><span class="linenum">1522</span></a>  
<a name="l1523"><span class="linenum">1523</span></a>  	function <a class="function" onClick="logFunction('parseSpan')" href="../../_functions/parsespan.html" onMouseOver="funcPopup(event,'parsespan')">parseSpan</a>(<a class="var it21" onMouseOver="hilite(21)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>) {
<a name="l1524"><span class="linenum">1524</span></a>  <span class="comment">    #</span>
<a name="l1525"><span class="linenum">1525</span></a>  <span class="comment">    # Take the string $str and parse it into tokens, hashing embeded HTML,</span>
<a name="l1526"><span class="linenum">1526</span></a>  <span class="comment">    # escaped characters and handling code spans.</span>
<a name="l1527"><span class="linenum">1527</span></a>  <span class="comment">    #</span>
<a name="l1528"><span class="linenum">1528</span></a>          <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../_variables/output.html">$output</a> = '';
<a name="l1529"><span class="linenum">1529</span></a>          
<a name="l1530"><span class="linenum">1530</span></a>          <a class="var it1158" onMouseOver="hilite(1158)" onMouseOut="lolite()" onClick="logVariable('span_re')" href="../../_variables/span_re.html">$span_re</a> = '{
<a name="l1531"><span class="linenum">1531</span></a>                  (
<a name="l1532"><span class="linenum">1532</span></a>                      \\\\'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('escape_chars_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/escape_chars_re.html">escape_chars_re</a>.'
<a name="l1533"><span class="linenum">1533</span></a>                  |
<a name="l1534"><span class="linenum">1534</span></a>                      (?&lt;![`\\\\])
<a name="l1535"><span class="linenum">1535</span></a>                      `+                        # code span marker
<a name="l1536"><span class="linenum">1536</span></a>              '.( <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('no_markup')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/no_markup.html">no_markup</a> ? '' : '
<a name="l1537"><span class="linenum">1537</span></a>                  |
<a name="l1538"><span class="linenum">1538</span></a>                      &lt;!--    .*?     --&gt;        # comment
<a name="l1539"><span class="linenum">1539</span></a>                  |
<a name="l1540"><span class="linenum">1540</span></a>                      &lt;\?.*?\?&gt; | &lt;%.*?%&gt;        # processing instruction
<a name="l1541"><span class="linenum">1541</span></a>                  |
<a name="l1542"><span class="linenum">1542</span></a>                      &lt;[/!$]?[-a-zA-Z0-9:_]+    # regular tags
<a name="l1543"><span class="linenum">1543</span></a>                      (?&gt;
<a name="l1544"><span class="linenum">1544</span></a>                          \s
<a name="l1545"><span class="linenum">1545</span></a>                          (?&gt;[^&quot;\'&gt;]+|&quot;[^&quot;]*&quot;|\'[^\']*\')*
<a name="l1546"><span class="linenum">1546</span></a>                      )?
<a name="l1547"><span class="linenum">1547</span></a>                      &gt;
<a name="l1548"><span class="linenum">1548</span></a>              ').'
<a name="l1549"><span class="linenum">1549</span></a>                  )
<a name="l1550"><span class="linenum">1550</span></a>                  }xs';
<a name="l1551"><span class="linenum">1551</span></a>  
<a name="l1552"><span class="linenum">1552</span></a>          while (1) {
<a name="l1553"><span class="linenum">1553</span></a>  <span class="comment">            #</span>
<a name="l1554"><span class="linenum">1554</span></a>  <span class="comment">            # Each loop iteration seach for either the next tag, the next </span>
<a name="l1555"><span class="linenum">1555</span></a>  <span class="comment">            # openning code span marker, or the next escaped character. </span>
<a name="l1556"><span class="linenum">1556</span></a>  <span class="comment">            # Each token is then passed to handleSpanToken.</span>
<a name="l1557"><span class="linenum">1557</span></a>  <span class="comment">            #</span>
<a name="l1558"><span class="linenum">1558</span></a>              <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>(<a class="var it1158" onMouseOver="hilite(1158)" onMouseOut="lolite()" onClick="logVariable('span_re')" href="../../_variables/span_re.html">$span_re</a>, <a class="var it21" onMouseOver="hilite(21)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>, 2, PREG_SPLIT_DELIM_CAPTURE);
<a name="l1559"><span class="linenum">1559</span></a>              
<a name="l1560"><span class="linenum">1560</span></a>  <span class="comment">            # Create token from text preceding tag.</span>
<a name="l1561"><span class="linenum">1561</span></a>              if (<a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0] != &quot;&quot;) {
<a name="l1562"><span class="linenum">1562</span></a>                  <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../_variables/output.html">$output</a> .= <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0];
<a name="l1563"><span class="linenum">1563</span></a>              }
<a name="l1564"><span class="linenum">1564</span></a>              
<a name="l1565"><span class="linenum">1565</span></a>  <span class="comment">            # Check if we reach the end.</span>
<a name="l1566"><span class="linenum">1566</span></a>              if (isset(<a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[1])) {
<a name="l1567"><span class="linenum">1567</span></a>                  <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../_variables/output.html">$output</a> .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('handleSpanToken')" href="../../_functions/handlespantoken.html" onMouseOver="funcPopup(event,'handlespantoken')">handleSpanToken</a>(<a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[1], <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[2]);
<a name="l1568"><span class="linenum">1568</span></a>                  <a class="var it21" onMouseOver="hilite(21)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[2];
<a name="l1569"><span class="linenum">1569</span></a>              }
<a name="l1570"><span class="linenum">1570</span></a>              else {
<a name="l1571"><span class="linenum">1571</span></a>                  break;
<a name="l1572"><span class="linenum">1572</span></a>              }
<a name="l1573"><span class="linenum">1573</span></a>          }
<a name="l1574"><span class="linenum">1574</span></a>          
<a name="l1575"><span class="linenum">1575</span></a>          return <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../_variables/output.html">$output</a>;
<a name="l1576"><span class="linenum">1576</span></a>      }
<a name="l1577"><span class="linenum">1577</span></a>      
<a name="l1578"><span class="linenum">1578</span></a>      
<a name="l1579"><span class="linenum">1579</span></a>  	function <a class="function" onClick="logFunction('handleSpanToken')" href="../../_functions/handlespantoken.html" onMouseOver="funcPopup(event,'handlespantoken')">handleSpanToken</a>(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>, &amp;<a class="var it21" onMouseOver="hilite(21)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>) {
<a name="l1580"><span class="linenum">1580</span></a>  <span class="comment">    #</span>
<a name="l1581"><span class="linenum">1581</span></a>  <span class="comment">    # Handle $token provided by parseSpan by determining its nature and </span>
<a name="l1582"><span class="linenum">1582</span></a>  <span class="comment">    # returning the corresponding value that should replace it.</span>
<a name="l1583"><span class="linenum">1583</span></a>  <span class="comment">    #</span>
<a name="l1584"><span class="linenum">1584</span></a>          switch (<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>{0}) {
<a name="l1585"><span class="linenum">1585</span></a>              case &quot;\\&quot;:
<a name="l1586"><span class="linenum">1586</span></a>                  return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(&quot;&amp;#&quot;. <a class="phpfunction" onClick="logFunction('ord')" href="../../_functions/ord.html" onMouseOver="phpfuncPopup(event,'ord')">ord</a>(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>{1}). &quot;;&quot;);
<a name="l1587"><span class="linenum">1587</span></a>              case &quot;`&quot;:
<a name="l1588"><span class="linenum">1588</span></a>  <span class="comment">                # Search for end marker in remaining text.</span>
<a name="l1589"><span class="linenum">1589</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^(.*?[^`])'.<a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>).'(?!`)(.*)$/sm', 
<a name="l1590"><span class="linenum">1590</span></a>                      <a class="var it21" onMouseOver="hilite(21)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a>, <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>))
<a name="l1591"><span class="linenum">1591</span></a>                  {
<a name="l1592"><span class="linenum">1592</span></a>                      <a class="var it21" onMouseOver="hilite(21)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../_variables/str.html">$str</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l1593"><span class="linenum">1593</span></a>                      <a class="var it1159" onMouseOver="hilite(1159)" onMouseOut="lolite()" onClick="logVariable('codespan')" href="../../_variables/codespan.html">$codespan</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('makeCodeSpan')" href="../../_functions/makecodespan.html" onMouseOver="funcPopup(event,'makecodespan')">makeCodeSpan</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]);
<a name="l1594"><span class="linenum">1594</span></a>                      return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1159" onMouseOver="hilite(1159)" onMouseOut="lolite()" onClick="logVariable('codespan')" href="../../_variables/codespan.html">$codespan</a>);
<a name="l1595"><span class="linenum">1595</span></a>                  }
<a name="l1596"><span class="linenum">1596</span></a>                  return <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>; <span class="comment">// return as text since no ending marker found.</span>
<a name="l1597"><span class="linenum">1597</span></a>              default:
<a name="l1598"><span class="linenum">1598</span></a>                  return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../_variables/token.html">$token</a>);
<a name="l1599"><span class="linenum">1599</span></a>          }
<a name="l1600"><span class="linenum">1600</span></a>      }
<a name="l1601"><span class="linenum">1601</span></a>  
<a name="l1602"><span class="linenum">1602</span></a>  
<a name="l1603"><span class="linenum">1603</span></a>  	function <a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1604"><span class="linenum">1604</span></a>  <span class="comment">    #</span>
<a name="l1605"><span class="linenum">1605</span></a>  <span class="comment">    # Remove one level of line-leading tabs or spaces</span>
<a name="l1606"><span class="linenum">1606</span></a>  <span class="comment">    #</span>
<a name="l1607"><span class="linenum">1607</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^(\t|[ ]{1,'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a>.'})/m', '', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1608"><span class="linenum">1608</span></a>      }
<a name="l1609"><span class="linenum">1609</span></a>  
<a name="l1610"><span class="linenum">1610</span></a>  
<a name="l1611"><span class="linenum">1611</span></a>  <span class="comment">    # String length function for detab. `_initDetab` will create a function to </span>
<a name="l1612"><span class="linenum">1612</span></a>  <span class="comment">    # hanlde UTF-8 if the default function does not exist.</span>
<a name="l1613"><span class="linenum">1613</span></a>      var <a class="var it1160" onMouseOver="hilite(1160)" onMouseOut="lolite()" onClick="logVariable('utf8_strlen')" href="../../_variables/utf8_strlen.html">$utf8_strlen</a> = 'mb_strlen';
<a name="l1614"><span class="linenum">1614</span></a>      
<a name="l1615"><span class="linenum">1615</span></a>  	function <a class="function" onClick="logFunction('detab')" href="../../_functions/detab.html" onMouseOver="funcPopup(event,'detab')">detab</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1616"><span class="linenum">1616</span></a>  <span class="comment">    #</span>
<a name="l1617"><span class="linenum">1617</span></a>  <span class="comment">    # Replace tabs with the appropriate amount of space.</span>
<a name="l1618"><span class="linenum">1618</span></a>  <span class="comment">    #</span>
<a name="l1619"><span class="linenum">1619</span></a>  <span class="comment">        # For each line we separate the line in blocks delemited by</span>
<a name="l1620"><span class="linenum">1620</span></a>  <span class="comment">        # tab characters. Then we reconstruct every line by adding the </span>
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment">        # appropriate number of space between each blocks.</span>
<a name="l1622"><span class="linenum">1622</span></a>          
<a name="l1623"><span class="linenum">1623</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('/^.*\t.*$/m',
<a name="l1624"><span class="linenum">1624</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_detab_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1625"><span class="linenum">1625</span></a>  
<a name="l1626"><span class="linenum">1626</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1627"><span class="linenum">1627</span></a>      }
<a name="l1628"><span class="linenum">1628</span></a>  	function <a class="function" onClick="logFunction('_detab_callback')" href="../../_functions/_detab_callback.html" onMouseOver="funcPopup(event,'_detab_callback')">_detab_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1629"><span class="linenum">1629</span></a>          <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l1630"><span class="linenum">1630</span></a>          <a class="var it1161" onMouseOver="hilite(1161)" onMouseOut="lolite()" onClick="logVariable('strlen')" href="../../_variables/strlen.html">$strlen</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('utf8_strlen')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/utf8_strlen.html">utf8_strlen</a>; <span class="comment"># strlen function for UTF-8.</span>
<a name="l1631"><span class="linenum">1631</span></a>          
<a name="l1632"><span class="linenum">1632</span></a>  <span class="comment">        # Split in blocks.</span>
<a name="l1633"><span class="linenum">1633</span></a>          <a class="var it949" onMouseOver="hilite(949)" onMouseOut="lolite()" onClick="logVariable('blocks')" href="../../_variables/blocks.html">$blocks</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\t&quot;, <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>);
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">        # Add each blocks to the line.</span>
<a name="l1635"><span class="linenum">1635</span></a>          <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a> = <a class="var it949" onMouseOver="hilite(949)" onMouseOut="lolite()" onClick="logVariable('blocks')" href="../../_variables/blocks.html">$blocks</a>[0];
<a name="l1636"><span class="linenum">1636</span></a>          unset(<a class="var it949" onMouseOver="hilite(949)" onMouseOut="lolite()" onClick="logVariable('blocks')" href="../../_variables/blocks.html">$blocks</a>[0]); <span class="comment"># Do not add first block twice.</span>
<a name="l1637"><span class="linenum">1637</span></a>          foreach (<a class="var it949" onMouseOver="hilite(949)" onMouseOut="lolite()" onClick="logVariable('blocks')" href="../../_variables/blocks.html">$blocks</a> as <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>) {
<a name="l1638"><span class="linenum">1638</span></a>  <span class="comment">            # Calculate amount of space, insert spaces, insert block.</span>
<a name="l1639"><span class="linenum">1639</span></a>              <a class="var it1162" onMouseOver="hilite(1162)" onMouseOut="lolite()" onClick="logVariable('amount')" href="../../_variables/amount.html">$amount</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 
<a name="l1640"><span class="linenum">1640</span></a>                  <a class="var it1161" onMouseOver="hilite(1161)" onMouseOut="lolite()" onClick="logVariable('strlen')" href="../../_variables/strlen.html">$strlen</a>(<a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>, 'UTF-8') % <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a>;
<a name="l1641"><span class="linenum">1641</span></a>              <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a> .= <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>(&quot; &quot;, <a class="var it1162" onMouseOver="hilite(1162)" onMouseOut="lolite()" onClick="logVariable('amount')" href="../../_variables/amount.html">$amount</a>) . <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>;
<a name="l1642"><span class="linenum">1642</span></a>          }
<a name="l1643"><span class="linenum">1643</span></a>          return <a class="var it263" onMouseOver="hilite(263)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../_variables/line.html">$line</a>;
<a name="l1644"><span class="linenum">1644</span></a>      }
<a name="l1645"><span class="linenum">1645</span></a>  	function <a class="function" onClick="logFunction('_initDetab')" href="../../_functions/_initdetab.html" onMouseOver="funcPopup(event,'_initdetab')">_initDetab</a>() {
<a name="l1646"><span class="linenum">1646</span></a>  <span class="comment">    #</span>
<a name="l1647"><span class="linenum">1647</span></a>  <span class="comment">    # Check for the availability of the function in the `utf8_strlen` property</span>
<a name="l1648"><span class="linenum">1648</span></a>  <span class="comment">    # (initially `mb_strlen`). If the function is not available, create a </span>
<a name="l1649"><span class="linenum">1649</span></a>  <span class="comment">    # function that will loosely count the number of UTF-8 characters with a</span>
<a name="l1650"><span class="linenum">1650</span></a>  <span class="comment">    # regular expression.</span>
<a name="l1651"><span class="linenum">1651</span></a>  <span class="comment">    #</span>
<a name="l1652"><span class="linenum">1652</span></a>          if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('utf8_strlen')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/utf8_strlen.html">utf8_strlen</a>)) return;
<a name="l1653"><span class="linenum">1653</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('utf8_strlen')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/utf8_strlen.html">utf8_strlen</a> = <a class="phpfunction" onClick="logFunction('create_function')" href="../../_functions/create_function.html" onMouseOver="phpfuncPopup(event,'create_function')">create_function</a>('<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>', 'return <a class="phpfunction" onClick="logFunction('preg_match_all')" href="../../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>(
<a name="l1654"><span class="linenum">1654</span></a>              &quot;/[\\\\x00-\\\\xBF]|[\\\\xC0-\\\\xFF][\\\\x80-\\\\xBF]*/&quot;, 
<a name="l1655"><span class="linenum">1655</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../_variables/m.html">$m</a>);');
<a name="l1656"><span class="linenum">1656</span></a>      }
<a name="l1657"><span class="linenum">1657</span></a>  
<a name="l1658"><span class="linenum">1658</span></a>  
<a name="l1659"><span class="linenum">1659</span></a>  	function <a class="function" onClick="logFunction('unhash')" href="../../_functions/unhash.html" onMouseOver="funcPopup(event,'unhash')">unhash</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1660"><span class="linenum">1660</span></a>  <span class="comment">    #</span>
<a name="l1661"><span class="linenum">1661</span></a>  <span class="comment">    # Swap back in all the tags hashed by _HashHTMLBlocks.</span>
<a name="l1662"><span class="linenum">1662</span></a>  <span class="comment">    #</span>
<a name="l1663"><span class="linenum">1663</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('/(.)\x1A[0-9]+\1/', 
<a name="l1664"><span class="linenum">1664</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_unhash_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1665"><span class="linenum">1665</span></a>      }
<a name="l1666"><span class="linenum">1666</span></a>  	function <a class="function" onClick="logFunction('_unhash_callback')" href="../../_functions/_unhash_callback.html" onMouseOver="funcPopup(event,'_unhash_callback')">_unhash_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l1667"><span class="linenum">1667</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('html_hashes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/html_hashes.html">html_hashes</a>[<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0]];
<a name="l1668"><span class="linenum">1668</span></a>      }
<a name="l1669"><span class="linenum">1669</span></a>  
<a name="l1670"><span class="linenum">1670</span></a>  }
<a name="l1671"><span class="linenum">1671</span></a>  
<a name="l1672"><span class="linenum">1672</span></a>  
<a name="l1673"><span class="linenum">1673</span></a>  <span class="comment">#</span>
<a name="l1674"><span class="linenum">1674</span></a>  <span class="comment"># Markdown Extra Parser Class</span>
<a name="l1675"><span class="linenum">1675</span></a>  <span class="comment">#</span>
<a name="l1676"><span class="linenum">1676</span></a>  
<a name="l1677"><span class="linenum">1677</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('MarkdownExtra_Parser')" href="../../_classes/markdownextra_parser.html" onMouseOver="classPopup(event,'markdownextra_parser')">MarkdownExtra_Parser</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Markdown_Parser')" href="../../_classes/markdown_parser.html" onMouseOver="classPopup(event,'markdown_parser')">Markdown_Parser</a> {
<a name="l1678"><span class="linenum">1678</span></a>  
<a name="l1679"><span class="linenum">1679</span></a>  <span class="comment">    # Prefix for footnote ids.</span>
<a name="l1680"><span class="linenum">1680</span></a>      var <a class="var it1076" onMouseOver="hilite(1076)" onMouseOut="lolite()" onClick="logVariable('fn_id_prefix')" href="../../_variables/fn_id_prefix.html">$fn_id_prefix</a> = &quot;&quot;;
<a name="l1681"><span class="linenum">1681</span></a>      
<a name="l1682"><span class="linenum">1682</span></a>  <span class="comment">    # Optional title attribute for footnote links and backlinks.</span>
<a name="l1683"><span class="linenum">1683</span></a>      var <a class="var it1163" onMouseOver="hilite(1163)" onMouseOut="lolite()" onClick="logVariable('fn_link_title')" href="../../_variables/fn_link_title.html">$fn_link_title</a> = <a class="constant" onClick="logConstant('MARKDOWN_FN_LINK_TITLE')" href="../../_constants/MARKDOWN_FN_LINK_TITLE.html" onMouseOver="constPopup(event,'MARKDOWN_FN_LINK_TITLE')">MARKDOWN_FN_LINK_TITLE</a>;
<a name="l1684"><span class="linenum">1684</span></a>      var <a class="var it1164" onMouseOver="hilite(1164)" onMouseOut="lolite()" onClick="logVariable('fn_backlink_title')" href="../../_variables/fn_backlink_title.html">$fn_backlink_title</a> = <a class="constant" onClick="logConstant('MARKDOWN_FN_BACKLINK_TITLE')" href="../../_constants/MARKDOWN_FN_BACKLINK_TITLE.html" onMouseOver="constPopup(event,'MARKDOWN_FN_BACKLINK_TITLE')">MARKDOWN_FN_BACKLINK_TITLE</a>;
<a name="l1685"><span class="linenum">1685</span></a>      
<a name="l1686"><span class="linenum">1686</span></a>  <span class="comment">    # Optional class attribute for footnote links and backlinks.</span>
<a name="l1687"><span class="linenum">1687</span></a>      var <a class="var it1165" onMouseOver="hilite(1165)" onMouseOut="lolite()" onClick="logVariable('fn_link_class')" href="../../_variables/fn_link_class.html">$fn_link_class</a> = <a class="constant" onClick="logConstant('MARKDOWN_FN_LINK_CLASS')" href="../../_constants/MARKDOWN_FN_LINK_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_FN_LINK_CLASS')">MARKDOWN_FN_LINK_CLASS</a>;
<a name="l1688"><span class="linenum">1688</span></a>      var <a class="var it1166" onMouseOver="hilite(1166)" onMouseOut="lolite()" onClick="logVariable('fn_backlink_class')" href="../../_variables/fn_backlink_class.html">$fn_backlink_class</a> = <a class="constant" onClick="logConstant('MARKDOWN_FN_BACKLINK_CLASS')" href="../../_constants/MARKDOWN_FN_BACKLINK_CLASS.html" onMouseOver="constPopup(event,'MARKDOWN_FN_BACKLINK_CLASS')">MARKDOWN_FN_BACKLINK_CLASS</a>;
<a name="l1689"><span class="linenum">1689</span></a>      
<a name="l1690"><span class="linenum">1690</span></a>  <span class="comment">    # Predefined abbreviations.</span>
<a name="l1691"><span class="linenum">1691</span></a>      var <a class="var it1167" onMouseOver="hilite(1167)" onMouseOut="lolite()" onClick="logVariable('predef_abbr')" href="../../_variables/predef_abbr.html">$predef_abbr</a> = array();
<a name="l1692"><span class="linenum">1692</span></a>  
<a name="l1693"><span class="linenum">1693</span></a>  
<a name="l1694"><span class="linenum">1694</span></a>  	function <a class="function" onClick="logFunction('MarkdownExtra_Parser')" href="../../_functions/markdownextra_parser.html" onMouseOver="funcPopup(event,'markdownextra_parser')">MarkdownExtra_Parser</a>() {
<a name="l1695"><span class="linenum">1695</span></a>  <span class="comment">    #</span>
<a name="l1696"><span class="linenum">1696</span></a>  <span class="comment">    # Constructor function. Initialize the parser object.</span>
<a name="l1697"><span class="linenum">1697</span></a>  <span class="comment">    #</span>
<a name="l1698"><span class="linenum">1698</span></a>  <span class="comment">        # Add extra escapable characters before parent constructor </span>
<a name="l1699"><span class="linenum">1699</span></a>  <span class="comment">        # initialize the table.</span>
<a name="l1700"><span class="linenum">1700</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('escape_chars')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/escape_chars.html">escape_chars</a> .= ':|';
<a name="l1701"><span class="linenum">1701</span></a>          
<a name="l1702"><span class="linenum">1702</span></a>  <span class="comment">        # Insert extra document, block, and span transformations. </span>
<a name="l1703"><span class="linenum">1703</span></a>  <span class="comment">        # Parent constructor will do the sorting.</span>
<a name="l1704"><span class="linenum">1704</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('document_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/document_gamut.html">document_gamut</a> += array(
<a name="l1705"><span class="linenum">1705</span></a>              &quot;doFencedCodeBlocks&quot; =&gt; 5,
<a name="l1706"><span class="linenum">1706</span></a>              &quot;stripFootnotes&quot;     =&gt; 15,
<a name="l1707"><span class="linenum">1707</span></a>              &quot;stripAbbreviations&quot; =&gt; 25,
<a name="l1708"><span class="linenum">1708</span></a>              &quot;appendFootnotes&quot;    =&gt; 50,
<a name="l1709"><span class="linenum">1709</span></a>              );
<a name="l1710"><span class="linenum">1710</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('block_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/block_gamut.html">block_gamut</a> += array(
<a name="l1711"><span class="linenum">1711</span></a>              &quot;doFencedCodeBlocks&quot; =&gt; 5,
<a name="l1712"><span class="linenum">1712</span></a>              &quot;doTables&quot;           =&gt; 15,
<a name="l1713"><span class="linenum">1713</span></a>              &quot;doDefLists&quot;         =&gt; 45,
<a name="l1714"><span class="linenum">1714</span></a>              );
<a name="l1715"><span class="linenum">1715</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('span_gamut')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/span_gamut.html">span_gamut</a> += array(
<a name="l1716"><span class="linenum">1716</span></a>              &quot;doFootnotes&quot;        =&gt; 5,
<a name="l1717"><span class="linenum">1717</span></a>              &quot;doAbbreviations&quot;    =&gt; 70,
<a name="l1718"><span class="linenum">1718</span></a>              );
<a name="l1719"><span class="linenum">1719</span></a>          
<a name="l1720"><span class="linenum">1720</span></a>          parent::<a class="function" onClick="logFunction('Markdown_Parser')" href="../../_functions/markdown_parser.html" onMouseOver="funcPopup(event,'markdown_parser')">Markdown_Parser</a>();
<a name="l1721"><span class="linenum">1721</span></a>      }
<a name="l1722"><span class="linenum">1722</span></a>      
<a name="l1723"><span class="linenum">1723</span></a>      
<a name="l1724"><span class="linenum">1724</span></a>  <span class="comment">    # Extra variables used during extra transformations.</span>
<a name="l1725"><span class="linenum">1725</span></a>      var <a class="var it1168" onMouseOver="hilite(1168)" onMouseOut="lolite()" onClick="logVariable('footnotes')" href="../../_variables/footnotes.html">$footnotes</a> = array();
<a name="l1726"><span class="linenum">1726</span></a>      var <a class="var it1169" onMouseOver="hilite(1169)" onMouseOut="lolite()" onClick="logVariable('footnotes_ordered')" href="../../_variables/footnotes_ordered.html">$footnotes_ordered</a> = array();
<a name="l1727"><span class="linenum">1727</span></a>      var <a class="var it1170" onMouseOver="hilite(1170)" onMouseOut="lolite()" onClick="logVariable('abbr_desciptions')" href="../../_variables/abbr_desciptions.html">$abbr_desciptions</a> = array();
<a name="l1728"><span class="linenum">1728</span></a>      var <a class="var it1171" onMouseOver="hilite(1171)" onMouseOut="lolite()" onClick="logVariable('abbr_word_re')" href="../../_variables/abbr_word_re.html">$abbr_word_re</a> = '';
<a name="l1729"><span class="linenum">1729</span></a>      
<a name="l1730"><span class="linenum">1730</span></a>  <span class="comment">    # Give the current footnote number.</span>
<a name="l1731"><span class="linenum">1731</span></a>      var <a class="var it1172" onMouseOver="hilite(1172)" onMouseOut="lolite()" onClick="logVariable('footnote_counter')" href="../../_variables/footnote_counter.html">$footnote_counter</a> = 1;
<a name="l1732"><span class="linenum">1732</span></a>      
<a name="l1733"><span class="linenum">1733</span></a>      
<a name="l1734"><span class="linenum">1734</span></a>  	function <a class="function" onClick="logFunction('setup')" href="../../_functions/setup.html" onMouseOver="funcPopup(event,'setup')">setup</a>() {
<a name="l1735"><span class="linenum">1735</span></a>  <span class="comment">    #</span>
<a name="l1736"><span class="linenum">1736</span></a>  <span class="comment">    # Setting up Extra-specific variables.</span>
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">    #</span>
<a name="l1738"><span class="linenum">1738</span></a>          parent::<a class="function" onClick="logFunction('setup')" href="../../_functions/setup.html" onMouseOver="funcPopup(event,'setup')">setup</a>();
<a name="l1739"><span class="linenum">1739</span></a>          
<a name="l1740"><span class="linenum">1740</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes.html">footnotes</a> = array();
<a name="l1741"><span class="linenum">1741</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a> = array();
<a name="l1742"><span class="linenum">1742</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_desciptions')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_desciptions.html">abbr_desciptions</a> = array();
<a name="l1743"><span class="linenum">1743</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a> = '';
<a name="l1744"><span class="linenum">1744</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnote_counter')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnote_counter.html">footnote_counter</a> = 1;
<a name="l1745"><span class="linenum">1745</span></a>          
<a name="l1746"><span class="linenum">1746</span></a>          foreach (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('predef_abbr')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/predef_abbr.html">predef_abbr</a> as <a class="var it1173" onMouseOver="hilite(1173)" onMouseOut="lolite()" onClick="logVariable('abbr_word')" href="../../_variables/abbr_word.html">$abbr_word</a> =&gt; <a class="var it1174" onMouseOver="hilite(1174)" onMouseOut="lolite()" onClick="logVariable('abbr_desc')" href="../../_variables/abbr_desc.html">$abbr_desc</a>) {
<a name="l1747"><span class="linenum">1747</span></a>              if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a>)
<a name="l1748"><span class="linenum">1748</span></a>                  <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a> .= '|';
<a name="l1749"><span class="linenum">1749</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a> .= <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it1173" onMouseOver="hilite(1173)" onMouseOut="lolite()" onClick="logVariable('abbr_word')" href="../../_variables/abbr_word.html">$abbr_word</a>);
<a name="l1750"><span class="linenum">1750</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_desciptions')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_desciptions.html">abbr_desciptions</a>[<a class="var it1173" onMouseOver="hilite(1173)" onMouseOut="lolite()" onClick="logVariable('abbr_word')" href="../../_variables/abbr_word.html">$abbr_word</a>] = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1174" onMouseOver="hilite(1174)" onMouseOut="lolite()" onClick="logVariable('abbr_desc')" href="../../_variables/abbr_desc.html">$abbr_desc</a>);
<a name="l1751"><span class="linenum">1751</span></a>          }
<a name="l1752"><span class="linenum">1752</span></a>      }
<a name="l1753"><span class="linenum">1753</span></a>      
<a name="l1754"><span class="linenum">1754</span></a>  	function <a class="function" onClick="logFunction('teardown')" href="../../_functions/teardown.html" onMouseOver="funcPopup(event,'teardown')">teardown</a>() {
<a name="l1755"><span class="linenum">1755</span></a>  <span class="comment">    #</span>
<a name="l1756"><span class="linenum">1756</span></a>  <span class="comment">    # Clearing Extra-specific variables.</span>
<a name="l1757"><span class="linenum">1757</span></a>  <span class="comment">    #</span>
<a name="l1758"><span class="linenum">1758</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes.html">footnotes</a> = array();
<a name="l1759"><span class="linenum">1759</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a> = array();
<a name="l1760"><span class="linenum">1760</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_desciptions')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_desciptions.html">abbr_desciptions</a> = array();
<a name="l1761"><span class="linenum">1761</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a> = '';
<a name="l1762"><span class="linenum">1762</span></a>          
<a name="l1763"><span class="linenum">1763</span></a>          parent::<a class="function" onClick="logFunction('teardown')" href="../../_functions/teardown.html" onMouseOver="funcPopup(event,'teardown')">teardown</a>();
<a name="l1764"><span class="linenum">1764</span></a>      }
<a name="l1765"><span class="linenum">1765</span></a>      
<a name="l1766"><span class="linenum">1766</span></a>      
<a name="l1767"><span class="linenum">1767</span></a>  <span class="comment">    ### HTML Block Parser ###</span>
<a name="l1768"><span class="linenum">1768</span></a>      
<a name="l1769"><span class="linenum">1769</span></a>  <span class="comment">    # Tags that are always treated as block tags:</span>
<a name="l1770"><span class="linenum">1770</span></a>      var <a class="var it1175" onMouseOver="hilite(1175)" onMouseOut="lolite()" onClick="logVariable('block_tags_re')" href="../../_variables/block_tags_re.html">$block_tags_re</a> = 'p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|address|form|fieldset|iframe|hr|legend';
<a name="l1771"><span class="linenum">1771</span></a>      
<a name="l1772"><span class="linenum">1772</span></a>  <span class="comment">    # Tags treated as block tags only if the opening tag is alone on it's line:</span>
<a name="l1773"><span class="linenum">1773</span></a>      var <a class="var it1176" onMouseOver="hilite(1176)" onMouseOut="lolite()" onClick="logVariable('context_block_tags_re')" href="../../_variables/context_block_tags_re.html">$context_block_tags_re</a> = 'script|noscript|math|ins|del';
<a name="l1774"><span class="linenum">1774</span></a>      
<a name="l1775"><span class="linenum">1775</span></a>  <span class="comment">    # Tags where markdown=&quot;1&quot; default to span mode:</span>
<a name="l1776"><span class="linenum">1776</span></a>      var <a class="var it1177" onMouseOver="hilite(1177)" onMouseOut="lolite()" onClick="logVariable('contain_span_tags_re')" href="../../_variables/contain_span_tags_re.html">$contain_span_tags_re</a> = 'p|h[1-6]|li|dd|dt|td|th|legend|address';
<a name="l1777"><span class="linenum">1777</span></a>      
<a name="l1778"><span class="linenum">1778</span></a>  <span class="comment">    # Tags which must not have their contents modified, no matter where </span>
<a name="l1779"><span class="linenum">1779</span></a>  <span class="comment">    # they appear:</span>
<a name="l1780"><span class="linenum">1780</span></a>      var <a class="var it1178" onMouseOver="hilite(1178)" onMouseOut="lolite()" onClick="logVariable('clean_tags_re')" href="../../_variables/clean_tags_re.html">$clean_tags_re</a> = 'script|math';
<a name="l1781"><span class="linenum">1781</span></a>      
<a name="l1782"><span class="linenum">1782</span></a>  <span class="comment">    # Tags that do not need to be closed.</span>
<a name="l1783"><span class="linenum">1783</span></a>      var <a class="var it1179" onMouseOver="hilite(1179)" onMouseOut="lolite()" onClick="logVariable('auto_close_tags_re')" href="../../_variables/auto_close_tags_re.html">$auto_close_tags_re</a> = 'hr|img';
<a name="l1784"><span class="linenum">1784</span></a>      
<a name="l1785"><span class="linenum">1785</span></a>  
<a name="l1786"><span class="linenum">1786</span></a>  	function <a class="function" onClick="logFunction('hashHTMLBlocks')" href="../../_functions/hashhtmlblocks.html" onMouseOver="funcPopup(event,'hashhtmlblocks')">hashHTMLBlocks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1787"><span class="linenum">1787</span></a>  <span class="comment">    #</span>
<a name="l1788"><span class="linenum">1788</span></a>  <span class="comment">    # Hashify HTML Blocks and &quot;clean tags&quot;.</span>
<a name="l1789"><span class="linenum">1789</span></a>  <span class="comment">    #</span>
<a name="l1790"><span class="linenum">1790</span></a>  <span class="comment">    # We only want to do this for block-level HTML tags, such as headers,</span>
<a name="l1791"><span class="linenum">1791</span></a>  <span class="comment">    # lists, and tables. That's because we still want to wrap &lt;p&gt;s around</span>
<a name="l1792"><span class="linenum">1792</span></a>  <span class="comment">    # &quot;paragraphs&quot; that are wrapped in non-block-level tags, such as anchors,</span>
<a name="l1793"><span class="linenum">1793</span></a>  <span class="comment">    # phrase emphasis, and spans. The list of tags we're looking for is</span>
<a name="l1794"><span class="linenum">1794</span></a>  <span class="comment">    # hard-coded.</span>
<a name="l1795"><span class="linenum">1795</span></a>  <span class="comment">    #</span>
<a name="l1796"><span class="linenum">1796</span></a>  <span class="comment">    # This works by calling _HashHTMLBlocks_InMarkdown, which then calls</span>
<a name="l1797"><span class="linenum">1797</span></a>  <span class="comment">    # _HashHTMLBlocks_InHTML when it encounter block tags. When the markdown=&quot;1&quot; </span>
<a name="l1798"><span class="linenum">1798</span></a>  <span class="comment">    # attribute is found whitin a tag, _HashHTMLBlocks_InHTML calls back</span>
<a name="l1799"><span class="linenum">1799</span></a>  <span class="comment">    #  _HashHTMLBlocks_InMarkdown to handle the Markdown syntax within the tag.</span>
<a name="l1800"><span class="linenum">1800</span></a>  <span class="comment">    # These two functions are calling each other. It's recursive!</span>
<a name="l1801"><span class="linenum">1801</span></a>  <span class="comment">    #</span>
<a name="l1802"><span class="linenum">1802</span></a>  <span class="comment">        #</span>
<a name="l1803"><span class="linenum">1803</span></a>  <span class="comment">        # Call the HTML-in-Markdown hasher.</span>
<a name="l1804"><span class="linenum">1804</span></a>  <span class="comment">        #</span>
<a name="l1805"><span class="linenum">1805</span></a>          list(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, ) = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_hashHTMLBlocks_inMarkdown')" href="../../_functions/_hashhtmlblocks_inmarkdown.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_inmarkdown')">_hashHTMLBlocks_inMarkdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1806"><span class="linenum">1806</span></a>          
<a name="l1807"><span class="linenum">1807</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1808"><span class="linenum">1808</span></a>      }
<a name="l1809"><span class="linenum">1809</span></a>  	function <a class="function" onClick="logFunction('_hashHTMLBlocks_inMarkdown')" href="../../_functions/_hashhtmlblocks_inmarkdown.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_inmarkdown')">_hashHTMLBlocks_inMarkdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a> = 0, 
<a name="l1810"><span class="linenum">1810</span></a>                                          <a class="var it1181" onMouseOver="hilite(1181)" onMouseOut="lolite()" onClick="logVariable('enclosing_tag_re')" href="../../_variables/enclosing_tag_re.html">$enclosing_tag_re</a> = '', <a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> = false)
<a name="l1811"><span class="linenum">1811</span></a>      {
<a name="l1812"><span class="linenum">1812</span></a>  <span class="comment">    #</span>
<a name="l1813"><span class="linenum">1813</span></a>  <span class="comment">    # Parse markdown text, calling _HashHTMLBlocks_InHTML for block tags.</span>
<a name="l1814"><span class="linenum">1814</span></a>  <span class="comment">    #</span>
<a name="l1815"><span class="linenum">1815</span></a>  <span class="comment">    # *   $indent is the number of space to be ignored when checking for code </span>
<a name="l1816"><span class="linenum">1816</span></a>  <span class="comment">    #     blocks. This is important because if we don't take the indent into </span>
<a name="l1817"><span class="linenum">1817</span></a>  <span class="comment">    #     account, something like this (which looks right) won't work as expected:</span>
<a name="l1818"><span class="linenum">1818</span></a>  <span class="comment">    #</span>
<a name="l1819"><span class="linenum">1819</span></a>  <span class="comment">    #     &lt;div&gt;</span>
<a name="l1820"><span class="linenum">1820</span></a>  <span class="comment">    #         &lt;div markdown=&quot;1&quot;&gt;</span>
<a name="l1821"><span class="linenum">1821</span></a>  <span class="comment">    #         Hello World.  &lt;-- Is this a Markdown code block or text?</span>
<a name="l1822"><span class="linenum">1822</span></a>  <span class="comment">    #         &lt;/div&gt;  &lt;-- Is this a Markdown code block or a real tag?</span>
<a name="l1823"><span class="linenum">1823</span></a>  <span class="comment">    #     &lt;div&gt;</span>
<a name="l1824"><span class="linenum">1824</span></a>  <span class="comment">    #</span>
<a name="l1825"><span class="linenum">1825</span></a>  <span class="comment">    #     If you don't like this, just don't indent the tag on which</span>
<a name="l1826"><span class="linenum">1826</span></a>  <span class="comment">    #     you apply the markdown=&quot;1&quot; attribute.</span>
<a name="l1827"><span class="linenum">1827</span></a>  <span class="comment">    #</span>
<a name="l1828"><span class="linenum">1828</span></a>  <span class="comment">    # *   If $enclosing_tag_re is not empty, stops at the first unmatched closing </span>
<a name="l1829"><span class="linenum">1829</span></a>  <span class="comment">    #     tag with that name. Nested tags supported.</span>
<a name="l1830"><span class="linenum">1830</span></a>  <span class="comment">    #</span>
<a name="l1831"><span class="linenum">1831</span></a>  <span class="comment">    # *   If $span is true, text inside must treated as span. So any double </span>
<a name="l1832"><span class="linenum">1832</span></a>  <span class="comment">    #     newline will be replaced by a single newline so that it does not create </span>
<a name="l1833"><span class="linenum">1833</span></a>  <span class="comment">    #     paragraphs.</span>
<a name="l1834"><span class="linenum">1834</span></a>  <span class="comment">    #</span>
<a name="l1835"><span class="linenum">1835</span></a>  <span class="comment">    # Returns an array of that form: ( processed text , remaining text )</span>
<a name="l1836"><span class="linenum">1836</span></a>  <span class="comment">    #</span>
<a name="l1837"><span class="linenum">1837</span></a>          if (<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> === '') return array('', '');
<a name="l1838"><span class="linenum">1838</span></a>  
<a name="l1839"><span class="linenum">1839</span></a>  <span class="comment">        # Regex to check for the presense of newlines around a block tag.</span>
<a name="l1840"><span class="linenum">1840</span></a>          <a class="var it1182" onMouseOver="hilite(1182)" onMouseOut="lolite()" onClick="logVariable('newline_before_re')" href="../../_variables/newline_before_re.html">$newline_before_re</a> = '/(?:^\n?|\n\n)*$/';
<a name="l1841"><span class="linenum">1841</span></a>          <a class="var it1183" onMouseOver="hilite(1183)" onMouseOut="lolite()" onClick="logVariable('newline_after_re')" href="../../_variables/newline_after_re.html">$newline_after_re</a> = 
<a name="l1842"><span class="linenum">1842</span></a>              '{
<a name="l1843"><span class="linenum">1843</span></a>                  ^                        # Start of text following the tag.
<a name="l1844"><span class="linenum">1844</span></a>                  (?&gt;[ ]*&lt;!--.*?--&gt;)?        # Optional comment.
<a name="l1845"><span class="linenum">1845</span></a>                  [ ]*\n                    # Must be followed by newline.
<a name="l1846"><span class="linenum">1846</span></a>              }xs';
<a name="l1847"><span class="linenum">1847</span></a>          
<a name="l1848"><span class="linenum">1848</span></a>  <span class="comment">        # Regex to match any tag.</span>
<a name="l1849"><span class="linenum">1849</span></a>          <a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('block_tag_re')" href="../../_variables/block_tag_re.html">$block_tag_re</a> =
<a name="l1850"><span class="linenum">1850</span></a>              '{
<a name="l1851"><span class="linenum">1851</span></a>                  (                    # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>: Capture hole tag.
<a name="l1852"><span class="linenum">1852</span></a>                      &lt;/?                    # Any opening or closing tag.
<a name="l1853"><span class="linenum">1853</span></a>                          (?&gt;                # Tag name.
<a name="l1854"><span class="linenum">1854</span></a>                              '.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('block_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/block_tags_re.html">block_tags_re</a>.'            |
<a name="l1855"><span class="linenum">1855</span></a>                              '.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('context_block_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/context_block_tags_re.html">context_block_tags_re</a>.'    |
<a name="l1856"><span class="linenum">1856</span></a>                              '.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('clean_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/clean_tags_re.html">clean_tags_re</a>.'            |
<a name="l1857"><span class="linenum">1857</span></a>                              (?!\s)'.<a class="var it1181" onMouseOver="hilite(1181)" onMouseOut="lolite()" onClick="logVariable('enclosing_tag_re')" href="../../_variables/enclosing_tag_re.html">$enclosing_tag_re</a>.'
<a name="l1858"><span class="linenum">1858</span></a>                          )
<a name="l1859"><span class="linenum">1859</span></a>                          (?:
<a name="l1860"><span class="linenum">1860</span></a>                              (?=[\s&quot;\'/a-zA-Z0-9])    # Allowed characters after tag name.
<a name="l1861"><span class="linenum">1861</span></a>                              (?&gt;
<a name="l1862"><span class="linenum">1862</span></a>                                  &quot;.*?&quot;        |    # Double quotes (can contain `&gt;`)
<a name="l1863"><span class="linenum">1863</span></a>                                  \'.*?\'       |    # Single quotes (can contain `&gt;`)
<a name="l1864"><span class="linenum">1864</span></a>                                  .+?                # Anything but quotes and `&gt;`.
<a name="l1865"><span class="linenum">1865</span></a>                              )*?
<a name="l1866"><span class="linenum">1866</span></a>                          )?
<a name="l1867"><span class="linenum">1867</span></a>                      &gt;                    # End of tag.
<a name="l1868"><span class="linenum">1868</span></a>                  |
<a name="l1869"><span class="linenum">1869</span></a>                      &lt;!--    .*?     --&gt;    # HTML Comment
<a name="l1870"><span class="linenum">1870</span></a>                  |
<a name="l1871"><span class="linenum">1871</span></a>                      &lt;\?.*?\?&gt; | &lt;%.*?%&gt;    # Processing instruction
<a name="l1872"><span class="linenum">1872</span></a>                  |
<a name="l1873"><span class="linenum">1873</span></a>                      &lt;!\[CDATA\[.*?\]\]&gt;    # CData Block
<a name="l1874"><span class="linenum">1874</span></a>                  |
<a name="l1875"><span class="linenum">1875</span></a>  <span class="comment">                    # Code span marker</span>
<a name="l1876"><span class="linenum">1876</span></a>                      `+
<a name="l1877"><span class="linenum">1877</span></a>                  '. ( !<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a> ? ' # If not in span.
<a name="l1878"><span class="linenum">1878</span></a>                  |
<a name="l1879"><span class="linenum">1879</span></a>  <span class="comment">                    # Indented code block</span>
<a name="l1880"><span class="linenum">1880</span></a>                      (?: ^[ ]*\n | ^ | \n[ ]*\n )
<a name="l1881"><span class="linenum">1881</span></a>                      [ ]{'.(<a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a>+4).'}[^\n]* \n
<a name="l1882"><span class="linenum">1882</span></a>                      (?&gt;
<a name="l1883"><span class="linenum">1883</span></a>                          (?: [ ]{'.(<a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a>+4).'}[^\n]* | [ ]* ) \n
<a name="l1884"><span class="linenum">1884</span></a>                      )*
<a name="l1885"><span class="linenum">1885</span></a>                  |
<a name="l1886"><span class="linenum">1886</span></a>  <span class="comment">                    # Fenced code block marker</span>
<a name="l1887"><span class="linenum">1887</span></a>                      (?&gt; ^ | \n )
<a name="l1888"><span class="linenum">1888</span></a>                      [ ]{'.(<a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a>).'}~~~+[ ]*\n
<a name="l1889"><span class="linenum">1889</span></a>                  ' : '' ). ' # <a class="phpfunction" onClick="logFunction('End')" href="../../_functions/end.html" onMouseOver="phpfuncPopup(event,'end')">End</a> (if not is span).
<a name="l1890"><span class="linenum">1890</span></a>                  )
<a name="l1891"><span class="linenum">1891</span></a>              }xs';
<a name="l1892"><span class="linenum">1892</span></a>  
<a name="l1893"><span class="linenum">1893</span></a>          
<a name="l1894"><span class="linenum">1894</span></a>          <a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> = 0;        <span class="comment"># Current depth inside the tag tree.</span>
<a name="l1895"><span class="linenum">1895</span></a>          <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> = &quot;&quot;;    <span class="comment"># Parsed text that will be returned.</span>
<a name="l1896"><span class="linenum">1896</span></a>  
<a name="l1897"><span class="linenum">1897</span></a>  <span class="comment">        #</span>
<a name="l1898"><span class="linenum">1898</span></a>  <span class="comment">        # Loop through every tag until we find the closing tag of the parent</span>
<a name="l1899"><span class="linenum">1899</span></a>  <span class="comment">        # or loop until reaching the end of text if no parent tag specified.</span>
<a name="l1900"><span class="linenum">1900</span></a>  <span class="comment">        #</span>
<a name="l1901"><span class="linenum">1901</span></a>          do {
<a name="l1902"><span class="linenum">1902</span></a>  <span class="comment">            #</span>
<a name="l1903"><span class="linenum">1903</span></a>  <span class="comment">            # Split the text using the first $tag_match pattern found.</span>
<a name="l1904"><span class="linenum">1904</span></a>  <span class="comment">            # Text before  pattern will be first in the array, text after</span>
<a name="l1905"><span class="linenum">1905</span></a>  <span class="comment">            # pattern will be at the end, and between will be any catches made </span>
<a name="l1906"><span class="linenum">1906</span></a>  <span class="comment">            # by the pattern.</span>
<a name="l1907"><span class="linenum">1907</span></a>  <span class="comment">            #</span>
<a name="l1908"><span class="linenum">1908</span></a>              <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>(<a class="var it1184" onMouseOver="hilite(1184)" onMouseOut="lolite()" onClick="logVariable('block_tag_re')" href="../../_variables/block_tag_re.html">$block_tag_re</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, 2, 
<a name="l1909"><span class="linenum">1909</span></a>                                  PREG_SPLIT_DELIM_CAPTURE);
<a name="l1910"><span class="linenum">1910</span></a>              
<a name="l1911"><span class="linenum">1911</span></a>  <span class="comment">            # If in Markdown span mode, add a empty-string span-level hash </span>
<a name="l1912"><span class="linenum">1912</span></a>  <span class="comment">            # after each newline to prevent triggering any block element.</span>
<a name="l1913"><span class="linenum">1913</span></a>              if (<a class="var it1147" onMouseOver="hilite(1147)" onMouseOut="lolite()" onClick="logVariable('span')" href="../../_variables/span.html">$span</a>) {
<a name="l1914"><span class="linenum">1914</span></a>                  <a class="var it1188" onMouseOver="hilite(1188)" onMouseOut="lolite()" onClick="logVariable('void')" href="../../_variables/void.html">$void</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(&quot;&quot;, ':');
<a name="l1915"><span class="linenum">1915</span></a>                  <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('newline')" href="../../_variables/newline.html">$newline</a> = &quot;<a class="var it1188" onMouseOver="hilite(1188)" onMouseOut="lolite()" onClick="logVariable('void')" href="../../_variables/void.html">$void</a>\n&quot;;
<a name="l1916"><span class="linenum">1916</span></a>                  <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0] = <a class="var it1188" onMouseOver="hilite(1188)" onMouseOut="lolite()" onClick="logVariable('void')" href="../../_variables/void.html">$void</a> . <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;\n&quot;, <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('newline')" href="../../_variables/newline.html">$newline</a>, <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0]) . <a class="var it1188" onMouseOver="hilite(1188)" onMouseOut="lolite()" onClick="logVariable('void')" href="../../_variables/void.html">$void</a>;
<a name="l1917"><span class="linenum">1917</span></a>              }
<a name="l1918"><span class="linenum">1918</span></a>              
<a name="l1919"><span class="linenum">1919</span></a>              <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0]; <span class="comment"># Text before current tag.</span>
<a name="l1920"><span class="linenum">1920</span></a>              
<a name="l1921"><span class="linenum">1921</span></a>  <span class="comment">            # If end of $text has been reached. Stop loop.</span>
<a name="l1922"><span class="linenum">1922</span></a>              if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>) &lt; 3) {
<a name="l1923"><span class="linenum">1923</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = &quot;&quot;;
<a name="l1924"><span class="linenum">1924</span></a>                  break;
<a name="l1925"><span class="linenum">1925</span></a>              }
<a name="l1926"><span class="linenum">1926</span></a>              
<a name="l1927"><span class="linenum">1927</span></a>              <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>  = <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[1]; <span class="comment"># Tag to handle.</span>
<a name="l1928"><span class="linenum">1928</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[2]; <span class="comment"># Remaining text after current tag.</span>
<a name="l1929"><span class="linenum">1929</span></a>              <a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a> = <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>); <span class="comment"># For use in a regular expression.</span>
<a name="l1930"><span class="linenum">1930</span></a>              
<a name="l1931"><span class="linenum">1931</span></a>  <span class="comment">            #</span>
<a name="l1932"><span class="linenum">1932</span></a>  <span class="comment">            # Check for: Code span marker</span>
<a name="l1933"><span class="linenum">1933</span></a>  <span class="comment">            #</span>
<a name="l1934"><span class="linenum">1934</span></a>              if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{0} == &quot;`&quot;) {
<a name="l1935"><span class="linenum">1935</span></a>  <span class="comment">                # Find corresponding end marker.</span>
<a name="l1936"><span class="linenum">1936</span></a>                  <a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a> = <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>);
<a name="l1937"><span class="linenum">1937</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^(?&gt;.+?|\n(?!\n))*?(?&lt;!`)'.<a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a>.'(?!`)}',
<a name="l1938"><span class="linenum">1938</span></a>                      <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>))
<a name="l1939"><span class="linenum">1939</span></a>                  {
<a name="l1940"><span class="linenum">1940</span></a>  <span class="comment">                    # End marker found: pass text unchanged until marker.</span>
<a name="l1941"><span class="linenum">1941</span></a>                      <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> . <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l1942"><span class="linenum">1942</span></a>                      <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, strlen(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0]));
<a name="l1943"><span class="linenum">1943</span></a>                  }
<a name="l1944"><span class="linenum">1944</span></a>                  else {
<a name="l1945"><span class="linenum">1945</span></a>  <span class="comment">                    # Unmatched marker: just skip it.</span>
<a name="l1946"><span class="linenum">1946</span></a>                      <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l1947"><span class="linenum">1947</span></a>                  }
<a name="l1948"><span class="linenum">1948</span></a>              }
<a name="l1949"><span class="linenum">1949</span></a>  <span class="comment">            #</span>
<a name="l1950"><span class="linenum">1950</span></a>  <span class="comment">            # Check for: Indented code block.</span>
<a name="l1951"><span class="linenum">1951</span></a>  <span class="comment">            #</span>
<a name="l1952"><span class="linenum">1952</span></a>              else if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{0} == &quot;\n&quot; || <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{0} == &quot; &quot;) {
<a name="l1953"><span class="linenum">1953</span></a>  <span class="comment">                # Indented code block: pass it unchanged, will be handled </span>
<a name="l1954"><span class="linenum">1954</span></a>  <span class="comment">                # later.</span>
<a name="l1955"><span class="linenum">1955</span></a>                  <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l1956"><span class="linenum">1956</span></a>              }
<a name="l1957"><span class="linenum">1957</span></a>  <span class="comment">            #</span>
<a name="l1958"><span class="linenum">1958</span></a>  <span class="comment">            # Check for: Fenced code block marker.</span>
<a name="l1959"><span class="linenum">1959</span></a>  <span class="comment">            #</span>
<a name="l1960"><span class="linenum">1960</span></a>              else if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{0} == &quot;~&quot;) {
<a name="l1961"><span class="linenum">1961</span></a>  <span class="comment">                # Fenced code block marker: find matching end marker.</span>
<a name="l1962"><span class="linenum">1962</span></a>                  <a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a> = <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>));
<a name="l1963"><span class="linenum">1963</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^(?&gt;.*\n)+?'.<a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a>.' *\n}', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, 
<a name="l1964"><span class="linenum">1964</span></a>                      <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>)) 
<a name="l1965"><span class="linenum">1965</span></a>                  {
<a name="l1966"><span class="linenum">1966</span></a>  <span class="comment">                    # End marker found: pass text unchanged until marker.</span>
<a name="l1967"><span class="linenum">1967</span></a>                      <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> . <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l1968"><span class="linenum">1968</span></a>                      <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, strlen(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0]));
<a name="l1969"><span class="linenum">1969</span></a>                  }
<a name="l1970"><span class="linenum">1970</span></a>                  else {
<a name="l1971"><span class="linenum">1971</span></a>  <span class="comment">                    # No end marker: just skip it.</span>
<a name="l1972"><span class="linenum">1972</span></a>                      <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l1973"><span class="linenum">1973</span></a>                  }
<a name="l1974"><span class="linenum">1974</span></a>              }
<a name="l1975"><span class="linenum">1975</span></a>  <span class="comment">            #</span>
<a name="l1976"><span class="linenum">1976</span></a>  <span class="comment">            # Check for: Opening Block level tag or</span>
<a name="l1977"><span class="linenum">1977</span></a>  <span class="comment">            #            Opening Context Block tag (like ins and del) </span>
<a name="l1978"><span class="linenum">1978</span></a>  <span class="comment">            #               used as a block tag (tag is alone on it's line).</span>
<a name="l1979"><span class="linenum">1979</span></a>  <span class="comment">            #</span>
<a name="l1980"><span class="linenum">1980</span></a>              else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;(?:'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('block_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/block_tags_re.html">block_tags_re</a>.')\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>) ||
<a name="l1981"><span class="linenum">1981</span></a>                  (    <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;(?:'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('context_block_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/context_block_tags_re.html">context_block_tags_re</a>.')\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>) &amp;&amp;
<a name="l1982"><span class="linenum">1982</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="var it1182" onMouseOver="hilite(1182)" onMouseOut="lolite()" onClick="logVariable('newline_before_re')" href="../../_variables/newline_before_re.html">$newline_before_re</a>, <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a>) &amp;&amp;
<a name="l1983"><span class="linenum">1983</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="var it1183" onMouseOver="hilite(1183)" onMouseOut="lolite()" onClick="logVariable('newline_after_re')" href="../../_variables/newline_after_re.html">$newline_after_re</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>)    )
<a name="l1984"><span class="linenum">1984</span></a>                  )
<a name="l1985"><span class="linenum">1985</span></a>              {
<a name="l1986"><span class="linenum">1986</span></a>  <span class="comment">                # Need to parse tag and following text using the HTML parser.</span>
<a name="l1987"><span class="linenum">1987</span></a>                  list(<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) = 
<a name="l1988"><span class="linenum">1988</span></a>                      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_hashHTMLBlocks_inHTML')" href="../../_functions/_hashhtmlblocks_inhtml.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_inhtml')">_hashHTMLBlocks_inHTML</a>(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> . <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, &quot;hashBlock&quot;, true);
<a name="l1989"><span class="linenum">1989</span></a>                  
<a name="l1990"><span class="linenum">1990</span></a>  <span class="comment">                # Make sure it stays outside of any paragraph by adding newlines.</span>
<a name="l1991"><span class="linenum">1991</span></a>                  <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= &quot;\n\n<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>\n\n&quot;;
<a name="l1992"><span class="linenum">1992</span></a>              }
<a name="l1993"><span class="linenum">1993</span></a>  <span class="comment">            #</span>
<a name="l1994"><span class="linenum">1994</span></a>  <span class="comment">            # Check for: Clean tag (like script, math)</span>
<a name="l1995"><span class="linenum">1995</span></a>  <span class="comment">            #            HTML Comments, processing instructions.</span>
<a name="l1996"><span class="linenum">1996</span></a>  <span class="comment">            #</span>
<a name="l1997"><span class="linenum">1997</span></a>              else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;(?:'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('clean_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/clean_tags_re.html">clean_tags_re</a>.')\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>) ||
<a name="l1998"><span class="linenum">1998</span></a>                  <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{1} == '!' || <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{1} == '?')
<a name="l1999"><span class="linenum">1999</span></a>              {
<a name="l2000"><span class="linenum">2000</span></a>  <span class="comment">                # Need to parse tag and following text using the HTML parser.</span>
<a name="l2001"><span class="linenum">2001</span></a>  <span class="comment">                # (don't check for markdown attribute)</span>
<a name="l2002"><span class="linenum">2002</span></a>                  list(<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) = 
<a name="l2003"><span class="linenum">2003</span></a>                      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_hashHTMLBlocks_inHTML')" href="../../_functions/_hashhtmlblocks_inhtml.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_inhtml')">_hashHTMLBlocks_inHTML</a>(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> . <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, &quot;hashClean&quot;, false);
<a name="l2004"><span class="linenum">2004</span></a>                  
<a name="l2005"><span class="linenum">2005</span></a>                  <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>;
<a name="l2006"><span class="linenum">2006</span></a>              }
<a name="l2007"><span class="linenum">2007</span></a>  <span class="comment">            #</span>
<a name="l2008"><span class="linenum">2008</span></a>  <span class="comment">            # Check for: Tag with same name as enclosing tag.</span>
<a name="l2009"><span class="linenum">2009</span></a>  <span class="comment">            #</span>
<a name="l2010"><span class="linenum">2010</span></a>              else if (<a class="var it1181" onMouseOver="hilite(1181)" onMouseOut="lolite()" onClick="logVariable('enclosing_tag_re')" href="../../_variables/enclosing_tag_re.html">$enclosing_tag_re</a> !== '' &amp;&amp;
<a name="l2011"><span class="linenum">2011</span></a>  <span class="comment">                # Same name as enclosing tag.</span>
<a name="l2012"><span class="linenum">2012</span></a>                  <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;/?(?:'.<a class="var it1181" onMouseOver="hilite(1181)" onMouseOut="lolite()" onClick="logVariable('enclosing_tag_re')" href="../../_variables/enclosing_tag_re.html">$enclosing_tag_re</a>.')\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>))
<a name="l2013"><span class="linenum">2013</span></a>              {
<a name="l2014"><span class="linenum">2014</span></a>  <span class="comment">                #</span>
<a name="l2015"><span class="linenum">2015</span></a>  <span class="comment">                # Increase/decrease nested tag count.</span>
<a name="l2016"><span class="linenum">2016</span></a>  <span class="comment">                #</span>
<a name="l2017"><span class="linenum">2017</span></a>                  if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{1} == '/')                        <a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a>--;
<a name="l2018"><span class="linenum">2018</span></a>                  else if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{strlen(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>)-2} != '/')    <a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a>++;
<a name="l2019"><span class="linenum">2019</span></a>  
<a name="l2020"><span class="linenum">2020</span></a>                  if (<a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> &lt; 0) {
<a name="l2021"><span class="linenum">2021</span></a>  <span class="comment">                    #</span>
<a name="l2022"><span class="linenum">2022</span></a>  <span class="comment">                    # Going out of parent element. Clean up and break so we</span>
<a name="l2023"><span class="linenum">2023</span></a>  <span class="comment">                    # return to the calling function.</span>
<a name="l2024"><span class="linenum">2024</span></a>  <span class="comment">                    #</span>
<a name="l2025"><span class="linenum">2025</span></a>                      <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> . <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2026"><span class="linenum">2026</span></a>                      break;
<a name="l2027"><span class="linenum">2027</span></a>                  }
<a name="l2028"><span class="linenum">2028</span></a>                  
<a name="l2029"><span class="linenum">2029</span></a>                  <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l2030"><span class="linenum">2030</span></a>              }
<a name="l2031"><span class="linenum">2031</span></a>              else {
<a name="l2032"><span class="linenum">2032</span></a>                  <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l2033"><span class="linenum">2033</span></a>              }
<a name="l2034"><span class="linenum">2034</span></a>          } while (<a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> &gt;= 0);
<a name="l2035"><span class="linenum">2035</span></a>          
<a name="l2036"><span class="linenum">2036</span></a>          return array(<a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2037"><span class="linenum">2037</span></a>      }
<a name="l2038"><span class="linenum">2038</span></a>  	function <a class="function" onClick="logFunction('_hashHTMLBlocks_inHTML')" href="../../_functions/_hashhtmlblocks_inhtml.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_inhtml')">_hashHTMLBlocks_inHTML</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('hash_method')" href="../../_variables/hash_method.html">$hash_method</a>, <a class="var it1192" onMouseOver="hilite(1192)" onMouseOut="lolite()" onClick="logVariable('md_attr')" href="../../_variables/md_attr.html">$md_attr</a>) {
<a name="l2039"><span class="linenum">2039</span></a>  <span class="comment">    #</span>
<a name="l2040"><span class="linenum">2040</span></a>  <span class="comment">    # Parse HTML, calling _HashHTMLBlocks_InMarkdown for block tags.</span>
<a name="l2041"><span class="linenum">2041</span></a>  <span class="comment">    #</span>
<a name="l2042"><span class="linenum">2042</span></a>  <span class="comment">    # *   Calls $hash_method to convert any blocks.</span>
<a name="l2043"><span class="linenum">2043</span></a>  <span class="comment">    # *   Stops when the first opening tag closes.</span>
<a name="l2044"><span class="linenum">2044</span></a>  <span class="comment">    # *   $md_attr indicate if the use of the `markdown=&quot;1&quot;` attribute is allowed.</span>
<a name="l2045"><span class="linenum">2045</span></a>  <span class="comment">    #     (it is not inside clean tags)</span>
<a name="l2046"><span class="linenum">2046</span></a>  <span class="comment">    #</span>
<a name="l2047"><span class="linenum">2047</span></a>  <span class="comment">    # Returns an array of that form: ( processed text , remaining text )</span>
<a name="l2048"><span class="linenum">2048</span></a>  <span class="comment">    #</span>
<a name="l2049"><span class="linenum">2049</span></a>          if (<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> === '') return array('', '');
<a name="l2050"><span class="linenum">2050</span></a>          
<a name="l2051"><span class="linenum">2051</span></a>  <span class="comment">        # Regex to match `markdown` attribute inside of a tag.</span>
<a name="l2052"><span class="linenum">2052</span></a>          <a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('markdown_attr_re')" href="../../_variables/markdown_attr_re.html">$markdown_attr_re</a> = '
<a name="l2053"><span class="linenum">2053</span></a>              {
<a name="l2054"><span class="linenum">2054</span></a>                  \s*            # Eat whitespace before the `markdown` attribute
<a name="l2055"><span class="linenum">2055</span></a>                  markdown
<a name="l2056"><span class="linenum">2056</span></a>                  \s*=\s*
<a name="l2057"><span class="linenum">2057</span></a>                  (?&gt;
<a name="l2058"><span class="linenum">2058</span></a>                      ([&quot;\'])        # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>: quote delimiter        
<a name="l2059"><span class="linenum">2059</span></a>                      (.*?)        # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>: attribute value
<a name="l2060"><span class="linenum">2060</span></a>                      \1            # matching delimiter    
<a name="l2061"><span class="linenum">2061</span></a>                  |
<a name="l2062"><span class="linenum">2062</span></a>                      ([^\s&gt;]*)    # <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>: unquoted attribute value
<a name="l2063"><span class="linenum">2063</span></a>                  )
<a name="l2064"><span class="linenum">2064</span></a>                  ()                # <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>: make <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a> always <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a> (avoid warnings)
<a name="l2065"><span class="linenum">2065</span></a>              }xs';
<a name="l2066"><span class="linenum">2066</span></a>          
<a name="l2067"><span class="linenum">2067</span></a>  <span class="comment">        # Regex to match any tag.</span>
<a name="l2068"><span class="linenum">2068</span></a>          <a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a> = '{
<a name="l2069"><span class="linenum">2069</span></a>                  (                    # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>: Capture hole tag.
<a name="l2070"><span class="linenum">2070</span></a>                      &lt;/?                    # Any opening or closing tag.
<a name="l2071"><span class="linenum">2071</span></a>                          [\w:$]+            # Tag name.
<a name="l2072"><span class="linenum">2072</span></a>                          (?:
<a name="l2073"><span class="linenum">2073</span></a>                              (?=[\s&quot;\'/a-zA-Z0-9])    # Allowed characters after tag name.
<a name="l2074"><span class="linenum">2074</span></a>                              (?&gt;
<a name="l2075"><span class="linenum">2075</span></a>                                  &quot;.*?&quot;        |    # Double quotes (can contain `&gt;`)
<a name="l2076"><span class="linenum">2076</span></a>                                  \'.*?\'       |    # Single quotes (can contain `&gt;`)
<a name="l2077"><span class="linenum">2077</span></a>                                  .+?                # Anything but quotes and `&gt;`.
<a name="l2078"><span class="linenum">2078</span></a>                              )*?
<a name="l2079"><span class="linenum">2079</span></a>                          )?
<a name="l2080"><span class="linenum">2080</span></a>                      &gt;                    # End of tag.
<a name="l2081"><span class="linenum">2081</span></a>                  |
<a name="l2082"><span class="linenum">2082</span></a>                      &lt;!--    .*?     --&gt;    # HTML Comment
<a name="l2083"><span class="linenum">2083</span></a>                  |
<a name="l2084"><span class="linenum">2084</span></a>                      &lt;\?.*?\?&gt; | &lt;%.*?%&gt;    # Processing instruction
<a name="l2085"><span class="linenum">2085</span></a>                  |
<a name="l2086"><span class="linenum">2086</span></a>                      &lt;!\[CDATA\[.*?\]\]&gt;    # CData Block
<a name="l2087"><span class="linenum">2087</span></a>                  )
<a name="l2088"><span class="linenum">2088</span></a>              }xs';
<a name="l2089"><span class="linenum">2089</span></a>          
<a name="l2090"><span class="linenum">2090</span></a>          <a class="var it1194" onMouseOver="hilite(1194)" onMouseOut="lolite()" onClick="logVariable('original_text')" href="../../_variables/original_text.html">$original_text</a> = <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;        <span class="comment"># Save original text in case of faliure.</span>
<a name="l2091"><span class="linenum">2091</span></a>          
<a name="l2092"><span class="linenum">2092</span></a>          <a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a>        = 0;    <span class="comment"># Current depth inside the tag tree.</span>
<a name="l2093"><span class="linenum">2093</span></a>          <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>    = &quot;&quot;;    <span class="comment"># Temporary text holder for current text.</span>
<a name="l2094"><span class="linenum">2094</span></a>          <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a>        = &quot;&quot;;    <span class="comment"># Parsed text that will be returned.</span>
<a name="l2095"><span class="linenum">2095</span></a>  
<a name="l2096"><span class="linenum">2096</span></a>  <span class="comment">        #</span>
<a name="l2097"><span class="linenum">2097</span></a>  <span class="comment">        # Get the name of the starting tag.</span>
<a name="l2098"><span class="linenum">2098</span></a>  <span class="comment">        # (This pattern makes $base_tag_name_re safe without quoting.)</span>
<a name="l2099"><span class="linenum">2099</span></a>  <span class="comment">        #</span>
<a name="l2100"><span class="linenum">2100</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;([\w:$]*)\b/', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>))
<a name="l2101"><span class="linenum">2101</span></a>              <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('base_tag_name_re')" href="../../_variables/base_tag_name_re.html">$base_tag_name_re</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2102"><span class="linenum">2102</span></a>  
<a name="l2103"><span class="linenum">2103</span></a>  <span class="comment">        #</span>
<a name="l2104"><span class="linenum">2104</span></a>  <span class="comment">        # Loop through every tag until we find the corresponding closing tag.</span>
<a name="l2105"><span class="linenum">2105</span></a>  <span class="comment">        #</span>
<a name="l2106"><span class="linenum">2106</span></a>          do {
<a name="l2107"><span class="linenum">2107</span></a>  <span class="comment">            #</span>
<a name="l2108"><span class="linenum">2108</span></a>  <span class="comment">            # Split the text using the first $tag_match pattern found.</span>
<a name="l2109"><span class="linenum">2109</span></a>  <span class="comment">            # Text before  pattern will be first in the array, text after</span>
<a name="l2110"><span class="linenum">2110</span></a>  <span class="comment">            # pattern will be at the end, and between will be any catches made </span>
<a name="l2111"><span class="linenum">2111</span></a>  <span class="comment">            # by the pattern.</span>
<a name="l2112"><span class="linenum">2112</span></a>  <span class="comment">            #</span>
<a name="l2113"><span class="linenum">2113</span></a>              <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>(<a class="var it1189" onMouseOver="hilite(1189)" onMouseOut="lolite()" onClick="logVariable('tag_re')" href="../../_variables/tag_re.html">$tag_re</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, 2, PREG_SPLIT_DELIM_CAPTURE);
<a name="l2114"><span class="linenum">2114</span></a>              
<a name="l2115"><span class="linenum">2115</span></a>              if (<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>) &lt; 3) {
<a name="l2116"><span class="linenum">2116</span></a>  <span class="comment">                #</span>
<a name="l2117"><span class="linenum">2117</span></a>  <span class="comment">                # End of $text reached with unbalenced tag(s).</span>
<a name="l2118"><span class="linenum">2118</span></a>  <span class="comment">                # In that case, we return original text unchanged and pass the</span>
<a name="l2119"><span class="linenum">2119</span></a>  <span class="comment">                # first character as filtered to prevent an infinite loop in the </span>
<a name="l2120"><span class="linenum">2120</span></a>  <span class="comment">                # parent function.</span>
<a name="l2121"><span class="linenum">2121</span></a>  <span class="comment">                #</span>
<a name="l2122"><span class="linenum">2122</span></a>                  return array(<a class="var it1194" onMouseOver="hilite(1194)" onMouseOut="lolite()" onClick="logVariable('original_text')" href="../../_variables/original_text.html">$original_text</a>{0}, <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it1194" onMouseOver="hilite(1194)" onMouseOut="lolite()" onClick="logVariable('original_text')" href="../../_variables/original_text.html">$original_text</a>, 1));
<a name="l2123"><span class="linenum">2123</span></a>              }
<a name="l2124"><span class="linenum">2124</span></a>              
<a name="l2125"><span class="linenum">2125</span></a>              <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a> .= <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[0]; <span class="comment"># Text before current tag.</span>
<a name="l2126"><span class="linenum">2126</span></a>              <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>         = <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[1]; <span class="comment"># Tag to handle.</span>
<a name="l2127"><span class="linenum">2127</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>        = <a class="var it103" onMouseOver="hilite(103)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../_variables/parts.html">$parts</a>[2]; <span class="comment"># Remaining text after current tag.</span>
<a name="l2128"><span class="linenum">2128</span></a>              
<a name="l2129"><span class="linenum">2129</span></a>  <span class="comment">            #</span>
<a name="l2130"><span class="linenum">2130</span></a>  <span class="comment">            # Check for: Auto-close tag (like &lt;hr/&gt;)</span>
<a name="l2131"><span class="linenum">2131</span></a>  <span class="comment">            #             Comments and Processing Instructions.</span>
<a name="l2132"><span class="linenum">2132</span></a>  <span class="comment">            #</span>
<a name="l2133"><span class="linenum">2133</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;/?(?:'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('auto_close_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/auto_close_tags_re.html">auto_close_tags_re</a>.')\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>) ||
<a name="l2134"><span class="linenum">2134</span></a>                  <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{1} == '!' || <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{1} == '?')
<a name="l2135"><span class="linenum">2135</span></a>              {
<a name="l2136"><span class="linenum">2136</span></a>  <span class="comment">                # Just add the tag to the block as if it was text.</span>
<a name="l2137"><span class="linenum">2137</span></a>                  <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l2138"><span class="linenum">2138</span></a>              }
<a name="l2139"><span class="linenum">2139</span></a>              else {
<a name="l2140"><span class="linenum">2140</span></a>  <span class="comment">                #</span>
<a name="l2141"><span class="linenum">2141</span></a>  <span class="comment">                # Increase/decrease nested tag count. Only do so if</span>
<a name="l2142"><span class="linenum">2142</span></a>  <span class="comment">                # the tag's name match base tag's.</span>
<a name="l2143"><span class="linenum">2143</span></a>  <span class="comment">                #</span>
<a name="l2144"><span class="linenum">2144</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;/?'.<a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('base_tag_name_re')" href="../../_variables/base_tag_name_re.html">$base_tag_name_re</a>.'\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>)) {
<a name="l2145"><span class="linenum">2145</span></a>                      if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{1} == '/')                        <a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a>--;
<a name="l2146"><span class="linenum">2146</span></a>                      else if (<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>{strlen(<a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>)-2} != '/')    <a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a>++;
<a name="l2147"><span class="linenum">2147</span></a>                  }
<a name="l2148"><span class="linenum">2148</span></a>                  
<a name="l2149"><span class="linenum">2149</span></a>  <span class="comment">                #</span>
<a name="l2150"><span class="linenum">2150</span></a>  <span class="comment">                # Check for `markdown=&quot;1&quot;` attribute and handle it.</span>
<a name="l2151"><span class="linenum">2151</span></a>  <span class="comment">                #</span>
<a name="l2152"><span class="linenum">2152</span></a>                  if (<a class="var it1192" onMouseOver="hilite(1192)" onMouseOut="lolite()" onClick="logVariable('md_attr')" href="../../_variables/md_attr.html">$md_attr</a> &amp;&amp; 
<a name="l2153"><span class="linenum">2153</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('markdown_attr_re')" href="../../_variables/markdown_attr_re.html">$markdown_attr_re</a>, <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>, <a class="var it1196" onMouseOver="hilite(1196)" onMouseOut="lolite()" onClick="logVariable('attr_m')" href="../../_variables/attr_m.html">$attr_m</a>) &amp;&amp;
<a name="l2154"><span class="linenum">2154</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^1|block|span$/', <a class="var it1196" onMouseOver="hilite(1196)" onMouseOut="lolite()" onClick="logVariable('attr_m')" href="../../_variables/attr_m.html">$attr_m</a>[2] . <a class="var it1196" onMouseOver="hilite(1196)" onMouseOut="lolite()" onClick="logVariable('attr_m')" href="../../_variables/attr_m.html">$attr_m</a>[3]))
<a name="l2155"><span class="linenum">2155</span></a>                  {
<a name="l2156"><span class="linenum">2156</span></a>  <span class="comment">                    # Remove `markdown` attribute from opening tag.</span>
<a name="l2157"><span class="linenum">2157</span></a>                      <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(<a class="var it1193" onMouseOver="hilite(1193)" onMouseOut="lolite()" onClick="logVariable('markdown_attr_re')" href="../../_variables/markdown_attr_re.html">$markdown_attr_re</a>, '', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>);
<a name="l2158"><span class="linenum">2158</span></a>                      
<a name="l2159"><span class="linenum">2159</span></a>  <span class="comment">                    # Check if text inside this tag must be parsed in span mode.</span>
<a name="l2160"><span class="linenum">2160</span></a>                      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mode')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/mode.html">mode</a> = <a class="var it1196" onMouseOver="hilite(1196)" onMouseOut="lolite()" onClick="logVariable('attr_m')" href="../../_variables/attr_m.html">$attr_m</a>[2] . <a class="var it1196" onMouseOver="hilite(1196)" onMouseOut="lolite()" onClick="logVariable('attr_m')" href="../../_variables/attr_m.html">$attr_m</a>[3];
<a name="l2161"><span class="linenum">2161</span></a>                      <a class="var it1197" onMouseOver="hilite(1197)" onMouseOut="lolite()" onClick="logVariable('span_mode')" href="../../_variables/span_mode.html">$span_mode</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mode')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/mode.html">mode</a> == 'span' || <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('mode')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/mode.html">mode</a> != 'block' &amp;&amp;
<a name="l2162"><span class="linenum">2162</span></a>                          <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^&lt;(?:'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contain_span_tags_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/contain_span_tags_re.html">contain_span_tags_re</a>.')\b}', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>);
<a name="l2163"><span class="linenum">2163</span></a>                      
<a name="l2164"><span class="linenum">2164</span></a>  <span class="comment">                    # Calculate indent before tag.</span>
<a name="l2165"><span class="linenum">2165</span></a>                      if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/(?:^|\n)( *?)(?! ).*?$/', <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>, <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>)) {
<a name="l2166"><span class="linenum">2166</span></a>                          <a class="var it1161" onMouseOver="hilite(1161)" onMouseOut="lolite()" onClick="logVariable('strlen')" href="../../_variables/strlen.html">$strlen</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('utf8_strlen')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/utf8_strlen.html">utf8_strlen</a>;
<a name="l2167"><span class="linenum">2167</span></a>                          <a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a> = <a class="var it1161" onMouseOver="hilite(1161)" onMouseOut="lolite()" onClick="logVariable('strlen')" href="../../_variables/strlen.html">$strlen</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1], 'UTF-8');
<a name="l2168"><span class="linenum">2168</span></a>                      } else {
<a name="l2169"><span class="linenum">2169</span></a>                          <a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a> = 0;
<a name="l2170"><span class="linenum">2170</span></a>                      }
<a name="l2171"><span class="linenum">2171</span></a>                      
<a name="l2172"><span class="linenum">2172</span></a>  <span class="comment">                    # End preceding block with this tag.</span>
<a name="l2173"><span class="linenum">2173</span></a>                      <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l2174"><span class="linenum">2174</span></a>                      <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('hash_method')" href="../../_variables/hash_method.html">$hash_method</a>(<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>);
<a name="l2175"><span class="linenum">2175</span></a>                      
<a name="l2176"><span class="linenum">2176</span></a>  <span class="comment">                    # Get enclosing tag name for the ParseMarkdown function.</span>
<a name="l2177"><span class="linenum">2177</span></a>  <span class="comment">                    # (This pattern makes $tag_name_re safe without quoting.)</span>
<a name="l2178"><span class="linenum">2178</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^&lt;([\w:$]*)\b/', <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>, <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>);
<a name="l2179"><span class="linenum">2179</span></a>                      <a class="var it1198" onMouseOver="hilite(1198)" onMouseOut="lolite()" onClick="logVariable('tag_name_re')" href="../../_variables/tag_name_re.html">$tag_name_re</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2180"><span class="linenum">2180</span></a>                      
<a name="l2181"><span class="linenum">2181</span></a>  <span class="comment">                    # Parse the content using the HTML-in-Markdown parser.</span>
<a name="l2182"><span class="linenum">2182</span></a>                      list (<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>)
<a name="l2183"><span class="linenum">2183</span></a>                          = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_hashHTMLBlocks_inMarkdown')" href="../../_functions/_hashhtmlblocks_inmarkdown.html" onMouseOver="funcPopup(event,'_hashhtmlblocks_inmarkdown')">_hashHTMLBlocks_inMarkdown</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a>, 
<a name="l2184"><span class="linenum">2184</span></a>                              <a class="var it1198" onMouseOver="hilite(1198)" onMouseOut="lolite()" onClick="logVariable('tag_name_re')" href="../../_variables/tag_name_re.html">$tag_name_re</a>, <a class="var it1197" onMouseOver="hilite(1197)" onMouseOut="lolite()" onClick="logVariable('span_mode')" href="../../_variables/span_mode.html">$span_mode</a>);
<a name="l2185"><span class="linenum">2185</span></a>                      
<a name="l2186"><span class="linenum">2186</span></a>  <span class="comment">                    # Outdent markdown text.</span>
<a name="l2187"><span class="linenum">2187</span></a>                      if (<a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a> &gt; 0) {
<a name="l2188"><span class="linenum">2188</span></a>                          <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(&quot;/^[ ]{1,<a class="var it1180" onMouseOver="hilite(1180)" onMouseOut="lolite()" onClick="logVariable('indent')" href="../../_variables/indent.html">$indent</a>}/m&quot;, &quot;&quot;, 
<a name="l2189"><span class="linenum">2189</span></a>                                                      <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>);
<a name="l2190"><span class="linenum">2190</span></a>                      }
<a name="l2191"><span class="linenum">2191</span></a>                      
<a name="l2192"><span class="linenum">2192</span></a>  <span class="comment">                    # Append tag content to parsed text.</span>
<a name="l2193"><span class="linenum">2193</span></a>                      if (!<a class="var it1197" onMouseOver="hilite(1197)" onMouseOut="lolite()" onClick="logVariable('span_mode')" href="../../_variables/span_mode.html">$span_mode</a>)    <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= &quot;\n\n<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>\n\n&quot;;
<a name="l2194"><span class="linenum">2194</span></a>                      else                <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= &quot;<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>&quot;;
<a name="l2195"><span class="linenum">2195</span></a>                      
<a name="l2196"><span class="linenum">2196</span></a>  <span class="comment">                    # Start over a new block.</span>
<a name="l2197"><span class="linenum">2197</span></a>                      <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a> = &quot;&quot;;
<a name="l2198"><span class="linenum">2198</span></a>                  }
<a name="l2199"><span class="linenum">2199</span></a>                  else <a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a> .= <a class="var it625" onMouseOver="hilite(625)" onMouseOut="lolite()" onClick="logVariable('tag')" href="../../_variables/tag.html">$tag</a>;
<a name="l2200"><span class="linenum">2200</span></a>              }
<a name="l2201"><span class="linenum">2201</span></a>              
<a name="l2202"><span class="linenum">2202</span></a>          } while (<a class="var it1185" onMouseOver="hilite(1185)" onMouseOut="lolite()" onClick="logVariable('depth')" href="../../_variables/depth.html">$depth</a> &gt; 0);
<a name="l2203"><span class="linenum">2203</span></a>          
<a name="l2204"><span class="linenum">2204</span></a>  <span class="comment">        #</span>
<a name="l2205"><span class="linenum">2205</span></a>  <span class="comment">        # Hash last block text that wasn't processed inside the loop.</span>
<a name="l2206"><span class="linenum">2206</span></a>  <span class="comment">        #</span>
<a name="l2207"><span class="linenum">2207</span></a>          <a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a> .= <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('hash_method')" href="../../_variables/hash_method.html">$hash_method</a>(<a class="var it1190" onMouseOver="hilite(1190)" onMouseOut="lolite()" onClick="logVariable('block_text')" href="../../_variables/block_text.html">$block_text</a>);
<a name="l2208"><span class="linenum">2208</span></a>          
<a name="l2209"><span class="linenum">2209</span></a>          return array(<a class="var it1186" onMouseOver="hilite(1186)" onMouseOut="lolite()" onClick="logVariable('parsed')" href="../../_variables/parsed.html">$parsed</a>, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2210"><span class="linenum">2210</span></a>      }
<a name="l2211"><span class="linenum">2211</span></a>  
<a name="l2212"><span class="linenum">2212</span></a>  
<a name="l2213"><span class="linenum">2213</span></a>  	function <a class="function" onClick="logFunction('hashClean')" href="../../_functions/hashclean.html" onMouseOver="funcPopup(event,'hashclean')">hashClean</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2214"><span class="linenum">2214</span></a>  <span class="comment">    #</span>
<a name="l2215"><span class="linenum">2215</span></a>  <span class="comment">    # Called whenever a tag must be hashed when a function insert a &quot;clean&quot; tag</span>
<a name="l2216"><span class="linenum">2216</span></a>  <span class="comment">    # in $text, it pass through this function and is automaticaly escaped, </span>
<a name="l2217"><span class="linenum">2217</span></a>  <span class="comment">    # blocking invalid nested overlap.</span>
<a name="l2218"><span class="linenum">2218</span></a>  <span class="comment">    #</span>
<a name="l2219"><span class="linenum">2219</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, 'C');
<a name="l2220"><span class="linenum">2220</span></a>      }
<a name="l2221"><span class="linenum">2221</span></a>  
<a name="l2222"><span class="linenum">2222</span></a>  
<a name="l2223"><span class="linenum">2223</span></a>  	function <a class="function" onClick="logFunction('doHeaders')" href="../../_functions/doheaders.html" onMouseOver="funcPopup(event,'doheaders')">doHeaders</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2224"><span class="linenum">2224</span></a>  <span class="comment">    #</span>
<a name="l2225"><span class="linenum">2225</span></a>  <span class="comment">    # Redefined to add id attribute support.</span>
<a name="l2226"><span class="linenum">2226</span></a>  <span class="comment">    #</span>
<a name="l2227"><span class="linenum">2227</span></a>  <span class="comment">        # Setext-style headers:</span>
<a name="l2228"><span class="linenum">2228</span></a>  <span class="comment">        #      Header 1  {#header1}</span>
<a name="l2229"><span class="linenum">2229</span></a>  <span class="comment">        #      ========</span>
<a name="l2230"><span class="linenum">2230</span></a>  <span class="comment">        #  </span>
<a name="l2231"><span class="linenum">2231</span></a>  <span class="comment">        #      Header 2  {#header2}</span>
<a name="l2232"><span class="linenum">2232</span></a>  <span class="comment">        #      --------</span>
<a name="l2233"><span class="linenum">2233</span></a>  <span class="comment">        #</span>
<a name="l2234"><span class="linenum">2234</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(
<a name="l2235"><span class="linenum">2235</span></a>              '{
<a name="l2236"><span class="linenum">2236</span></a>                  (^.+?)                                # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>: Header text
<a name="l2237"><span class="linenum">2237</span></a>                  (?:[ ]+\{\#([-_:a-zA-Z0-9]+)\})?    # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>: Id attribute
<a name="l2238"><span class="linenum">2238</span></a>                  [ ]*\n(=+|-+)[ ]*\n+                # <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>: Header footer
<a name="l2239"><span class="linenum">2239</span></a>              }mx',
<a name="l2240"><span class="linenum">2240</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doHeaders_callback_setext'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2241"><span class="linenum">2241</span></a>  
<a name="l2242"><span class="linenum">2242</span></a>  <span class="comment">        # atx-style headers:</span>
<a name="l2243"><span class="linenum">2243</span></a>  <span class="comment">        #    # Header 1        {#header1}</span>
<a name="l2244"><span class="linenum">2244</span></a>  <span class="comment">        #    ## Header 2       {#header2}</span>
<a name="l2245"><span class="linenum">2245</span></a>  <span class="comment">        #    ## Header 2 with closing hashes ##  {#header3}</span>
<a name="l2246"><span class="linenum">2246</span></a>  <span class="comment">        #    ...</span>
<a name="l2247"><span class="linenum">2247</span></a>  <span class="comment">        #    ###### Header 6   {#header2}</span>
<a name="l2248"><span class="linenum">2248</span></a>  <span class="comment">        #</span>
<a name="l2249"><span class="linenum">2249</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2250"><span class="linenum">2250</span></a>                  ^(\#{1,6})    # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a> = string of #\'s
<a name="l2251"><span class="linenum">2251</span></a>                  [ ]*
<a name="l2252"><span class="linenum">2252</span></a>                  (.+?)        # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a> = Header text
<a name="l2253"><span class="linenum">2253</span></a>                  [ ]*
<a name="l2254"><span class="linenum">2254</span></a>                  \#*            # optional closing #\'s (not counted)
<a name="l2255"><span class="linenum">2255</span></a>                  (?:[ ]+\{\#([-_:a-zA-Z0-9]+)\})? # id attribute
<a name="l2256"><span class="linenum">2256</span></a>                  [ ]*
<a name="l2257"><span class="linenum">2257</span></a>                  \n+
<a name="l2258"><span class="linenum">2258</span></a>              }xm',
<a name="l2259"><span class="linenum">2259</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doHeaders_callback_atx'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2260"><span class="linenum">2260</span></a>  
<a name="l2261"><span class="linenum">2261</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2262"><span class="linenum">2262</span></a>      }
<a name="l2263"><span class="linenum">2263</span></a>  	function <a class="function" onClick="logFunction('_doHeaders_attr')" href="../../_functions/_doheaders_attr.html" onMouseOver="funcPopup(event,'_doheaders_attr')">_doHeaders_attr</a>(<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>) {
<a name="l2264"><span class="linenum">2264</span></a>          if (empty(<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>))  return &quot;&quot;;
<a name="l2265"><span class="linenum">2265</span></a>          return &quot; id=\&quot;<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>\&quot;&quot;;
<a name="l2266"><span class="linenum">2266</span></a>      }
<a name="l2267"><span class="linenum">2267</span></a>  	function <a class="function" onClick="logFunction('_doHeaders_callback_setext')" href="../../_functions/_doheaders_callback_setext.html" onMouseOver="funcPopup(event,'_doheaders_callback_setext')">_doHeaders_callback_setext</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2268"><span class="linenum">2268</span></a>          if (<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] == '-' &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{^- }', <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]))
<a name="l2269"><span class="linenum">2269</span></a>              return <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l2270"><span class="linenum">2270</span></a>          <a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3]{0} == '=' ? 1 : 2;
<a name="l2271"><span class="linenum">2271</span></a>          <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>  = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_doHeaders_attr')" href="../../_functions/_doheaders_attr.html" onMouseOver="funcPopup(event,'_doheaders_attr')">_doHeaders_attr</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2]);
<a name="l2272"><span class="linenum">2272</span></a>          <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a> = &quot;&lt;h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a><a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>&gt;&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]).&quot;&lt;/h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>&gt;&quot;;
<a name="l2273"><span class="linenum">2273</span></a>          return &quot;\n&quot; . <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>) . &quot;\n\n&quot;;
<a name="l2274"><span class="linenum">2274</span></a>      }
<a name="l2275"><span class="linenum">2275</span></a>  	function <a class="function" onClick="logFunction('_doHeaders_callback_atx')" href="../../_functions/_doheaders_callback_atx.html" onMouseOver="funcPopup(event,'_doheaders_callback_atx')">_doHeaders_callback_atx</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2276"><span class="linenum">2276</span></a>          <a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a> = strlen(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]);
<a name="l2277"><span class="linenum">2277</span></a>          <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>  = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_doHeaders_attr')" href="../../_functions/_doheaders_attr.html" onMouseOver="funcPopup(event,'_doheaders_attr')">_doHeaders_attr</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> =&amp; <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3]);
<a name="l2278"><span class="linenum">2278</span></a>          <a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a> = &quot;&lt;h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a><a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>&gt;&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2]).&quot;&lt;/h<a class="var it1116" onMouseOver="hilite(1116)" onMouseOut="lolite()" onClick="logVariable('level')" href="../../_variables/level.html">$level</a>&gt;&quot;;
<a name="l2279"><span class="linenum">2279</span></a>          return &quot;\n&quot; . <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it1117" onMouseOver="hilite(1117)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>) . &quot;\n\n&quot;;
<a name="l2280"><span class="linenum">2280</span></a>      }
<a name="l2281"><span class="linenum">2281</span></a>  
<a name="l2282"><span class="linenum">2282</span></a>  
<a name="l2283"><span class="linenum">2283</span></a>  	function <a class="function" onClick="logFunction('doTables')" href="../../_functions/dotables.html" onMouseOver="funcPopup(event,'dotables')">doTables</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2284"><span class="linenum">2284</span></a>  <span class="comment">    #</span>
<a name="l2285"><span class="linenum">2285</span></a>  <span class="comment">    # Form HTML tables.</span>
<a name="l2286"><span class="linenum">2286</span></a>  <span class="comment">    #</span>
<a name="l2287"><span class="linenum">2287</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l2288"><span class="linenum">2288</span></a>  <span class="comment">        #</span>
<a name="l2289"><span class="linenum">2289</span></a>  <span class="comment">        # Find tables with leading pipe.</span>
<a name="l2290"><span class="linenum">2290</span></a>  <span class="comment">        #</span>
<a name="l2291"><span class="linenum">2291</span></a>  <span class="comment">        #    | Header 1 | Header 2</span>
<a name="l2292"><span class="linenum">2292</span></a>  <span class="comment">        #    | -------- | --------</span>
<a name="l2293"><span class="linenum">2293</span></a>  <span class="comment">        #    | Cell 1   | Cell 2</span>
<a name="l2294"><span class="linenum">2294</span></a>  <span class="comment">        #    | Cell 3   | Cell 4</span>
<a name="l2295"><span class="linenum">2295</span></a>  <span class="comment">        #</span>
<a name="l2296"><span class="linenum">2296</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('
<a name="l2297"><span class="linenum">2297</span></a>              {
<a name="l2298"><span class="linenum">2298</span></a>                  ^                            # Start of a line
<a name="l2299"><span class="linenum">2299</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}    <span class="comment"># Allowed whitespace.</span>
<a name="l2300"><span class="linenum">2300</span></a>                  [|]                            # Optional leading pipe (present)
<a name="l2301"><span class="linenum">2301</span></a>                  (.+) \n                        # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>: Header <a class="function" onClick="logFunction('row')" href="../../_functions/row.html" onMouseOver="funcPopup(event,'row')">row</a> (at least one pipe)
<a name="l2302"><span class="linenum">2302</span></a>                  
<a name="l2303"><span class="linenum">2303</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}    <span class="comment"># Allowed whitespace.</span>
<a name="l2304"><span class="linenum">2304</span></a>                  [|] ([ ]*[-:]+[-| :]*) \n    # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>: Header underline
<a name="l2305"><span class="linenum">2305</span></a>                  
<a name="l2306"><span class="linenum">2306</span></a>                  (                            # <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>: Cells
<a name="l2307"><span class="linenum">2307</span></a>                      (?&gt;
<a name="l2308"><span class="linenum">2308</span></a>                          [ ]*                # Allowed whitespace.
<a name="l2309"><span class="linenum">2309</span></a>                          [|] .* \n            # Row content.
<a name="l2310"><span class="linenum">2310</span></a>                      )*
<a name="l2311"><span class="linenum">2311</span></a>                  )
<a name="l2312"><span class="linenum">2312</span></a>                  (?=\n|\Z)                    # Stop at final double newline.
<a name="l2313"><span class="linenum">2313</span></a>              }xm',
<a name="l2314"><span class="linenum">2314</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doTable_leadingPipe_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2315"><span class="linenum">2315</span></a>          
<a name="l2316"><span class="linenum">2316</span></a>  <span class="comment">        #</span>
<a name="l2317"><span class="linenum">2317</span></a>  <span class="comment">        # Find tables without leading pipe.</span>
<a name="l2318"><span class="linenum">2318</span></a>  <span class="comment">        #</span>
<a name="l2319"><span class="linenum">2319</span></a>  <span class="comment">        #    Header 1 | Header 2</span>
<a name="l2320"><span class="linenum">2320</span></a>  <span class="comment">        #    -------- | --------</span>
<a name="l2321"><span class="linenum">2321</span></a>  <span class="comment">        #    Cell 1   | Cell 2</span>
<a name="l2322"><span class="linenum">2322</span></a>  <span class="comment">        #    Cell 3   | Cell 4</span>
<a name="l2323"><span class="linenum">2323</span></a>  <span class="comment">        #</span>
<a name="l2324"><span class="linenum">2324</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('
<a name="l2325"><span class="linenum">2325</span></a>              {
<a name="l2326"><span class="linenum">2326</span></a>                  ^                            # Start of a line
<a name="l2327"><span class="linenum">2327</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}    <span class="comment"># Allowed whitespace.</span>
<a name="l2328"><span class="linenum">2328</span></a>                  (\S.*[|].*) \n                # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>: Header <a class="function" onClick="logFunction('row')" href="../../_functions/row.html" onMouseOver="funcPopup(event,'row')">row</a> (at least one pipe)
<a name="l2329"><span class="linenum">2329</span></a>                  
<a name="l2330"><span class="linenum">2330</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}    <span class="comment"># Allowed whitespace.</span>
<a name="l2331"><span class="linenum">2331</span></a>                  ([-:]+[ ]*[|][-| :]*) \n    # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>: Header underline
<a name="l2332"><span class="linenum">2332</span></a>                  
<a name="l2333"><span class="linenum">2333</span></a>                  (                            # <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>: Cells
<a name="l2334"><span class="linenum">2334</span></a>                      (?&gt;
<a name="l2335"><span class="linenum">2335</span></a>                          .* [|] .* \n        # Row content
<a name="l2336"><span class="linenum">2336</span></a>                      )*
<a name="l2337"><span class="linenum">2337</span></a>                  )
<a name="l2338"><span class="linenum">2338</span></a>                  (?=\n|\Z)                    # Stop at final double newline.
<a name="l2339"><span class="linenum">2339</span></a>              }xm',
<a name="l2340"><span class="linenum">2340</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_DoTable_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2341"><span class="linenum">2341</span></a>  
<a name="l2342"><span class="linenum">2342</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2343"><span class="linenum">2343</span></a>      }
<a name="l2344"><span class="linenum">2344</span></a>  	function <a class="function" onClick="logFunction('_doTable_leadingPipe_callback')" href="../../_functions/_dotable_leadingpipe_callback.html" onMouseOver="funcPopup(event,'_dotable_leadingpipe_callback')">_doTable_leadingPipe_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2345"><span class="linenum">2345</span></a>          <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>        = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2346"><span class="linenum">2346</span></a>          <a class="var it1200" onMouseOver="hilite(1200)" onMouseOut="lolite()" onClick="logVariable('underline')" href="../../_variables/underline.html">$underline</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l2347"><span class="linenum">2347</span></a>          <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l2348"><span class="linenum">2348</span></a>          
<a name="l2349"><span class="linenum">2349</span></a>  <span class="comment">        # Remove leading pipe for each row.</span>
<a name="l2350"><span class="linenum">2350</span></a>          <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>    = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/^ *[|]/m', '', <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>);
<a name="l2351"><span class="linenum">2351</span></a>          
<a name="l2352"><span class="linenum">2352</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_doTable_callback')" href="../../_functions/_dotable_callback.html" onMouseOver="funcPopup(event,'_dotable_callback')">_doTable_callback</a>(array(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0], <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>, <a class="var it1200" onMouseOver="hilite(1200)" onMouseOut="lolite()" onClick="logVariable('underline')" href="../../_variables/underline.html">$underline</a>, <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>));
<a name="l2353"><span class="linenum">2353</span></a>      }
<a name="l2354"><span class="linenum">2354</span></a>  	function <a class="function" onClick="logFunction('_doTable_callback')" href="../../_functions/_dotable_callback.html" onMouseOver="funcPopup(event,'_dotable_callback')">_doTable_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2355"><span class="linenum">2355</span></a>          <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>        = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2356"><span class="linenum">2356</span></a>          <a class="var it1200" onMouseOver="hilite(1200)" onMouseOut="lolite()" onClick="logVariable('underline')" href="../../_variables/underline.html">$underline</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l2357"><span class="linenum">2357</span></a>          <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l2358"><span class="linenum">2358</span></a>  
<a name="l2359"><span class="linenum">2359</span></a>  <span class="comment">        # Remove any tailing pipes for each line.</span>
<a name="l2360"><span class="linenum">2360</span></a>          <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>        = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[|] *$/m', '', <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>);
<a name="l2361"><span class="linenum">2361</span></a>          <a class="var it1200" onMouseOver="hilite(1200)" onMouseOut="lolite()" onClick="logVariable('underline')" href="../../_variables/underline.html">$underline</a>    = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[|] *$/m', '', <a class="var it1200" onMouseOver="hilite(1200)" onMouseOut="lolite()" onClick="logVariable('underline')" href="../../_variables/underline.html">$underline</a>);
<a name="l2362"><span class="linenum">2362</span></a>          <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>    = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/[|] *$/m', '', <a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>);
<a name="l2363"><span class="linenum">2363</span></a>          
<a name="l2364"><span class="linenum">2364</span></a>  <span class="comment">        # Reading alignement from header underline.</span>
<a name="l2365"><span class="linenum">2365</span></a>          <a class="var it1201" onMouseOver="hilite(1201)" onMouseOut="lolite()" onClick="logVariable('separators')" href="../../_variables/separators.html">$separators</a>    = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/ *[|] */', <a class="var it1200" onMouseOver="hilite(1200)" onMouseOut="lolite()" onClick="logVariable('underline')" href="../../_variables/underline.html">$underline</a>);
<a name="l2366"><span class="linenum">2366</span></a>          foreach (<a class="var it1201" onMouseOver="hilite(1201)" onMouseOut="lolite()" onClick="logVariable('separators')" href="../../_variables/separators.html">$separators</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a> =&gt; <a class="var it315" onMouseOver="hilite(315)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../_variables/s.html">$s</a>) {
<a name="l2367"><span class="linenum">2367</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^ *-+: *$/', <a class="var it315" onMouseOver="hilite(315)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../_variables/s.html">$s</a>))        <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a>] = ' align=&quot;right&quot;';
<a name="l2368"><span class="linenum">2368</span></a>              else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^ *:-+: *$/', <a class="var it315" onMouseOver="hilite(315)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../_variables/s.html">$s</a>))<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a>] = ' align=&quot;center&quot;';
<a name="l2369"><span class="linenum">2369</span></a>              else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^ *:-+ *$/', <a class="var it315" onMouseOver="hilite(315)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../_variables/s.html">$s</a>))    <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a>] = ' align=&quot;left&quot;';
<a name="l2370"><span class="linenum">2370</span></a>              else                                    <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a>] = '';
<a name="l2371"><span class="linenum">2371</span></a>          }
<a name="l2372"><span class="linenum">2372</span></a>          
<a name="l2373"><span class="linenum">2373</span></a>  <span class="comment">        # Parsing span elements, including code spans, character escapes, </span>
<a name="l2374"><span class="linenum">2374</span></a>  <span class="comment">        # and inline HTML tags, so that pipes inside those gets ignored.</span>
<a name="l2375"><span class="linenum">2375</span></a>          <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>        = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('parseSpan')" href="../../_functions/parsespan.html" onMouseOver="funcPopup(event,'parsespan')">parseSpan</a>(<a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>);
<a name="l2376"><span class="linenum">2376</span></a>          <a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../_variables/headers.html">$headers</a>    = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/ *[|] */', <a class="var it1199" onMouseOver="hilite(1199)" onMouseOut="lolite()" onClick="logVariable('head')" href="../../_variables/head.html">$head</a>);
<a name="l2377"><span class="linenum">2377</span></a>          <a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('col_count')" href="../../_variables/col_count.html">$col_count</a>    = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../_variables/headers.html">$headers</a>);
<a name="l2378"><span class="linenum">2378</span></a>          
<a name="l2379"><span class="linenum">2379</span></a>  <span class="comment">        # Write column headers.</span>
<a name="l2380"><span class="linenum">2380</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = &quot;&lt;table&gt;\n&quot;;
<a name="l2381"><span class="linenum">2381</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;thead&gt;\n&quot;;
<a name="l2382"><span class="linenum">2382</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;tr&gt;\n&quot;;
<a name="l2383"><span class="linenum">2383</span></a>          foreach (<a class="var it599" onMouseOver="hilite(599)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../_variables/headers.html">$headers</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a> =&gt; <a class="var it251" onMouseOver="hilite(251)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../_variables/header.html">$header</a>)
<a name="l2384"><span class="linenum">2384</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;  &lt;th<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a>]&gt;&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it251" onMouseOver="hilite(251)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../_variables/header.html">$header</a>)).&quot;&lt;/th&gt;\n&quot;;
<a name="l2385"><span class="linenum">2385</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/tr&gt;\n&quot;;
<a name="l2386"><span class="linenum">2386</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/thead&gt;\n&quot;;
<a name="l2387"><span class="linenum">2387</span></a>          
<a name="l2388"><span class="linenum">2388</span></a>  <span class="comment">        # Split content by row.</span>
<a name="l2389"><span class="linenum">2389</span></a>          <a class="var it807" onMouseOver="hilite(807)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it603" onMouseOver="hilite(603)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../_variables/content.html">$content</a>, &quot;\n&quot;));
<a name="l2390"><span class="linenum">2390</span></a>          
<a name="l2391"><span class="linenum">2391</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;tbody&gt;\n&quot;;
<a name="l2392"><span class="linenum">2392</span></a>          foreach (<a class="var it807" onMouseOver="hilite(807)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a> as <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>) {
<a name="l2393"><span class="linenum">2393</span></a>  <span class="comment">            # Parsing span elements, including code spans, character escapes, </span>
<a name="l2394"><span class="linenum">2394</span></a>  <span class="comment">            # and inline HTML tags, so that pipes inside those gets ignored.</span>
<a name="l2395"><span class="linenum">2395</span></a>              <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('parseSpan')" href="../../_functions/parsespan.html" onMouseOver="funcPopup(event,'parsespan')">parseSpan</a>(<a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>);
<a name="l2396"><span class="linenum">2396</span></a>              
<a name="l2397"><span class="linenum">2397</span></a>  <span class="comment">            # Split row by cell.</span>
<a name="l2398"><span class="linenum">2398</span></a>              <a class="var it1203" onMouseOver="hilite(1203)" onMouseOut="lolite()" onClick="logVariable('row_cells')" href="../../_variables/row_cells.html">$row_cells</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/ *[|] */', <a class="var it27" onMouseOver="hilite(27)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>, <a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('col_count')" href="../../_variables/col_count.html">$col_count</a>);
<a name="l2399"><span class="linenum">2399</span></a>              <a class="var it1203" onMouseOver="hilite(1203)" onMouseOut="lolite()" onClick="logVariable('row_cells')" href="../../_variables/row_cells.html">$row_cells</a> = <a class="phpfunction" onClick="logFunction('array_pad')" href="../../_functions/array_pad.html" onMouseOver="phpfuncPopup(event,'array_pad')">array_pad</a>(<a class="var it1203" onMouseOver="hilite(1203)" onMouseOut="lolite()" onClick="logVariable('row_cells')" href="../../_variables/row_cells.html">$row_cells</a>, <a class="var it1202" onMouseOver="hilite(1202)" onMouseOut="lolite()" onClick="logVariable('col_count')" href="../../_variables/col_count.html">$col_count</a>, '');
<a name="l2400"><span class="linenum">2400</span></a>              
<a name="l2401"><span class="linenum">2401</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;tr&gt;\n&quot;;
<a name="l2402"><span class="linenum">2402</span></a>              foreach (<a class="var it1203" onMouseOver="hilite(1203)" onMouseOut="lolite()" onClick="logVariable('row_cells')" href="../../_variables/row_cells.html">$row_cells</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a> =&gt; <a class="var it815" onMouseOver="hilite(815)" onMouseOut="lolite()" onClick="logVariable('cell')" href="../../_variables/cell.html">$cell</a>)
<a name="l2403"><span class="linenum">2403</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;  &lt;td<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('n')" href="../../_variables/n.html">$n</a>]&gt;&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it815" onMouseOver="hilite(815)" onMouseOut="lolite()" onClick="logVariable('cell')" href="../../_variables/cell.html">$cell</a>)).&quot;&lt;/td&gt;\n&quot;;
<a name="l2404"><span class="linenum">2404</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/tr&gt;\n&quot;;
<a name="l2405"><span class="linenum">2405</span></a>          }
<a name="l2406"><span class="linenum">2406</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/tbody&gt;\n&quot;;
<a name="l2407"><span class="linenum">2407</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/table&gt;&quot;;
<a name="l2408"><span class="linenum">2408</span></a>          
<a name="l2409"><span class="linenum">2409</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) . &quot;\n&quot;;
<a name="l2410"><span class="linenum">2410</span></a>      }
<a name="l2411"><span class="linenum">2411</span></a>  
<a name="l2412"><span class="linenum">2412</span></a>      
<a name="l2413"><span class="linenum">2413</span></a>  	function <a class="function" onClick="logFunction('doDefLists')" href="../../_functions/dodeflists.html" onMouseOver="funcPopup(event,'dodeflists')">doDefLists</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2414"><span class="linenum">2414</span></a>  <span class="comment">    #</span>
<a name="l2415"><span class="linenum">2415</span></a>  <span class="comment">    # Form HTML definition lists.</span>
<a name="l2416"><span class="linenum">2416</span></a>  <span class="comment">    #</span>
<a name="l2417"><span class="linenum">2417</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l2418"><span class="linenum">2418</span></a>  
<a name="l2419"><span class="linenum">2419</span></a>  <span class="comment">        # Re-usable pattern to match any entire dl list:</span>
<a name="l2420"><span class="linenum">2420</span></a>          <a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('whole_list_re')" href="../../_variables/whole_list_re.html">$whole_list_re</a> = '(?&gt;
<a name="l2421"><span class="linenum">2421</span></a>              (                                # <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a> = whole list
<a name="l2422"><span class="linenum">2422</span></a>                (                                # <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l2423"><span class="linenum">2423</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l2424"><span class="linenum">2424</span></a>                  ((?&gt;.*\S.*\n)+)                # <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a> = defined term
<a name="l2425"><span class="linenum">2425</span></a>                  \n?
<a name="l2426"><span class="linenum">2426</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}:[ ]+ # colon starting definition
<a name="l2427"><span class="linenum">2427</span></a>                )
<a name="l2428"><span class="linenum">2428</span></a>                (?s:.+?)
<a name="l2429"><span class="linenum">2429</span></a>                (                                # <a class="var it1103" onMouseOver="hilite(1103)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>
<a name="l2430"><span class="linenum">2430</span></a>                    \z
<a name="l2431"><span class="linenum">2431</span></a>                  |
<a name="l2432"><span class="linenum">2432</span></a>                    \n{2,}
<a name="l2433"><span class="linenum">2433</span></a>                    (?=\S)
<a name="l2434"><span class="linenum">2434</span></a>                    (?!                        # Negative lookahead for another term
<a name="l2435"><span class="linenum">2435</span></a>                      [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}
<a name="l2436"><span class="linenum">2436</span></a>                      (?: \S.*\n )+?            # defined term
<a name="l2437"><span class="linenum">2437</span></a>                      \n?
<a name="l2438"><span class="linenum">2438</span></a>                      [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}:[ ]+ # colon starting definition
<a name="l2439"><span class="linenum">2439</span></a>                    )
<a name="l2440"><span class="linenum">2440</span></a>                    (?!                        # Negative lookahead for another definition
<a name="l2441"><span class="linenum">2441</span></a>                      [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}:[ ]+ # colon starting definition
<a name="l2442"><span class="linenum">2442</span></a>                    )
<a name="l2443"><span class="linenum">2443</span></a>                )
<a name="l2444"><span class="linenum">2444</span></a>              )
<a name="l2445"><span class="linenum">2445</span></a>          )'; <span class="comment">// mx</span>
<a name="l2446"><span class="linenum">2446</span></a>  
<a name="l2447"><span class="linenum">2447</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2448"><span class="linenum">2448</span></a>                  (?&gt;\A\n?|(?&lt;=\n\n))
<a name="l2449"><span class="linenum">2449</span></a>                  '.<a class="var it1124" onMouseOver="hilite(1124)" onMouseOut="lolite()" onClick="logVariable('whole_list_re')" href="../../_variables/whole_list_re.html">$whole_list_re</a>.'
<a name="l2450"><span class="linenum">2450</span></a>              }mx',
<a name="l2451"><span class="linenum">2451</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doDefLists_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2452"><span class="linenum">2452</span></a>  
<a name="l2453"><span class="linenum">2453</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2454"><span class="linenum">2454</span></a>      }
<a name="l2455"><span class="linenum">2455</span></a>  	function <a class="function" onClick="logFunction('_doDefLists_callback')" href="../../_functions/_dodeflists_callback.html" onMouseOver="funcPopup(event,'_dodeflists_callback')">_doDefLists_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2456"><span class="linenum">2456</span></a>  <span class="comment">        # Re-usable patterns to match list item bullets and number markers:</span>
<a name="l2457"><span class="linenum">2457</span></a>          <a class="var it327" onMouseOver="hilite(327)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2458"><span class="linenum">2458</span></a>          
<a name="l2459"><span class="linenum">2459</span></a>  <span class="comment">        # Turn double returns into triple returns, so that we can make a</span>
<a name="l2460"><span class="linenum">2460</span></a>  <span class="comment">        # paragraph for the last item in a list, if necessary:</span>
<a name="l2461"><span class="linenum">2461</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('processDefListItems')" href="../../_functions/processdeflistitems.html" onMouseOver="funcPopup(event,'processdeflistitems')">processDefListItems</a>(<a class="var it327" onMouseOver="hilite(327)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a>));
<a name="l2462"><span class="linenum">2462</span></a>          <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = &quot;&lt;dl&gt;\n&quot; . <a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> . &quot;\n&lt;/dl&gt;&quot;;
<a name="l2463"><span class="linenum">2463</span></a>          return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it414" onMouseOver="hilite(414)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>) . &quot;\n\n&quot;;
<a name="l2464"><span class="linenum">2464</span></a>      }
<a name="l2465"><span class="linenum">2465</span></a>  
<a name="l2466"><span class="linenum">2466</span></a>  
<a name="l2467"><span class="linenum">2467</span></a>  	function <a class="function" onClick="logFunction('processDefListItems')" href="../../_functions/processdeflistitems.html" onMouseOver="funcPopup(event,'processdeflistitems')">processDefListItems</a>(<a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>) {
<a name="l2468"><span class="linenum">2468</span></a>  <span class="comment">    #</span>
<a name="l2469"><span class="linenum">2469</span></a>  <span class="comment">    #    Process the contents of a single definition list, splitting it</span>
<a name="l2470"><span class="linenum">2470</span></a>  <span class="comment">    #    into individual term and definition list items.</span>
<a name="l2471"><span class="linenum">2471</span></a>  <span class="comment">    #</span>
<a name="l2472"><span class="linenum">2472</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l2473"><span class="linenum">2473</span></a>          
<a name="l2474"><span class="linenum">2474</span></a>  <span class="comment">        # trim trailing blank lines:</span>
<a name="l2475"><span class="linenum">2475</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(&quot;/\n{2,}\\z/&quot;, &quot;\n&quot;, <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>);
<a name="l2476"><span class="linenum">2476</span></a>  
<a name="l2477"><span class="linenum">2477</span></a>  <span class="comment">        # Process definition terms.</span>
<a name="l2478"><span class="linenum">2478</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2479"><span class="linenum">2479</span></a>              (?&gt;\A\n?|\n\n+)                    # leading line
<a name="l2480"><span class="linenum">2480</span></a>              (                                # definition terms = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l2481"><span class="linenum">2481</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}    <span class="comment"># leading whitespace</span>
<a name="l2482"><span class="linenum">2482</span></a>                  (?![:][ ]|[ ])                # negative lookahead for a definition 
<a name="l2483"><span class="linenum">2483</span></a>  <span class="comment">                                            #   mark (colon) or more whitespace.</span>
<a name="l2484"><span class="linenum">2484</span></a>                  (?&gt; \S.* \n)+?                # actual term (not whitespace).    
<a name="l2485"><span class="linenum">2485</span></a>              )            
<a name="l2486"><span class="linenum">2486</span></a>              (?=\n?[ ]{0,3}:[ ])                # lookahead for following line feed 
<a name="l2487"><span class="linenum">2487</span></a>  <span class="comment">                                            #   with a definition mark.</span>
<a name="l2488"><span class="linenum">2488</span></a>              }xm',
<a name="l2489"><span class="linenum">2489</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_processDefListItems_callback_dt'), <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>);
<a name="l2490"><span class="linenum">2490</span></a>  
<a name="l2491"><span class="linenum">2491</span></a>  <span class="comment">        # Process actual definitions.</span>
<a name="l2492"><span class="linenum">2492</span></a>          <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2493"><span class="linenum">2493</span></a>              \n(\n+)?                        # leading line = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l2494"><span class="linenum">2494</span></a>              (                                # marker space = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>
<a name="l2495"><span class="linenum">2495</span></a>                  [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}    <span class="comment"># whitespace before colon</span>
<a name="l2496"><span class="linenum">2496</span></a>                  [:][ ]+                        # definition <a class="function" onClick="logFunction('mark')" href="../../_functions/mark.html" onMouseOver="funcPopup(event,'mark')">mark</a> (colon)
<a name="l2497"><span class="linenum">2497</span></a>              )
<a name="l2498"><span class="linenum">2498</span></a>              ((?s:.+?))                        # definition text = <a class="var it1102" onMouseOver="hilite(1102)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>
<a name="l2499"><span class="linenum">2499</span></a>              (?= \n+                         # stop at next definition mark,
<a name="l2500"><span class="linenum">2500</span></a>                  (?:                            # next term or end of text
<a name="l2501"><span class="linenum">2501</span></a>                      [ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'} [:][ ]    |
<a name="l2502"><span class="linenum">2502</span></a>                      &lt;dt&gt; | \z
<a name="l2503"><span class="linenum">2503</span></a>                  )                        
<a name="l2504"><span class="linenum">2504</span></a>              )                    
<a name="l2505"><span class="linenum">2505</span></a>              }xm',
<a name="l2506"><span class="linenum">2506</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_processDefListItems_callback_dd'), <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>);
<a name="l2507"><span class="linenum">2507</span></a>  
<a name="l2508"><span class="linenum">2508</span></a>          return <a class="var it1127" onMouseOver="hilite(1127)" onMouseOut="lolite()" onClick="logVariable('list_str')" href="../../_variables/list_str.html">$list_str</a>;
<a name="l2509"><span class="linenum">2509</span></a>      }
<a name="l2510"><span class="linenum">2510</span></a>  	function <a class="function" onClick="logFunction('_processDefListItems_callback_dt')" href="../../_functions/_processdeflistitems_callback_dt.html" onMouseOver="funcPopup(event,'_processdeflistitems_callback_dt')">_processDefListItems_callback_dt</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2511"><span class="linenum">2511</span></a>          <a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('terms')" href="../../_variables/terms.html">$terms</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\n&quot;, <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1]));
<a name="l2512"><span class="linenum">2512</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = '';
<a name="l2513"><span class="linenum">2513</span></a>          foreach (<a class="var it1204" onMouseOver="hilite(1204)" onMouseOut="lolite()" onClick="logVariable('terms')" href="../../_variables/terms.html">$terms</a> as <a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('term')" href="../../_variables/term.html">$term</a>) {
<a name="l2514"><span class="linenum">2514</span></a>              <a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('term')" href="../../_variables/term.html">$term</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('term')" href="../../_variables/term.html">$term</a>));
<a name="l2515"><span class="linenum">2515</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;\n&lt;dt&gt;&quot; . <a class="var it1205" onMouseOver="hilite(1205)" onMouseOut="lolite()" onClick="logVariable('term')" href="../../_variables/term.html">$term</a> . &quot;&lt;/dt&gt;&quot;;
<a name="l2516"><span class="linenum">2516</span></a>          }
<a name="l2517"><span class="linenum">2517</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> . &quot;\n&quot;;
<a name="l2518"><span class="linenum">2518</span></a>      }
<a name="l2519"><span class="linenum">2519</span></a>  	function <a class="function" onClick="logFunction('_processDefListItems_callback_dd')" href="../../_functions/_processdeflistitems_callback_dd.html" onMouseOver="funcPopup(event,'_processdeflistitems_callback_dd')">_processDefListItems_callback_dd</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2520"><span class="linenum">2520</span></a>          <a class="var it1128" onMouseOver="hilite(1128)" onMouseOut="lolite()" onClick="logVariable('leading_line')" href="../../_variables/leading_line.html">$leading_line</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2521"><span class="linenum">2521</span></a>          <a class="var it1130" onMouseOver="hilite(1130)" onMouseOut="lolite()" onClick="logVariable('marker_space')" href="../../_variables/marker_space.html">$marker_space</a>    = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l2522"><span class="linenum">2522</span></a>          <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a>            = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l2523"><span class="linenum">2523</span></a>  
<a name="l2524"><span class="linenum">2524</span></a>          if (<a class="var it1128" onMouseOver="hilite(1128)" onMouseOut="lolite()" onClick="logVariable('leading_line')" href="../../_variables/leading_line.html">$leading_line</a> || <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/\n{2,}/', <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a>)) {
<a name="l2525"><span class="linenum">2525</span></a>  <span class="comment">            # Replace marker with the appropriate whitespace indentation</span>
<a name="l2526"><span class="linenum">2526</span></a>              <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> = <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>(' ', strlen(<a class="var it1130" onMouseOver="hilite(1130)" onMouseOut="lolite()" onClick="logVariable('marker_space')" href="../../_variables/marker_space.html">$marker_space</a>)) . <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a>;
<a name="l2527"><span class="linenum">2527</span></a>              <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runBlockGamut')" href="../../_functions/runblockgamut.html" onMouseOver="funcPopup(event,'runblockgamut')">runBlockGamut</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> . &quot;\n\n&quot;));
<a name="l2528"><span class="linenum">2528</span></a>              <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> = &quot;\n&quot;. <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> .&quot;\n&quot;;
<a name="l2529"><span class="linenum">2529</span></a>          }
<a name="l2530"><span class="linenum">2530</span></a>          else {
<a name="l2531"><span class="linenum">2531</span></a>              <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> = <a class="phpfunction" onClick="logFunction('rtrim')" href="../../_functions/rtrim.html" onMouseOver="phpfuncPopup(event,'rtrim')">rtrim</a>(<a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a>);
<a name="l2532"><span class="linenum">2532</span></a>              <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a>));
<a name="l2533"><span class="linenum">2533</span></a>          }
<a name="l2534"><span class="linenum">2534</span></a>  
<a name="l2535"><span class="linenum">2535</span></a>          return &quot;\n&lt;dd&gt;&quot; . <a class="var it1206" onMouseOver="hilite(1206)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../_variables/def.html">$def</a> . &quot;&lt;/dd&gt;\n&quot;;
<a name="l2536"><span class="linenum">2536</span></a>      }
<a name="l2537"><span class="linenum">2537</span></a>  
<a name="l2538"><span class="linenum">2538</span></a>  
<a name="l2539"><span class="linenum">2539</span></a>  	function <a class="function" onClick="logFunction('doFencedCodeBlocks')" href="../../_functions/dofencedcodeblocks.html" onMouseOver="funcPopup(event,'dofencedcodeblocks')">doFencedCodeBlocks</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2540"><span class="linenum">2540</span></a>  <span class="comment">    #</span>
<a name="l2541"><span class="linenum">2541</span></a>  <span class="comment">    # Adding the fenced code block syntax to regular Markdown:</span>
<a name="l2542"><span class="linenum">2542</span></a>  <span class="comment">    #</span>
<a name="l2543"><span class="linenum">2543</span></a>  <span class="comment">    # ~~~</span>
<a name="l2544"><span class="linenum">2544</span></a>  <span class="comment">    # Code block</span>
<a name="l2545"><span class="linenum">2545</span></a>  <span class="comment">    # ~~~</span>
<a name="l2546"><span class="linenum">2546</span></a>  <span class="comment">    #</span>
<a name="l2547"><span class="linenum">2547</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a>;
<a name="l2548"><span class="linenum">2548</span></a>          
<a name="l2549"><span class="linenum">2549</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2550"><span class="linenum">2550</span></a>                  (?:\n|\A)
<a name="l2551"><span class="linenum">2551</span></a>  <span class="comment">                # 1: Opening marker</span>
<a name="l2552"><span class="linenum">2552</span></a>                  (
<a name="l2553"><span class="linenum">2553</span></a>                      ~{3,} <span class="comment"># Marker: three tilde or more.</span>
<a name="l2554"><span class="linenum">2554</span></a>                  )
<a name="l2555"><span class="linenum">2555</span></a>                  [ ]* \n # Whitespace and newline following marker.
<a name="l2556"><span class="linenum">2556</span></a>                  
<a name="l2557"><span class="linenum">2557</span></a>  <span class="comment">                # 2: Content</span>
<a name="l2558"><span class="linenum">2558</span></a>                  (
<a name="l2559"><span class="linenum">2559</span></a>                      (?&gt;
<a name="l2560"><span class="linenum">2560</span></a>                          (?!\1 [ ]* \n)    # Not a closing marker.
<a name="l2561"><span class="linenum">2561</span></a>                          .*\n+
<a name="l2562"><span class="linenum">2562</span></a>                      )+
<a name="l2563"><span class="linenum">2563</span></a>                  )
<a name="l2564"><span class="linenum">2564</span></a>                  
<a name="l2565"><span class="linenum">2565</span></a>  <span class="comment">                # Closing marker.</span>
<a name="l2566"><span class="linenum">2566</span></a>                  \1 [ ]* \n
<a name="l2567"><span class="linenum">2567</span></a>              }xm',
<a name="l2568"><span class="linenum">2568</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doFencedCodeBlocks_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2569"><span class="linenum">2569</span></a>  
<a name="l2570"><span class="linenum">2570</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2571"><span class="linenum">2571</span></a>      }
<a name="l2572"><span class="linenum">2572</span></a>  	function <a class="function" onClick="logFunction('_doFencedCodeBlocks_callback')" href="../../_functions/_dofencedcodeblocks_callback.html" onMouseOver="funcPopup(event,'_dofencedcodeblocks_callback')">_doFencedCodeBlocks_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2573"><span class="linenum">2573</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l2574"><span class="linenum">2574</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>, ENT_NOQUOTES);
<a name="l2575"><span class="linenum">2575</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('/^\n+/',
<a name="l2576"><span class="linenum">2576</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doFencedCodeBlocks_newlines'), <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>);
<a name="l2577"><span class="linenum">2577</span></a>          <a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a> = &quot;&lt;pre&gt;&lt;code&gt;<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>&lt;/code&gt;&lt;/pre&gt;&quot;;
<a name="l2578"><span class="linenum">2578</span></a>          return &quot;\n\n&quot;.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashBlock')" href="../../_functions/hashblock.html" onMouseOver="funcPopup(event,'hashblock')">hashBlock</a>(<a class="var it1132" onMouseOver="hilite(1132)" onMouseOut="lolite()" onClick="logVariable('codeblock')" href="../../_variables/codeblock.html">$codeblock</a>).&quot;\n\n&quot;;
<a name="l2579"><span class="linenum">2579</span></a>      }
<a name="l2580"><span class="linenum">2580</span></a>  	function <a class="function" onClick="logFunction('_doFencedCodeBlocks_newlines')" href="../../_functions/_dofencedcodeblocks_newlines.html" onMouseOver="funcPopup(event,'_dofencedcodeblocks_newlines')">_doFencedCodeBlocks_newlines</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2581"><span class="linenum">2581</span></a>          return <a class="phpfunction" onClick="logFunction('str_repeat')" href="../../_functions/str_repeat.html" onMouseOver="phpfuncPopup(event,'str_repeat')">str_repeat</a>(&quot;&lt;br<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('empty_element_suffix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/empty_element_suffix.html">empty_element_suffix</a>&quot;, 
<a name="l2582"><span class="linenum">2582</span></a>              strlen(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0]));
<a name="l2583"><span class="linenum">2583</span></a>      }
<a name="l2584"><span class="linenum">2584</span></a>  
<a name="l2585"><span class="linenum">2585</span></a>  
<a name="l2586"><span class="linenum">2586</span></a>  <span class="comment">    #</span>
<a name="l2587"><span class="linenum">2587</span></a>  <span class="comment">    # Redefining emphasis markers so that emphasis by underscore does not</span>
<a name="l2588"><span class="linenum">2588</span></a>  <span class="comment">    # work in the middle of a word.</span>
<a name="l2589"><span class="linenum">2589</span></a>  <span class="comment">    #</span>
<a name="l2590"><span class="linenum">2590</span></a>      var <a class="var it1133" onMouseOver="hilite(1133)" onMouseOut="lolite()" onClick="logVariable('em_relist')" href="../../_variables/em_relist.html">$em_relist</a> = array(
<a name="l2591"><span class="linenum">2591</span></a>          ''  =&gt; '(?:(?&lt;!\*)\*(?!\*)|(?&lt;![a-zA-Z0-9_])_(?!_))(?=\S|$)(?![.,:;]\s)',
<a name="l2592"><span class="linenum">2592</span></a>          '*' =&gt; '(?&lt;=\S|^)(?&lt;!\*)\*(?!\*)',
<a name="l2593"><span class="linenum">2593</span></a>          '_' =&gt; '(?&lt;=\S|^)(?&lt;!_)_(?![a-zA-Z0-9_])',
<a name="l2594"><span class="linenum">2594</span></a>          );
<a name="l2595"><span class="linenum">2595</span></a>      var <a class="var it1134" onMouseOver="hilite(1134)" onMouseOut="lolite()" onClick="logVariable('strong_relist')" href="../../_variables/strong_relist.html">$strong_relist</a> = array(
<a name="l2596"><span class="linenum">2596</span></a>          ''   =&gt; '(?:(?&lt;!\*)\*\*(?!\*)|(?&lt;![a-zA-Z0-9_])__(?!_))(?=\S|$)(?![.,:;]\s)',
<a name="l2597"><span class="linenum">2597</span></a>          '**' =&gt; '(?&lt;=\S|^)(?&lt;!\*)\*\*(?!\*)',
<a name="l2598"><span class="linenum">2598</span></a>          '__' =&gt; '(?&lt;=\S|^)(?&lt;!_)__(?![a-zA-Z0-9_])',
<a name="l2599"><span class="linenum">2599</span></a>          );
<a name="l2600"><span class="linenum">2600</span></a>      var <a class="var it1135" onMouseOver="hilite(1135)" onMouseOut="lolite()" onClick="logVariable('em_strong_relist')" href="../../_variables/em_strong_relist.html">$em_strong_relist</a> = array(
<a name="l2601"><span class="linenum">2601</span></a>          ''    =&gt; '(?:(?&lt;!\*)\*\*\*(?!\*)|(?&lt;![a-zA-Z0-9_])___(?!_))(?=\S|$)(?![.,:;]\s)',
<a name="l2602"><span class="linenum">2602</span></a>          '***' =&gt; '(?&lt;=\S|^)(?&lt;!\*)\*\*\*(?!\*)',
<a name="l2603"><span class="linenum">2603</span></a>          '___' =&gt; '(?&lt;=\S|^)(?&lt;!_)___(?![a-zA-Z0-9_])',
<a name="l2604"><span class="linenum">2604</span></a>          );
<a name="l2605"><span class="linenum">2605</span></a>  
<a name="l2606"><span class="linenum">2606</span></a>  
<a name="l2607"><span class="linenum">2607</span></a>  	function <a class="function" onClick="logFunction('formParagraphs')" href="../../_functions/formparagraphs.html" onMouseOver="funcPopup(event,'formparagraphs')">formParagraphs</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2608"><span class="linenum">2608</span></a>  <span class="comment">    #</span>
<a name="l2609"><span class="linenum">2609</span></a>  <span class="comment">    #    Params:</span>
<a name="l2610"><span class="linenum">2610</span></a>  <span class="comment">    #        $text - string to process with html &lt;p&gt; tags</span>
<a name="l2611"><span class="linenum">2611</span></a>  <span class="comment">    #</span>
<a name="l2612"><span class="linenum">2612</span></a>  <span class="comment">        # Strip leading and trailing lines:</span>
<a name="l2613"><span class="linenum">2613</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\A\n+|\n+\z/', '', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2614"><span class="linenum">2614</span></a>          
<a name="l2615"><span class="linenum">2615</span></a>          <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('/\n{2,}/', <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, -1, PREG_SPLIT_NO_EMPTY);
<a name="l2616"><span class="linenum">2616</span></a>  
<a name="l2617"><span class="linenum">2617</span></a>  <span class="comment">        #</span>
<a name="l2618"><span class="linenum">2618</span></a>  <span class="comment">        # Wrap &lt;p&gt; tags and unhashify HTML blocks</span>
<a name="l2619"><span class="linenum">2619</span></a>  <span class="comment">        #</span>
<a name="l2620"><span class="linenum">2620</span></a>          foreach (<a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a> as <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l2621"><span class="linenum">2621</span></a>              <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runSpanGamut')" href="../../_functions/runspangamut.html" onMouseOver="funcPopup(event,'runspangamut')">runSpanGamut</a>(<a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>));
<a name="l2622"><span class="linenum">2622</span></a>              
<a name="l2623"><span class="linenum">2623</span></a>  <span class="comment">            # Check if this should be enclosed in a paragraph.</span>
<a name="l2624"><span class="linenum">2624</span></a>  <span class="comment">            # Clean tag hashes &amp; block tag hashes are left alone.</span>
<a name="l2625"><span class="linenum">2625</span></a>              <a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('is_p')" href="../../_variables/is_p.html">$is_p</a> = !<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^B\x1A[0-9]+B|^C\x1A[0-9]+C$/', <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l2626"><span class="linenum">2626</span></a>              
<a name="l2627"><span class="linenum">2627</span></a>              if (<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('is_p')" href="../../_variables/is_p.html">$is_p</a>) {
<a name="l2628"><span class="linenum">2628</span></a>                  <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = &quot;&lt;p&gt;<a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>&lt;/p&gt;&quot;;
<a name="l2629"><span class="linenum">2629</span></a>              }
<a name="l2630"><span class="linenum">2630</span></a>              <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a>[<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>] = <a class="var it67" onMouseOver="hilite(67)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l2631"><span class="linenum">2631</span></a>          }
<a name="l2632"><span class="linenum">2632</span></a>          
<a name="l2633"><span class="linenum">2633</span></a>  <span class="comment">        # Join grafs in one text, then unhash HTML tags. </span>
<a name="l2634"><span class="linenum">2634</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(&quot;\n\n&quot;, <a class="var it1151" onMouseOver="hilite(1151)" onMouseOut="lolite()" onClick="logVariable('grafs')" href="../../_variables/grafs.html">$grafs</a>);
<a name="l2635"><span class="linenum">2635</span></a>          
<a name="l2636"><span class="linenum">2636</span></a>  <span class="comment">        # Finish by removing any tag hashes still present in $text.</span>
<a name="l2637"><span class="linenum">2637</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('unhash')" href="../../_functions/unhash.html" onMouseOver="funcPopup(event,'unhash')">unhash</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2638"><span class="linenum">2638</span></a>          
<a name="l2639"><span class="linenum">2639</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2640"><span class="linenum">2640</span></a>      }
<a name="l2641"><span class="linenum">2641</span></a>      
<a name="l2642"><span class="linenum">2642</span></a>      
<a name="l2643"><span class="linenum">2643</span></a>  <span class="comment">    ### Footnotes</span>
<a name="l2644"><span class="linenum">2644</span></a>      
<a name="l2645"><span class="linenum">2645</span></a>  	function <a class="function" onClick="logFunction('stripFootnotes')" href="../../_functions/stripfootnotes.html" onMouseOver="funcPopup(event,'stripfootnotes')">stripFootnotes</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2646"><span class="linenum">2646</span></a>  <span class="comment">    #</span>
<a name="l2647"><span class="linenum">2647</span></a>  <span class="comment">    # Strips link definitions from text, stores the URLs and titles in</span>
<a name="l2648"><span class="linenum">2648</span></a>  <span class="comment">    # hash references.</span>
<a name="l2649"><span class="linenum">2649</span></a>  <span class="comment">    #</span>
<a name="l2650"><span class="linenum">2650</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l2651"><span class="linenum">2651</span></a>  
<a name="l2652"><span class="linenum">2652</span></a>  <span class="comment">        # Link defs are in the form: [^id]: url &quot;optional title&quot;</span>
<a name="l2653"><span class="linenum">2653</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2654"><span class="linenum">2654</span></a>              ^[ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}\[\^(.+?)\][ ]?:    # note_id = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l2655"><span class="linenum">2655</span></a>                [ ]*
<a name="l2656"><span class="linenum">2656</span></a>                \n?                    # maybe *one* newline
<a name="l2657"><span class="linenum">2657</span></a>              (                        # text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a> (no blank lines allowed)
<a name="l2658"><span class="linenum">2658</span></a>                  (?:                    
<a name="l2659"><span class="linenum">2659</span></a>                      .+                # actual text
<a name="l2660"><span class="linenum">2660</span></a>                  |
<a name="l2661"><span class="linenum">2661</span></a>                      \n                # newlines but 
<a name="l2662"><span class="linenum">2662</span></a>                      (?!\[\^.+?\]:\s)# negative lookahead for footnote marker.
<a name="l2663"><span class="linenum">2663</span></a>                      (?!\n+[ ]{0,3}\S)# ensure line is not blank and followed 
<a name="l2664"><span class="linenum">2664</span></a>  <span class="comment">                                    # by non-indented content</span>
<a name="l2665"><span class="linenum">2665</span></a>                  )*
<a name="l2666"><span class="linenum">2666</span></a>              )        
<a name="l2667"><span class="linenum">2667</span></a>              }xm',
<a name="l2668"><span class="linenum">2668</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_stripFootnotes_callback'),
<a name="l2669"><span class="linenum">2669</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2670"><span class="linenum">2670</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2671"><span class="linenum">2671</span></a>      }
<a name="l2672"><span class="linenum">2672</span></a>  	function <a class="function" onClick="logFunction('_stripFootnotes_callback')" href="../../_functions/_stripfootnotes_callback.html" onMouseOver="funcPopup(event,'_stripfootnotes_callback')">_stripFootnotes_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2673"><span class="linenum">2673</span></a>          <a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_id_prefix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_id_prefix.html">fn_id_prefix</a> . <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2674"><span class="linenum">2674</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes.html">footnotes</a>[<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a>] = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('outdent')" href="../../_functions/outdent.html" onMouseOver="funcPopup(event,'outdent')">outdent</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2]);
<a name="l2675"><span class="linenum">2675</span></a>          return ''; <span class="comment"># String that will replace the block</span>
<a name="l2676"><span class="linenum">2676</span></a>      }
<a name="l2677"><span class="linenum">2677</span></a>  
<a name="l2678"><span class="linenum">2678</span></a>  
<a name="l2679"><span class="linenum">2679</span></a>  	function <a class="function" onClick="logFunction('doFootnotes')" href="../../_functions/dofootnotes.html" onMouseOver="funcPopup(event,'dofootnotes')">doFootnotes</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2680"><span class="linenum">2680</span></a>  <span class="comment">    #</span>
<a name="l2681"><span class="linenum">2681</span></a>  <span class="comment">    # Replace footnote references in $text [^id] with a special text-token </span>
<a name="l2682"><span class="linenum">2682</span></a>  <span class="comment">    # which will be replaced by the actual footnote marker in appendFootnotes.</span>
<a name="l2683"><span class="linenum">2683</span></a>  <span class="comment">    #</span>
<a name="l2684"><span class="linenum">2684</span></a>          if (!<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('in_anchor')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/in_anchor.html">in_anchor</a>) {
<a name="l2685"><span class="linenum">2685</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('{\[\^(.+?)\]}', &quot;F\x1Afn:\\1\x1A:&quot;, <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2686"><span class="linenum">2686</span></a>          }
<a name="l2687"><span class="linenum">2687</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2688"><span class="linenum">2688</span></a>      }
<a name="l2689"><span class="linenum">2689</span></a>  
<a name="l2690"><span class="linenum">2690</span></a>      
<a name="l2691"><span class="linenum">2691</span></a>  	function <a class="function" onClick="logFunction('appendFootnotes')" href="../../_functions/appendfootnotes.html" onMouseOver="funcPopup(event,'appendfootnotes')">appendFootnotes</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2692"><span class="linenum">2692</span></a>  <span class="comment">    #</span>
<a name="l2693"><span class="linenum">2693</span></a>  <span class="comment">    # Append footnote list to text.</span>
<a name="l2694"><span class="linenum">2694</span></a>  <span class="comment">    #</span>
<a name="l2695"><span class="linenum">2695</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{F\x1Afn:(.*?)\x1A:}', 
<a name="l2696"><span class="linenum">2696</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_appendFootnotes_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2697"><span class="linenum">2697</span></a>      
<a name="l2698"><span class="linenum">2698</span></a>          if (!empty(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a>)) {
<a name="l2699"><span class="linenum">2699</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;\n\n&quot;;
<a name="l2700"><span class="linenum">2700</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;div class=\&quot;footnotes\&quot;&gt;\n&quot;;
<a name="l2701"><span class="linenum">2701</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;hr&quot;. <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('empty_element_suffix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/empty_element_suffix.html">empty_element_suffix</a> .&quot;\n&quot;;
<a name="l2702"><span class="linenum">2702</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;ol&gt;\n\n&quot;;
<a name="l2703"><span class="linenum">2703</span></a>              
<a name="l2704"><span class="linenum">2704</span></a>              <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> = &quot; rev=\&quot;footnote\&quot;&quot;;
<a name="l2705"><span class="linenum">2705</span></a>              if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_backlink_class')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_backlink_class.html">fn_backlink_class</a> != &quot;&quot;) {
<a name="l2706"><span class="linenum">2706</span></a>                  <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_backlink_class')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_backlink_class.html">fn_backlink_class</a>;
<a name="l2707"><span class="linenum">2707</span></a>                  <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a>);
<a name="l2708"><span class="linenum">2708</span></a>                  <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> .= &quot; class=\&quot;<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a>\&quot;&quot;;
<a name="l2709"><span class="linenum">2709</span></a>              }
<a name="l2710"><span class="linenum">2710</span></a>              if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_backlink_title')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_backlink_title.html">fn_backlink_title</a> != &quot;&quot;) {
<a name="l2711"><span class="linenum">2711</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_backlink_title')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_backlink_title.html">fn_backlink_title</a>;
<a name="l2712"><span class="linenum">2712</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>);
<a name="l2713"><span class="linenum">2713</span></a>                  <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> .= &quot; title=\&quot;<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>\&quot;&quot;;
<a name="l2714"><span class="linenum">2714</span></a>              }
<a name="l2715"><span class="linenum">2715</span></a>              <a class="var it1209" onMouseOver="hilite(1209)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> = 0;
<a name="l2716"><span class="linenum">2716</span></a>              
<a name="l2717"><span class="linenum">2717</span></a>              while (!empty(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a>)) {
<a name="l2718"><span class="linenum">2718</span></a>                  <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a>);
<a name="l2719"><span class="linenum">2719</span></a>                  <a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a> = <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a>);
<a name="l2720"><span class="linenum">2720</span></a>                  unset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a>[<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a>]);
<a name="l2721"><span class="linenum">2721</span></a>                  
<a name="l2722"><span class="linenum">2722</span></a>                  <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> .= &quot;\n&quot;; <span class="comment"># Need to append newline before parsing.</span>
<a name="l2723"><span class="linenum">2723</span></a>                  <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('runBlockGamut')" href="../../_functions/runblockgamut.html" onMouseOver="funcPopup(event,'runblockgamut')">runBlockGamut</a>(&quot;<a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a>\n&quot;);                
<a name="l2724"><span class="linenum">2724</span></a>                  <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{F\x1Afn:(.*?)\x1A:}', 
<a name="l2725"><span class="linenum">2725</span></a>                      array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_appendFootnotes_callback'), <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a>);
<a name="l2726"><span class="linenum">2726</span></a>                  
<a name="l2727"><span class="linenum">2727</span></a>                  <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;%%&quot;, ++<a class="var it1209" onMouseOver="hilite(1209)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>, <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>);
<a name="l2728"><span class="linenum">2728</span></a>                  <a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a>);
<a name="l2729"><span class="linenum">2729</span></a>                  
<a name="l2730"><span class="linenum">2730</span></a>  <span class="comment">                # Add backlink to last paragraph; create new paragraph if needed.</span>
<a name="l2731"><span class="linenum">2731</span></a>                  <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('backlink')" href="../../_variables/backlink.html">$backlink</a> = &quot;&lt;a href=\&quot;#fnref:<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a>\&quot;<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>&gt;&amp;#8617;&lt;/a&gt;&quot;;
<a name="l2732"><span class="linenum">2732</span></a>                  if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('{&lt;/p&gt;$}', <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a>)) {
<a name="l2733"><span class="linenum">2733</span></a>                      <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a>, 0, -4) . &quot;&amp;#160;<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('backlink')" href="../../_variables/backlink.html">$backlink</a>&lt;/p&gt;&quot;;
<a name="l2734"><span class="linenum">2734</span></a>                  } else {
<a name="l2735"><span class="linenum">2735</span></a>                      <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> .= &quot;\n\n&lt;p&gt;<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('backlink')" href="../../_variables/backlink.html">$backlink</a>&lt;/p&gt;&quot;;
<a name="l2736"><span class="linenum">2736</span></a>                  }
<a name="l2737"><span class="linenum">2737</span></a>                  
<a name="l2738"><span class="linenum">2738</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;li id=\&quot;fn:<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('note_id')" href="../../_variables/note_id.html">$note_id</a>\&quot;&gt;\n&quot;;
<a name="l2739"><span class="linenum">2739</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= <a class="var it1210" onMouseOver="hilite(1210)" onMouseOut="lolite()" onClick="logVariable('footnote')" href="../../_variables/footnote.html">$footnote</a> . &quot;\n&quot;;
<a name="l2740"><span class="linenum">2740</span></a>                  <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/li&gt;\n\n&quot;;
<a name="l2741"><span class="linenum">2741</span></a>              }
<a name="l2742"><span class="linenum">2742</span></a>              
<a name="l2743"><span class="linenum">2743</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/ol&gt;\n&quot;;
<a name="l2744"><span class="linenum">2744</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/div&gt;&quot;;
<a name="l2745"><span class="linenum">2745</span></a>          }
<a name="l2746"><span class="linenum">2746</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2747"><span class="linenum">2747</span></a>      }
<a name="l2748"><span class="linenum">2748</span></a>  	function <a class="function" onClick="logFunction('_appendFootnotes_callback')" href="../../_functions/_appendfootnotes_callback.html" onMouseOver="funcPopup(event,'_appendfootnotes_callback')">_appendFootnotes_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2749"><span class="linenum">2749</span></a>          <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_id_prefix')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_id_prefix.html">fn_id_prefix</a> . <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2750"><span class="linenum">2750</span></a>          
<a name="l2751"><span class="linenum">2751</span></a>  <span class="comment">        # Create footnote marker only if it has a corresponding footnote *and*</span>
<a name="l2752"><span class="linenum">2752</span></a>  <span class="comment">        # the footnote hasn't been used by another marker.</span>
<a name="l2753"><span class="linenum">2753</span></a>          if (isset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes.html">footnotes</a>[<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>])) {
<a name="l2754"><span class="linenum">2754</span></a>  <span class="comment">            # Transfert footnote content to the ordered list.</span>
<a name="l2755"><span class="linenum">2755</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes_ordered')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes_ordered.html">footnotes_ordered</a>[<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>] = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes.html">footnotes</a>[<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>];
<a name="l2756"><span class="linenum">2756</span></a>              unset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnotes')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnotes.html">footnotes</a>[<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>]);
<a name="l2757"><span class="linenum">2757</span></a>              
<a name="l2758"><span class="linenum">2758</span></a>              <a class="var it1209" onMouseOver="hilite(1209)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('footnote_counter')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/footnote_counter.html">footnote_counter</a>++;
<a name="l2759"><span class="linenum">2759</span></a>              <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> = &quot; rel=\&quot;footnote\&quot;&quot;;
<a name="l2760"><span class="linenum">2760</span></a>              if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_link_class')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_link_class.html">fn_link_class</a> != &quot;&quot;) {
<a name="l2761"><span class="linenum">2761</span></a>                  <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_link_class')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_link_class.html">fn_link_class</a>;
<a name="l2762"><span class="linenum">2762</span></a>                  <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a>);
<a name="l2763"><span class="linenum">2763</span></a>                  <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> .= &quot; class=\&quot;<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a>\&quot;&quot;;
<a name="l2764"><span class="linenum">2764</span></a>              }
<a name="l2765"><span class="linenum">2765</span></a>              if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_link_title')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_link_title.html">fn_link_title</a> != &quot;&quot;) {
<a name="l2766"><span class="linenum">2766</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fn_link_title')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/fn_link_title.html">fn_link_title</a>;
<a name="l2767"><span class="linenum">2767</span></a>                  <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>);
<a name="l2768"><span class="linenum">2768</span></a>                  <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> .= &quot; title=\&quot;<a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>\&quot;&quot;;
<a name="l2769"><span class="linenum">2769</span></a>              }
<a name="l2770"><span class="linenum">2770</span></a>              
<a name="l2771"><span class="linenum">2771</span></a>              <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;%%&quot;, <a class="var it1209" onMouseOver="hilite(1209)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>, <a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>);
<a name="l2772"><span class="linenum">2772</span></a>              <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>);
<a name="l2773"><span class="linenum">2773</span></a>              
<a name="l2774"><span class="linenum">2774</span></a>              return
<a name="l2775"><span class="linenum">2775</span></a>                  &quot;&lt;sup id=\&quot;fnref:<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>\&quot;&gt;&quot;.
<a name="l2776"><span class="linenum">2776</span></a>                  &quot;&lt;a href=\&quot;#fn:<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('node_id')" href="../../_variables/node_id.html">$node_id</a>\&quot;<a class="var it316" onMouseOver="hilite(316)" onMouseOut="lolite()" onClick="logVariable('attr')" href="../../_variables/attr.html">$attr</a>&gt;<a class="var it1209" onMouseOver="hilite(1209)" onMouseOut="lolite()" onClick="logVariable('num')" href="../../_variables/num.html">$num</a>&lt;/a&gt;&quot;.
<a name="l2777"><span class="linenum">2777</span></a>                  &quot;&lt;/sup&gt;&quot;;
<a name="l2778"><span class="linenum">2778</span></a>          }
<a name="l2779"><span class="linenum">2779</span></a>          
<a name="l2780"><span class="linenum">2780</span></a>          return &quot;[^&quot;.<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1].&quot;]&quot;;
<a name="l2781"><span class="linenum">2781</span></a>      }
<a name="l2782"><span class="linenum">2782</span></a>          
<a name="l2783"><span class="linenum">2783</span></a>      
<a name="l2784"><span class="linenum">2784</span></a>  <span class="comment">    ### Abbreviations ###</span>
<a name="l2785"><span class="linenum">2785</span></a>      
<a name="l2786"><span class="linenum">2786</span></a>  	function <a class="function" onClick="logFunction('stripAbbreviations')" href="../../_functions/stripabbreviations.html" onMouseOver="funcPopup(event,'stripabbreviations')">stripAbbreviations</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2787"><span class="linenum">2787</span></a>  <span class="comment">    #</span>
<a name="l2788"><span class="linenum">2788</span></a>  <span class="comment">    # Strips abbreviations from text, stores titles in hash references.</span>
<a name="l2789"><span class="linenum">2789</span></a>  <span class="comment">    #</span>
<a name="l2790"><span class="linenum">2790</span></a>          <a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('tab_width')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/tab_width.html">tab_width</a> - 1;
<a name="l2791"><span class="linenum">2791</span></a>  
<a name="l2792"><span class="linenum">2792</span></a>  <span class="comment">        # Link defs are in the form: [id]*: url &quot;optional title&quot;</span>
<a name="l2793"><span class="linenum">2793</span></a>          <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{
<a name="l2794"><span class="linenum">2794</span></a>              ^[ ]{0,'.<a class="var it1101" onMouseOver="hilite(1101)" onMouseOut="lolite()" onClick="logVariable('less_than_tab')" href="../../_variables/less_than_tab.html">$less_than_tab</a>.'}\*\[(.+?)\][ ]?:    # abbr_id = <a class="var it279" onMouseOver="hilite(279)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>
<a name="l2795"><span class="linenum">2795</span></a>              (.*)                    # text = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a> (no blank lines allowed)    
<a name="l2796"><span class="linenum">2796</span></a>              }xm',
<a name="l2797"><span class="linenum">2797</span></a>              array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_stripAbbreviations_callback'),
<a name="l2798"><span class="linenum">2798</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2799"><span class="linenum">2799</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2800"><span class="linenum">2800</span></a>      }
<a name="l2801"><span class="linenum">2801</span></a>  	function <a class="function" onClick="logFunction('_stripAbbreviations_callback')" href="../../_functions/_stripabbreviations_callback.html" onMouseOver="funcPopup(event,'_stripabbreviations_callback')">_stripAbbreviations_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2802"><span class="linenum">2802</span></a>          <a class="var it1173" onMouseOver="hilite(1173)" onMouseOut="lolite()" onClick="logVariable('abbr_word')" href="../../_variables/abbr_word.html">$abbr_word</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1];
<a name="l2803"><span class="linenum">2803</span></a>          <a class="var it1174" onMouseOver="hilite(1174)" onMouseOut="lolite()" onClick="logVariable('abbr_desc')" href="../../_variables/abbr_desc.html">$abbr_desc</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2];
<a name="l2804"><span class="linenum">2804</span></a>          if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a>)
<a name="l2805"><span class="linenum">2805</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a> .= '|';
<a name="l2806"><span class="linenum">2806</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a> .= <a class="phpfunction" onClick="logFunction('preg_quote')" href="../../_functions/preg_quote.html" onMouseOver="phpfuncPopup(event,'preg_quote')">preg_quote</a>(<a class="var it1173" onMouseOver="hilite(1173)" onMouseOut="lolite()" onClick="logVariable('abbr_word')" href="../../_variables/abbr_word.html">$abbr_word</a>);
<a name="l2807"><span class="linenum">2807</span></a>          <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_desciptions')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_desciptions.html">abbr_desciptions</a>[<a class="var it1173" onMouseOver="hilite(1173)" onMouseOut="lolite()" onClick="logVariable('abbr_word')" href="../../_variables/abbr_word.html">$abbr_word</a>] = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1174" onMouseOver="hilite(1174)" onMouseOut="lolite()" onClick="logVariable('abbr_desc')" href="../../_variables/abbr_desc.html">$abbr_desc</a>);
<a name="l2808"><span class="linenum">2808</span></a>          return ''; <span class="comment"># String that will replace the block</span>
<a name="l2809"><span class="linenum">2809</span></a>      }
<a name="l2810"><span class="linenum">2810</span></a>      
<a name="l2811"><span class="linenum">2811</span></a>      
<a name="l2812"><span class="linenum">2812</span></a>  	function <a class="function" onClick="logFunction('doAbbreviations')" href="../../_functions/doabbreviations.html" onMouseOver="funcPopup(event,'doabbreviations')">doAbbreviations</a>(<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l2813"><span class="linenum">2813</span></a>  <span class="comment">    #</span>
<a name="l2814"><span class="linenum">2814</span></a>  <span class="comment">    # Find defined abbreviations in text and wrap them in &lt;abbr&gt; elements.</span>
<a name="l2815"><span class="linenum">2815</span></a>  <span class="comment">    #</span>
<a name="l2816"><span class="linenum">2816</span></a>          if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a>) {
<a name="l2817"><span class="linenum">2817</span></a>  <span class="comment">            // cannot use the /x modifier because abbr_word_re may </span>
<a name="l2818"><span class="linenum">2818</span></a>  <span class="comment">            // contain significant spaces:</span>
<a name="l2819"><span class="linenum">2819</span></a>              <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>('{'.
<a name="l2820"><span class="linenum">2820</span></a>                  '(?&lt;![\w\x1A])'.
<a name="l2821"><span class="linenum">2821</span></a>                  '(?:'.<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_word_re')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_word_re.html">abbr_word_re</a>.')'.
<a name="l2822"><span class="linenum">2822</span></a>                  '(?![\w\x1A])'.
<a name="l2823"><span class="linenum">2823</span></a>                  '}', 
<a name="l2824"><span class="linenum">2824</span></a>                  array(&amp;<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>, '_doAbbreviations_callback'), <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l2825"><span class="linenum">2825</span></a>          }
<a name="l2826"><span class="linenum">2826</span></a>          return <a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l2827"><span class="linenum">2827</span></a>      }
<a name="l2828"><span class="linenum">2828</span></a>  	function <a class="function" onClick="logFunction('_doAbbreviations_callback')" href="../../_functions/_doabbreviations_callback.html" onMouseOver="funcPopup(event,'_doabbreviations_callback')">_doAbbreviations_callback</a>(<a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>) {
<a name="l2829"><span class="linenum">2829</span></a>          <a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('abbr')" href="../../_variables/abbr.html">$abbr</a> = <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l2830"><span class="linenum">2830</span></a>          if (isset(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_desciptions')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_desciptions.html">abbr_desciptions</a>[<a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('abbr')" href="../../_variables/abbr.html">$abbr</a>])) {
<a name="l2831"><span class="linenum">2831</span></a>              <a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('desc')" href="../../_variables/desc.html">$desc</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('abbr_desciptions')" class="var it2867" onMouseOver="hilite(2867)" onMouseOut="lolite()" href="../../_variables/abbr_desciptions.html">abbr_desciptions</a>[<a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('abbr')" href="../../_variables/abbr.html">$abbr</a>];
<a name="l2832"><span class="linenum">2832</span></a>              if (empty(<a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('desc')" href="../../_variables/desc.html">$desc</a>)) {
<a name="l2833"><span class="linenum">2833</span></a>                  return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(&quot;&lt;abbr&gt;<a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('abbr')" href="../../_variables/abbr.html">$abbr</a>&lt;/abbr&gt;&quot;);
<a name="l2834"><span class="linenum">2834</span></a>              } else {
<a name="l2835"><span class="linenum">2835</span></a>                  <a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('desc')" href="../../_variables/desc.html">$desc</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>(<a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('desc')" href="../../_variables/desc.html">$desc</a>);
<a name="l2836"><span class="linenum">2836</span></a>                  return <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('hashPart')" href="../../_functions/hashpart.html" onMouseOver="funcPopup(event,'hashpart')">hashPart</a>(&quot;&lt;abbr title=\&quot;<a class="var it1214" onMouseOver="hilite(1214)" onMouseOut="lolite()" onClick="logVariable('desc')" href="../../_variables/desc.html">$desc</a>\&quot;&gt;<a class="var it1213" onMouseOver="hilite(1213)" onMouseOut="lolite()" onClick="logVariable('abbr')" href="../../_variables/abbr.html">$abbr</a>&lt;/abbr&gt;&quot;);
<a name="l2837"><span class="linenum">2837</span></a>              }
<a name="l2838"><span class="linenum">2838</span></a>          } else {
<a name="l2839"><span class="linenum">2839</span></a>              return <a class="var it92" onMouseOver="hilite(92)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l2840"><span class="linenum">2840</span></a>          }
<a name="l2841"><span class="linenum">2841</span></a>      }
<a name="l2842"><span class="linenum">2842</span></a>  
<a name="l2843"><span class="linenum">2843</span></a>  }
<a name="l2844"><span class="linenum">2844</span></a>  
<a name="l2845"><span class="linenum">2845</span></a>  
<a name="l2846"><span class="linenum">2846</span></a>  <span class="comment">/*</span>
<a name="l2847"><span class="linenum">2847</span></a>  <span class="comment"></span>
<a name="l2848"><span class="linenum">2848</span></a>  <span class="comment">PHP Markdown Extra</span>
<a name="l2849"><span class="linenum">2849</span></a>  <span class="comment">==================</span>
<a name="l2850"><span class="linenum">2850</span></a>  <span class="comment"></span>
<a name="l2851"><span class="linenum">2851</span></a>  <span class="comment">Description</span>
<a name="l2852"><span class="linenum">2852</span></a>  <span class="comment">-----------</span>
<a name="l2853"><span class="linenum">2853</span></a>  <span class="comment"></span>
<a name="l2854"><span class="linenum">2854</span></a>  <span class="comment">This is a PHP port of the original Markdown formatter written in Perl </span>
<a name="l2855"><span class="linenum">2855</span></a>  <span class="comment">by John Gruber. This special &quot;Extra&quot; version of PHP Markdown features </span>
<a name="l2856"><span class="linenum">2856</span></a>  <span class="comment">further enhancements to the syntax for making additional constructs </span>
<a name="l2857"><span class="linenum">2857</span></a>  <span class="comment">such as tables and definition list.</span>
<a name="l2858"><span class="linenum">2858</span></a>  <span class="comment"></span>
<a name="l2859"><span class="linenum">2859</span></a>  <span class="comment">Markdown is a text-to-HTML filter; it translates an easy-to-read /</span>
<a name="l2860"><span class="linenum">2860</span></a>  <span class="comment">easy-to-write structured text format into HTML. Markdown's text format</span>
<a name="l2861"><span class="linenum">2861</span></a>  <span class="comment">is most similar to that of plain text email, and supports features such</span>
<a name="l2862"><span class="linenum">2862</span></a>  <span class="comment">as headers, *emphasis*, code blocks, blockquotes, and links.</span>
<a name="l2863"><span class="linenum">2863</span></a>  <span class="comment"></span>
<a name="l2864"><span class="linenum">2864</span></a>  <span class="comment">Markdown's syntax is designed not as a generic markup language, but</span>
<a name="l2865"><span class="linenum">2865</span></a>  <span class="comment">specifically to serve as a front-end to (X)HTML. You can use span-level</span>
<a name="l2866"><span class="linenum">2866</span></a>  <span class="comment">HTML tags anywhere in a Markdown document, and you can use block level</span>
<a name="l2867"><span class="linenum">2867</span></a>  <span class="comment">HTML tags (like &lt;div&gt; and &lt;table&gt; as well).</span>
<a name="l2868"><span class="linenum">2868</span></a>  <span class="comment"></span>
<a name="l2869"><span class="linenum">2869</span></a>  <span class="comment">For more information about Markdown's syntax, see:</span>
<a name="l2870"><span class="linenum">2870</span></a>  <span class="comment"></span>
<a name="l2871"><span class="linenum">2871</span></a>  <span class="comment">&lt;http://daringfireball.net/projects/markdown/&gt;</span>
<a name="l2872"><span class="linenum">2872</span></a>  <span class="comment"></span>
<a name="l2873"><span class="linenum">2873</span></a>  <span class="comment"></span>
<a name="l2874"><span class="linenum">2874</span></a>  <span class="comment">Bugs</span>
<a name="l2875"><span class="linenum">2875</span></a>  <span class="comment">----</span>
<a name="l2876"><span class="linenum">2876</span></a>  <span class="comment"></span>
<a name="l2877"><span class="linenum">2877</span></a>  <span class="comment">To file bug reports please send email to:</span>
<a name="l2878"><span class="linenum">2878</span></a>  <span class="comment"></span>
<a name="l2879"><span class="linenum">2879</span></a>  <span class="comment">&lt;michel.fortin@michelf.com&gt;</span>
<a name="l2880"><span class="linenum">2880</span></a>  <span class="comment"></span>
<a name="l2881"><span class="linenum">2881</span></a>  <span class="comment">Please include with your report: (1) the example input; (2) the output you</span>
<a name="l2882"><span class="linenum">2882</span></a>  <span class="comment">expected; (3) the output Markdown actually produced.</span>
<a name="l2883"><span class="linenum">2883</span></a>  <span class="comment"></span>
<a name="l2884"><span class="linenum">2884</span></a>  <span class="comment"></span>
<a name="l2885"><span class="linenum">2885</span></a>  <span class="comment">Version History</span>
<a name="l2886"><span class="linenum">2886</span></a>  <span class="comment">--------------- </span>
<a name="l2887"><span class="linenum">2887</span></a>  <span class="comment"></span>
<a name="l2888"><span class="linenum">2888</span></a>  <span class="comment">See the readme file for detailed release notes for this version.</span>
<a name="l2889"><span class="linenum">2889</span></a>  <span class="comment"></span>
<a name="l2890"><span class="linenum">2890</span></a>  <span class="comment"></span>
<a name="l2891"><span class="linenum">2891</span></a>  <span class="comment">Copyright and License</span>
<a name="l2892"><span class="linenum">2892</span></a>  <span class="comment">---------------------</span>
<a name="l2893"><span class="linenum">2893</span></a>  <span class="comment"></span>
<a name="l2894"><span class="linenum">2894</span></a>  <span class="comment">PHP Markdown &amp; Extra  </span>
<a name="l2895"><span class="linenum">2895</span></a>  <span class="comment">Copyright (c) 2004-2009 Michel Fortin  </span>
<a name="l2896"><span class="linenum">2896</span></a>  <span class="comment">&lt;http://michelf.com/&gt;  </span>
<a name="l2897"><span class="linenum">2897</span></a>  <span class="comment">All rights reserved.</span>
<a name="l2898"><span class="linenum">2898</span></a>  <span class="comment"></span>
<a name="l2899"><span class="linenum">2899</span></a>  <span class="comment">Based on Markdown  </span>
<a name="l2900"><span class="linenum">2900</span></a>  <span class="comment">Copyright (c) 2003-2006 John Gruber   </span>
<a name="l2901"><span class="linenum">2901</span></a>  <span class="comment">&lt;http://daringfireball.net/&gt;   </span>
<a name="l2902"><span class="linenum">2902</span></a>  <span class="comment">All rights reserved.</span>
<a name="l2903"><span class="linenum">2903</span></a>  <span class="comment"></span>
<a name="l2904"><span class="linenum">2904</span></a>  <span class="comment">Redistribution and use in source and binary forms, with or without</span>
<a name="l2905"><span class="linenum">2905</span></a>  <span class="comment">modification, are permitted provided that the following conditions are</span>
<a name="l2906"><span class="linenum">2906</span></a>  <span class="comment">met:</span>
<a name="l2907"><span class="linenum">2907</span></a>  <span class="comment"></span>
<a name="l2908"><span class="linenum">2908</span></a>  <span class="comment">*    Redistributions of source code must retain the above copyright notice,</span>
<a name="l2909"><span class="linenum">2909</span></a>  <span class="comment">    this list of conditions and the following disclaimer.</span>
<a name="l2910"><span class="linenum">2910</span></a>  <span class="comment"></span>
<a name="l2911"><span class="linenum">2911</span></a>  <span class="comment">*    Redistributions in binary form must reproduce the above copyright</span>
<a name="l2912"><span class="linenum">2912</span></a>  <span class="comment">    notice, this list of conditions and the following disclaimer in the</span>
<a name="l2913"><span class="linenum">2913</span></a>  <span class="comment">    documentation and/or other materials provided with the distribution.</span>
<a name="l2914"><span class="linenum">2914</span></a>  <span class="comment"></span>
<a name="l2915"><span class="linenum">2915</span></a>  <span class="comment">*    Neither the name &quot;Markdown&quot; nor the names of its contributors may</span>
<a name="l2916"><span class="linenum">2916</span></a>  <span class="comment">    be used to endorse or promote products derived from this software</span>
<a name="l2917"><span class="linenum">2917</span></a>  <span class="comment">    without specific prior written permission.</span>
<a name="l2918"><span class="linenum">2918</span></a>  <span class="comment"></span>
<a name="l2919"><span class="linenum">2919</span></a>  <span class="comment">This software is provided by the copyright holders and contributors &quot;as</span>
<a name="l2920"><span class="linenum">2920</span></a>  <span class="comment">is&quot; and any express or implied warranties, including, but not limited</span>
<a name="l2921"><span class="linenum">2921</span></a>  <span class="comment">to, the implied warranties of merchantability and fitness for a</span>
<a name="l2922"><span class="linenum">2922</span></a>  <span class="comment">particular purpose are disclaimed. In no event shall the copyright owner</span>
<a name="l2923"><span class="linenum">2923</span></a>  <span class="comment">or contributors be liable for any direct, indirect, incidental, special,</span>
<a name="l2924"><span class="linenum">2924</span></a>  <span class="comment">exemplary, or consequential damages (including, but not limited to,</span>
<a name="l2925"><span class="linenum">2925</span></a>  <span class="comment">procurement of substitute goods or services; loss of use, data, or</span>
<a name="l2926"><span class="linenum">2926</span></a>  <span class="comment">profits; or business interruption) however caused and on any theory of</span>
<a name="l2927"><span class="linenum">2927</span></a>  <span class="comment">liability, whether in contract, strict liability, or tort (including</span>
<a name="l2928"><span class="linenum">2928</span></a>  <span class="comment">negligence or otherwise) arising in any way out of the use of this</span>
<a name="l2929"><span class="linenum">2929</span></a>  <span class="comment">software, even if advised of the possibility of such damage.</span>
<a name="l2930"><span class="linenum">2930</span></a>  <span class="comment"></span>
<a name="l2931"><span class="linenum">2931</span></a>  <span class="comment">*/</span>
<a name="l2932"><span class="linenum">2932</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'encodeattribute': ['encodeattribute', '', [['bonfire/helpers','markdown_helper.php',1411]], 18],
'_stripabbreviations_callback': ['_stripabbreviations_callback', '', [['bonfire/helpers','markdown_helper.php',2801]], 0],
'_appendfootnotes_callback': ['_appendfootnotes_callback', '', [['bonfire/helpers','markdown_helper.php',2748]], 0],
'doheaders': ['doheaders', '', [['bonfire/helpers','markdown_helper.php',899],['bonfire/helpers','markdown_helper.php',2223]], 0],
'runspangamut': ['runspangamut', '', [['bonfire/helpers','markdown_helper.php',650]], 19],
'stripfootnotes': ['stripfootnotes', '', [['bonfire/helpers','markdown_helper.php',2645]], 0],
'processdeflistitems': ['processdeflistitems', '', [['bonfire/helpers','markdown_helper.php',2467]], 1],
'markdownextra_parser': ['markdownextra_parser', '', [['bonfire/helpers','markdown_helper.php',1694]], 1],
'_processdeflistitems_callback_dt': ['_processdeflistitems_callback_dt', '', [['bonfire/helpers','markdown_helper.php',2510]], 0],
'_doanchors_reference_callback': ['_doanchors_reference_callback', '', [['bonfire/helpers','markdown_helper.php',742]], 0],
'doabbreviations': ['doabbreviations', '', [['bonfire/helpers','markdown_helper.php',2812]], 0],
'dotables': ['dotables', '', [['bonfire/helpers','markdown_helper.php',2283]], 0],
'doblockquotes': ['doblockquotes', '', [['bonfire/helpers','markdown_helper.php',1305],['bonfire/helpers','markdown_extended_helper.php',39]], 0],
'_doimages_reference_callback': ['_doimages_reference_callback', '', [['bonfire/helpers','markdown_helper.php',852]], 0],
'_doheaders_attr': ['_doheaders_attr', '', [['bonfire/helpers','markdown_helper.php',2263]], 2],
'_doabbreviations_callback': ['_doabbreviations_callback', '', [['bonfire/helpers','markdown_helper.php',2828]], 0],
'_doimages_inline_callback': ['_doimages_inline_callback', '', [['bonfire/helpers','markdown_helper.php',880]], 0],
'doautolinks': ['doautolinks', '', [['bonfire/helpers','markdown_helper.php',1443]], 0],
'doitalicsandbold': ['doitalicsandbold', '', [['bonfire/helpers','markdown_helper.php',1182]], 0],
'transform': ['transform', '', [['bonfire/helpers','markdown_helper.php',299],['bonfire/helpers','markdown_extended_helper.php',25]], 4],
'_dohardbreaks_callback': ['_dohardbreaks_callback', '', [['bonfire/helpers','markdown_helper.php',667]], 0],
'_doheaders_callback_setext': ['_doheaders_callback_setext', '', [['bonfire/helpers','markdown_helper.php',929],['bonfire/helpers','markdown_helper.php',2267]], 0],
'identify_modifier_markdown': ['identify_modifier_markdown', '', [['bonfire/helpers','markdown_helper.php',165]], 0],
'_detab_callback': ['_detab_callback', '', [['bonfire/helpers','markdown_helper.php',1628]], 0],
'parsespan': ['parsespan', '', [['bonfire/helpers','markdown_helper.php',1523]], 2],
'_doblockquotes_callback2': ['_doblockquotes_callback2', '', [['bonfire/helpers','markdown_helper.php',1334]], 0],
'_processlistitems_callback': ['_processlistitems_callback', '', [['bonfire/helpers','markdown_helper.php',1077]], 0],
'_dotable_leadingpipe_callback': ['_dotable_leadingpipe_callback', '', [['bonfire/helpers','markdown_helper.php',2344]], 0],
'_doautolinks_url_callback': ['_doautolinks_url_callback', '', [['bonfire/helpers','markdown_helper.php',1470]], 0],
'doanchors': ['doanchors', '', [['bonfire/helpers','markdown_helper.php',672]], 0],
'dofencedcodeblocks': ['dofencedcodeblocks', '', [['bonfire/helpers','markdown_helper.php',2539],['bonfire/helpers','markdown_extended_helper.php',70]], 0],
'mdwp_markdownpost': ['mdwp_markdownpost', '', [['bonfire/helpers','markdown_helper.php',105]], 0],
'textilerestricted': ['textilerestricted', '', [['bonfire/helpers','markdown_helper.php',201]], 0],
'runblockgamut': ['runblockgamut', '', [['bonfire/helpers','markdown_helper.php',577]], 8],
'_dodeflists_callback': ['_dodeflists_callback', '', [['bonfire/helpers','markdown_helper.php',2455]], 0],
'prepareitalicsandbold': ['prepareitalicsandbold', '', [['bonfire/helpers','markdown_helper.php',1160]], 1],
'blocklite': ['blocklite', '', [['bonfire/helpers','markdown_helper.php',205]], 0],
'encodeampsandangles': ['encodeampsandangles', '', [['bonfire/helpers','markdown_helper.php',1422]], 1],
'mdwp_strip_p': ['mdwp_strip_p', '', [['bonfire/helpers','markdown_helper.php',150]], 0],
'_dolists_callback': ['_dolists_callback', '', [['bonfire/helpers','markdown_helper.php',1011]], 0],
'_dofencedcodeblocks_newlines': ['_dofencedcodeblocks_newlines', '', [['bonfire/helpers','markdown_helper.php',2580]], 0],
'markdown': ['markdown', '', [['bonfire/helpers','markdown_helper.php',52]], 2],
'_doheaders_callback_atx': ['_doheaders_callback_atx', '', [['bonfire/helpers','markdown_helper.php',938],['bonfire/helpers','markdown_helper.php',2275]], 0],
'_unhash_callback': ['_unhash_callback', '', [['bonfire/helpers','markdown_helper.php',1666]], 0],
'hashhtmlblocks': ['hashhtmlblocks', '', [['bonfire/helpers','markdown_helper.php',389],['bonfire/helpers','markdown_helper.php',1786]], 2],
'striplinkdefinitions': ['striplinkdefinitions', '', [['bonfire/helpers','markdown_helper.php',346]], 0],
'makecodespan': ['makecodespan', '', [['bonfire/helpers','markdown_helper.php',1134]], 1],
'markdown_parser': ['markdown_parser', '', [['bonfire/helpers','markdown_helper.php',242]], 1],
'docodeblocks': ['docodeblocks', '', [['bonfire/helpers','markdown_helper.php',1102]], 0],
'_stripfootnotes_callback': ['_stripfootnotes_callback', '', [['bonfire/helpers','markdown_helper.php',2672]], 0],
'teardown': ['teardown', '', [['tests/simpletest/docs/fr','mock_objects_documentation.html',492],['bonfire/helpers','markdown_helper.php',288],['bonfire/helpers','markdown_helper.php',1754],['tests/simpletest/test','errors_test.php',18],['tests/simpletest/test','errors_test.php',47],['tests/simpletest/test','errors_test.php',93],['tests/simpletest/test','exceptions_test.php',127],['tests/simpletest/test','exceptions_test.php',175],['tests/bonfire/core','MY_Model_test.php',39],['tests/simpletest/docs/en','mock_objects_documentation.html',463],['tests/simpletest/docs/en','unit_test_documentation.html',80],['tests/simpletest/docs/en','unit_test_documentation.html',346],['tests/simpletest/docs/fr','unit_test_documentation.html',87],['tests/simpletest/docs/fr','unit_test_documentation.html',346],['tests/simpletest/docs/fr','index.html',351],['tests/simpletest','test_case.php',208],['tests/simpletest/docs/en','index.html',328]], 15],
'dodeflists': ['dodeflists', '', [['bonfire/helpers','markdown_helper.php',2413]], 0],
'_doautolinks_email_callback': ['_doautolinks_email_callback', '', [['bonfire/helpers','markdown_helper.php',1475]], 0],
'dofootnotes': ['dofootnotes', '', [['bonfire/helpers','markdown_helper.php',2679]], 0],
'mark': ['mark', 'Set a benchmark marker ', [['bonfire/codeigniter/core','Benchmark.php',41]], 11],
'row': ['row', 'CI_DB_Result ', [['tests/_support','database.php',51],['bonfire/codeigniter/database','DB_result.php',161]], 35],
'handlespantoken': ['handlespantoken', '', [['bonfire/helpers','markdown_helper.php',1579]], 1],
'encodeemailaddress': ['encodeemailaddress', '', [['bonfire/helpers','markdown_helper.php',1482]], 1],
'stripabbreviations': ['stripabbreviations', '', [['bonfire/helpers','markdown_helper.php',2786]], 0],
'processlistitems': ['processlistitems', '', [['bonfire/helpers','markdown_helper.php',1031]], 1],
'_dofencedcodeblocks_callback': ['_dofencedcodeblocks_callback', '', [['bonfire/helpers','markdown_helper.php',2572],['bonfire/helpers','markdown_extended_helper.php',98]], 0],
'runbasicblockgamut': ['runbasicblockgamut', '', [['bonfire/helpers','markdown_helper.php',591]], 1],
'_striplinkdefinitions_callback': ['_striplinkdefinitions_callback', '', [['bonfire/helpers','markdown_helper.php',380]], 0],
'hashblock': ['hashblock', '', [['bonfire/helpers','markdown_helper.php',556]], 15],
'hashclean': ['hashclean', '', [['bonfire/helpers','markdown_helper.php',2213]], 0],
'_processdeflistitems_callback_dd': ['_processdeflistitems_callback_dd', '', [['bonfire/helpers','markdown_helper.php',2519]], 0],
'setup': ['setup', '', [['tests/simpletest/docs/fr','mock_objects_documentation.html',491],['tests/simpletest/test','user_agent_test.php',15],['tests/simpletest/test','mock_objects_test.php',474],['tests/bonfire/modules/users','user_model_test.php',22],['bonfire/helpers','markdown_helper.php',275],['bonfire/helpers','markdown_helper.php',1734],['tests/simpletest/test','errors_test.php',12],['tests/simpletest/test','errors_test.php',42],['tests/simpletest/test','errors_test.php',89],['tests/simpletest/test','exceptions_test.php',144],['tests/simpletest/test','exceptions_test.php',160],['tests/bonfire/core','MY_Model_test.php',24],['bonfire/libraries','installer_lib.php',417],['tests/simpletest/test','acceptance_test.php',194],['tests/simpletest/test','acceptance_test.php',291],['tests/simpletest/test','acceptance_test.php',335],['tests/simpletest/test','acceptance_test.php',390],['tests/simpletest/test','acceptance_test.php',506],['tests/simpletest/test','acceptance_test.php',520],['tests/simpletest/test','acceptance_test.php',566],['tests/simpletest/test','acceptance_test.php',671],['tests/simpletest/test','acceptance_test.php',1091],['tests/simpletest/test','acceptance_test.php',1182],['tests/simpletest/test','acceptance_test.php',1219],['tests/simpletest/test','acceptance_test.php',1287],['tests/simpletest/test','acceptance_test.php',1361],['tests/simpletest/test','acceptance_test.php',1608],['tests/simpletest/test','acceptance_test.php',1652],['tests/simpletest/docs/en','mock_objects_documentation.html',462],['tests/simpletest/docs/en','unit_test_documentation.html',76],['tests/simpletest/docs/en','unit_test_documentation.html',342],['tests/bonfire/modules/activities','activity_model_test.php',19],['tests/simpletest/docs/fr','unit_test_documentation.html',83],['tests/simpletest/docs/fr','unit_test_documentation.html',342],['tests/simpletest/docs/fr','index.html',347],['tests/simpletest','test_case.php',199],['tests/simpletest/docs/en','index.html',324]], 17],
'detab': ['detab', '', [['bonfire/helpers','markdown_helper.php',1615]], 1],
'_docodeblocks_callback': ['_docodeblocks_callback', '', [['bonfire/helpers','markdown_helper.php',1120]], 0],
'_hashhtmlblocks_callback': ['_hashhtmlblocks_callback', '', [['bonfire/helpers','markdown_helper.php',526]], 0],
'dolists': ['dolists', '', [['bonfire/helpers','markdown_helper.php',945]], 1],
'smarty_modifier_markdown': ['smarty_modifier_markdown', '', [['bonfire/helpers','markdown_helper.php',181]], 0],
'appendfootnotes': ['appendfootnotes', '', [['bonfire/helpers','markdown_helper.php',2691]], 0],
'mdwp_hide_tags': ['mdwp_hide_tags', '', [['bonfire/helpers','markdown_helper.php',152]], 0],
'outdent': ['outdent', '', [['bonfire/helpers','markdown_helper.php',1603]], 6],
'_doanchors_inline_callback': ['_doanchors_inline_callback', '', [['bonfire/helpers','markdown_helper.php',776]], 0],
'unhash': ['unhash', '', [['bonfire/helpers','markdown_helper.php',1659]], 3],
'dohardbreaks': ['dohardbreaks', '', [['bonfire/helpers','markdown_helper.php',662],['bonfire/helpers','markdown_extended_helper.php',30]], 0],
'_hashhtmlblocks_inhtml': ['_hashhtmlblocks_inhtml', '', [['bonfire/helpers','markdown_helper.php',2038]], 2],
'_dotable_callback': ['_dotable_callback', '', [['bonfire/helpers','markdown_helper.php',2354]], 1],
'formparagraphs': ['formparagraphs', '', [['bonfire/helpers','markdown_helper.php',1341],['bonfire/helpers','markdown_helper.php',2607]], 1],
'doimages': ['doimages', '', [['bonfire/helpers','markdown_helper.php',797]], 0],
'mdwp_add_p': ['mdwp_add_p', '', [['bonfire/helpers','markdown_helper.php',142]], 0],
'_hashhtmlblocks_inmarkdown': ['_hashhtmlblocks_inmarkdown', '', [['bonfire/helpers','markdown_helper.php',1809]], 2],
'_doblockquotes_callback': ['_doblockquotes_callback', '', [['bonfire/helpers','markdown_helper.php',1320],['bonfire/helpers','markdown_extended_helper.php',51]], 0],
'mdwp_show_tags': ['mdwp_show_tags', '', [['bonfire/helpers','markdown_helper.php',156]], 0],
'_initdetab': ['_initdetab', '', [['bonfire/helpers','markdown_helper.php',1645]], 1],
'dohorizontalrules': ['dohorizontalrules', '', [['bonfire/helpers','markdown_helper.php',608]], 0],
'textilethis': ['textilethis', '', [['bonfire/helpers','markdown_helper.php',195]], 1],
'hashpart': ['hashpart', '', [['bonfire/helpers','markdown_helper.php',533]], 21],
'create_function': ['create_function', '', [], 1],
'str_repeat': ['str_repeat', '', [], 23],
'strcasecmp': ['strcasecmp', '', [], 5],
'htmlspecialchars': ['htmlspecialchars', '', [], 30],
'substr': ['substr', '', [], 239],
'explode': ['explode', '', [], 109],
'key': ['key', '', [], 22],
'strtolower': ['strtolower', '', [], 179],
'preg_replace_callback': ['preg_replace_callback', '', [], 55],
'preg_split': ['preg_split', '', [], 17],
'count': ['count', '', [], 628],
'trim': ['trim', '', [], 190],
'defined': ['defined', '', [], 400],
'preg_match': ['preg_match', '', [], 205],
'end': ['end', '', [], 25],
'abs': ['abs', '', [], 7],
'str_replace': ['str_replace', '', [], 322],
'function_exists': ['function_exists', '', [], 299],
'dechex': ['dechex', '', [], 9],
'reset': ['reset', '', [], 20],
'array_shift': ['array_shift', '', [], 57],
'preg_replace': ['preg_replace', '', [], 213],
'implode': ['implode', '', [], 245],
'rtrim': ['rtrim', '', [], 29],
'str_rot13': ['str_rot13', '', [], 1],
'ord': ['ord', '', [], 29],
'array_unshift': ['array_unshift', '', [], 21],
'preg_match_all': ['preg_match_all', '', [], 25],
'array_slice': ['array_slice', '', [], 17],
'define': ['define', '', [], 70],
'preg_quote': ['preg_quote', '', [], 30],
'array_pad': ['array_pad', '', [], 2],
'asort': ['asort', '', [], 3]};
CLASS_DATA={
'markdownextra_parser': ['markdownextra_parser', '', [['bonfire/helpers','markdown_helper.php',1677]], 1],
'markdown_parser': ['markdown_parser', '', [['bonfire/helpers','markdown_helper.php',215]], 1],
'textile': ['textile', '', [['bonfire/helpers','markdown_helper.php',194]], 0]};
CONST_DATA={
'MARKDOWN_EMPTY_ELEMENT_SUFFIX': ['MARKDOWN_EMPTY_ELEMENT_SUFFIX', '', [['bonfire/helpers','markdown_helper.php',24]], 2],
'MARKDOWN_FN_BACKLINK_CLASS': ['MARKDOWN_FN_BACKLINK_CLASS', '', [['bonfire/helpers','markdown_helper.php',35]], 2],
'MARKDOWN_WP_COMMENTS': ['MARKDOWN_WP_COMMENTS', '', [['bonfire/helpers','markdown_helper.php',44]], 2],
'MARKDOWN_PARSER_CLASS': ['MARKDOWN_PARSER_CLASS', '', [['bonfire/helpers','markdown_helper.php',50]], 3],
'MARKDOWN_WP_POSTS': ['MARKDOWN_WP_POSTS', '', [['bonfire/helpers','markdown_helper.php',43]], 2],
'MARKDOWN_FN_LINK_TITLE': ['MARKDOWN_FN_LINK_TITLE', '', [['bonfire/helpers','markdown_helper.php',30]], 2],
'MARKDOWN_TAB_WIDTH': ['MARKDOWN_TAB_WIDTH', '', [['bonfire/helpers','markdown_helper.php',27]], 2],
'MARKDOWN_FN_LINK_CLASS': ['MARKDOWN_FN_LINK_CLASS', '', [['bonfire/helpers','markdown_helper.php',34]], 2],
'MARKDOWN_FN_BACKLINK_TITLE': ['MARKDOWN_FN_BACKLINK_TITLE', '', [['bonfire/helpers','markdown_helper.php',31]], 2],
'MARKDOWNEXTRA_VERSION': ['MARKDOWNEXTRA_VERSION', '', [['bonfire/helpers','markdown_helper.php',16]], 2],
'MARKDOWN_VERSION': ['MARKDOWN_VERSION', '', [['bonfire/helpers','markdown_helper.php',15]], 1]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Oct 23 19:15:14 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
